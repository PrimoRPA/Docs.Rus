# Настройка машины робота

## Требования к персоналу

Документ предназначен для системных администраторов, имеющих навыки:
1. **Обязательно – уверенный пользователь ОС Windows**:
    * Владеть Проводником Windows для перемещения по папкам и файлам.
    * Создавать и редактировать текстовые файлы.
    * Копировать файлы, копировать текст из файлов, сохранять файлы. 
2. **Обязательно – опыт администрирования ОС Windows**:
    * Уметь запускать программы из-под Администратора.
    * Иметь опыт работы в cmd.
    * Иметь опыт работы в PowerShell.
    * Уметь работать со службами.

## Введение

Компоненты Оркестратора (выборочно) и их связи и с роботами/машиной робота приведены на схеме ниже:

![](<../../../../orchestrator-new/resources/install/windows/setting-up-machines-win/Orch-components.PNG>)

Полная схема приведена в разделе [Компоненты системы](https://docs.primo-rpa.ru/primo-rpa/orchestrator-new/system-components).

**Агент** – self-hosted веб-приложение. Агент выполнен как .NET Core 3.1-приложение. Агент используется для развертывания и управления роботом на машине робота.

На одной машине может работать несколько Роботов. Все машины Роботов должны быть настроены одинаково (версии Windows могут отличаться) и на каждой машине Робота должен быть развернут Агент.
Машин Роботов может быть много.

**Порты**, указанные на схеме выше, далее используются при открытии портов на файерволе Windows (в том числе аппаратном в сети организации). Должно быть разрешено управление машиной робота по RDP.

Для настройки машины робота рекомендуется использовать чистую машину с Windows Server 2016 Standard x64, обязательно с последними обновлениями. 
На нее должна быть скопирована папка с комплектом поставки (см. подраздел ниже **Файлы из комплекта поставки**). 
Это может быть любая папка - для определенности пусть будет папка `C:\Install`, поскольку в скрипте `PrimoWorker.ps1` прописана именно она.

Для выполнения команд и скриптов cmd и PowerShell должны запускаться из-под Администратора.


## Аппаратные требования

Для машины робота требуется рабочая станция под управлением Windows Server 2016 Standard x64, которая соответствует требованиям:

* **CPU** - 8 ядер
* **RAM** - 8 Гб
* **HDD** - 250 Гб (OS + Data)

Аппаратные требования зависят от количества одновременно работающих Роботов и задач, которые выполняют роботы. Рекомендуется по 1 ядру CPU на каждого робота.



## Файлы из комплекта поставки Оркестратора

Для настройки машины робота потребуются следующие файлы из [комплекта поставки](https://docs.primo-rpa.ru/primo-rpa/orchestrator/orchestrator-sys-admin/deployment/kit) Оркестратора:

| №п/п | Наименование файла | Описание |
| --- | --- | --- |
| 1. | Agent.zip | Дистрибутив Агента |
| 2. | PowerShell-7.1.3-win-x64.msi | Установщик PowerShell |
| 3. | ChromeStandaloneSetup64.exe | Установщик браузера Chrome |
| 4. | PrimoWorker.ps1 | PowerSchell-скрипт для настройки машины Робота и установки Agent |
| 5. | restore_console.bat | Скрипт перевода RDP-сессии в консоль |
| 6. | RDP-Disconnector.xml | Windows Task, запускающий restore_console.bat |

Остальное ПО должно быть предустановлено в Windows.

## Установка Агента

Процесс установки Агента Оркестратора на машине робота подробно описан в статье [Установка Агента](https://docs.primo-rpa.ru/primo-rpa/orchestrator-new/install/windows/setting-up-machines-win/appendix-win).


