# Фильтр таблицы
*Eng: Table filter*

Предназначен для фильтрации данных в таблице. Данные фильтруются по столбцу. Элемент работает с входной переменной типа DataTable, хранящей таблицу. Эту переменную можно получить, например, с помощью операции [**Чтение диапазона**](https://docs.primo-rpa.ru/primo-rpa/g\_elements/osnovnye-elementy/prilozhenie-excel/el\_excel\_readrange) Excel-файла.

![](../../../.gitbook/assets/new-filter-of-table.png)

_**Запрос указывается одним из перечисленных способов:**_

1. В свойстве **Запрос**. Имеет приоритет над окнами мастеров, поддерживает переменные. В результате вернется таблица с данными, соответствующими условиям запроса.
2. В окне **мастера фильтров**. Помимо указания запроса, предоставляет на выбор действие с результатом: удаление либо сохранение искомых данных.
3. В окне **мастера запросов**. В результате вернется таблица только с найденными данными.

### Мастер фильтров

При нажатии кнопки **Мастер фильтров** откроется окно вида:

![](../../../.gitbook/assets/table-filter-wizard.png)

Для работы имеются 2 вкладки: **Строки фильтра** и **Столбцы результата**.

Вкладка **Строки фильтра**:

1. На вкладке **Строки фильтра** формируется запрос к таблице:
   * В поле **Колонка** укажите столбец, по которому нужно отфильтровать данные. Значение указывайте в кавычках, независимо от формата ячейки. Пример: `"1"`.
   * В поле **Операция** выберите операцию сравнения данных.
   * В поле **Значение** укажите данные. Указывайте данные в кавычках `" "` вне зависимости от формата ячейки в самой таблице. Например, если настроен фильтр по столбцу с датой, то ее тоже следует указывать в кавычках.
2. По кнопке ![](<../../../.gitbook/assets/12 (2) (3) (1) (1) (1) (1).png>) можно добавить новое условие с оператором И/ИЛИ. Кнопка ![](<../../../.gitbook/assets/13 (1) (1) (2) (1) (1) (1) (4).png>) удаляет ненужное условие.
3. Выберите действие, которое нужно совершить с результатом: **Сохранить** (по умолчанию) или **Удалить**. При сохранении в таблице будут выведены только найденные данные. При удалении - вернется отсортированная таблица, из которой удалена указанная строка (-и).

Вкладка **Столбцы результата**:

На вкладке **Столбцы результата** можно задать название колонок, которые требуется либо сохранить, либо удалить из результата. Название прописывается в кавычках:

![](../../../.gitbook/assets/tab-with-result-col.png)

### Мастер запросов

При нажатии кнопки **Мастер запросов** откроется окно вида:

![](<../../../.gitbook/assets/Фильтр таблицы. Условие.png>)

Запрос формируется аналогично мастеру фильтров - см. инструкцию для вкладки **Строки фильтра**. Однако в нем отсутствует выбор действий с результатом (Сохранить/Удалить): будут выведены только найденные данные без возможности их удалить из таблицы.

Текст сформированного запроса можно просмотреть по нажатию кнопки **Запрос**. После указания всех нужных параметров нажмите кнопку **ОК**.

В случае, если результат фильтрации не удовлетворяет ни одному из условий, вернется только структура таблицы.

## Свойства

Описание общих свойств см. в разделе [Свойства элемента](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements#svoistva-elementa).\
Символ `*` в названии свойства указывает на обязательность его заполнения.

| Свойство                     | Тип                                                                                                      | Описание                                                                                                                             |
| ---------------------------- | -------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------ |
| _**Управление коллекцией:**_ |                                                                                                          |                                                                                                                                      |
| Таблица\*                    | [System.Data.DataTable](https://learn.microsoft.com/ru-ru/dotnet/api/system.data.datatable?view=net-5.0) | Переменная, содержащая таблицу данных                                                                                                |
| Запрос                       | String                                                                                                   | Текст запроса таблицы данных. Если не заполнено, то запрос формируется по данным мастера запросов/фильтров                           |
| Мастер                       |                                                                                                          | Данные из мастера фильтров. **Важно**: при очистке запроса в мастере свойство остается заполненным - удалите его, если это требуется |
| _**Вывод:**_                 |                                                                                                          |                                                                                                                                      |
| Переменная\*                 | System.Data.DataTable                                                                                    | Переменная для сохранения результатов фильтрации таблицы                                                                             |


## Пример на Learning

Пример использования элемента доступен на [Learning](https://github.com/PrimoRPA/Learning/tree/master). Скачайте проект StudioActivities, откройте его в Студии и выберите процесс `StudioActivities/Ru/Коллекции/Фильтр таблицы.ltw` для просмотра. Пример выполнен в процессе с типом **Последовательность**.


## Только код

Элемент недоступен для использования в процессе с типом **Только код** (Pure code).

