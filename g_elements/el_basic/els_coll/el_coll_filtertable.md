# Фильтр таблицы

![](<../../../.gitbook/assets/image (100) (1) (1) (1) (1) (1) (1) (10) (209).png>)

![](<../../../.gitbook/assets/image (446).png>)

Элемент фильтрует данные таблицы по столбцу. Для этого он работает с переменной типа DataTable, которая хранит таблицу - ее возможно получить, например, после [**Чтения диапазона**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/prilozhenie-excel/el_excel_readrange) Excel-файла.

Запрос к таблице возможно указать двумя способами:
1. В свойстве **Запрос**. Допустимо использование переменных в запросе. 
2. При нажатии шестеренки на панели элемента. В этом случае откроется окно с параметрами условия запроса:

   ![](<../../../.gitbook/assets/Фильтр таблицы. Условие.png>)

   Данные в поле **Значение** рекомендуется указывать в кавычках ("") вне зависимости от формата ячейки в самой таблице. Например, если настроен фильтр по столбцу с датой, то ее тоже следует указывать в кавычках.\
   По кнопке ![](<../../../.gitbook/assets/12 (2) (3) (1) (1) (1).png>) можно добавить новое условие с оператором И/ИЛИ. Кнопка ![](<../../../.gitbook/assets/13 (1) (1) (2) (1) (1) (1).png>) удаляет ненужное условие.\
   После заполнения всех нужных параметров нажмите кнопку **ОК**.\
   Текст сформированного запроса можно просмотреть по нажатию кнопки **Запрос**. 

**ВАЖНО! Если одновременно заполнено свойство *Запрос* и условие в графическом окне, приоритет будет иметь запрос, указанный в свойстве.**

В случае, если результат фильтрации не удовлетворяет ни одному из условий, в ответе вернется только структура таблицы. 

| Свойство     | Тип                   | Описание                                                                            |
| ------------ | --------------------- | ----------------------------------------------------------------------------------- |
| ***Общие***  |  | Описание общих свойств см. в разделе [Работа с элементами](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements) |
| ***Управление коллекцией*** | | |
| Таблица\*    | [System.Data.DataTable](https://learn.microsoft.com/ru-ru/dotnet/api/system.data.datatable?view=net-5.0) | Переменная, содержащая таблицу данных |
| Запрос       | String                | Текст запроса таблицы данных (если не указан, то запрос формируется по данным Мастера - т.е. из настроек окна запроса) |
| ***Вывод***  |      |    |
| Переменная\* | System.Data.DataTable | Переменная для сохранения результатов фильтрации таблицы                            |
