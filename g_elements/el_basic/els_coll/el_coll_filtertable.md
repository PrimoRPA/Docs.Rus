# Фильтр таблицы

![](<../../../.gitbook/assets/image (100) (1) (1) (1) (1) (1) (1) (10) (209).png>)

![](<../../../.gitbook/assets/new-filter-of-table.png>)

Элемент фильтрует данные таблицы по столбцу. Для этого он работает с входной переменной типа DataTable, хранящей таблицу: ее возможно получить, например, после [**Чтения диапазона**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/prilozhenie-excel/el_excel_readrange) Excel-файла. 

Запрос фильтрации возможно указать:
1. В свойстве **Запрос**. Имеет приоритет над окнами мастеров, поддерживает переменные. В результате вернется таблица только с теми данными, которые соответствуют условиям запроса.
2. В окне **мастера фильтров**. Помимо указания запроса, предоставляет на выбор действие с результатом: удаление либо сохранение искомых данных.
3. В окне **мастера запросов**. В результате вернется таблица только с найденными данными.

:bangbang: ***Запрос должен быть указан только одним из перечисленных способов.***

### Мастер фильтров
При нажатии на элементе кнопки **Мастер фильтров** откроется окно вида:

![](<../../../.gitbook/assets/table-filter-wizard.png>)

Выбор вкладки определяет настройки либо для строк, либо для колонок таблицы.

1. На вкладке **Строки фильтра** добавьте запрос. Для этого:
   * В поле **Колонка** укажите столбец, данные по которому нужно отфильтровать. Название указывается в кавычках! Пример: `"1"`.
   * В поле **Операция** выберите операцию сравнения данных.
   * Заполните поле **Значение**. Указывайте значение в кавычках `" "` вне зависимости от формата ячейки в самой таблице. Например, если настроен фильтр по столбцу с датой, то ее тоже следует указывать в кавычках.
2. По кнопке ![](<../../../.gitbook/assets/12 (2) (3) (1) (1) (1).png>) можно добавить новое условие с оператором И/ИЛИ. Кнопка ![](<../../../.gitbook/assets/13 (1) (1) (2) (1) (1) (1).png>) удаляет ненужное условие.
3. Выберите действие, которое нужно совершить с результатом: **Сохранить** (по умолчанию) или **Удалить**. При сохранении в таблице будут выведены только найденные данные. При удалении - вернется отсортированная таблица, из которой удалена указанная строка (-и).

На вкладке **Столбцы результата** можно задать название колонок, которые требуется либо сохранить, либо удалить из результата. Название прописывается в кавычках:

![](<../../../.gitbook/assets/tab-with-result-col.png>)



### Мастер запросов
При нажатии кнопки **Мастер запросов** откроется окно вида:

![](<../../../.gitbook/assets/Фильтр таблицы. Условие.png>)

Запрос формируется аналогично мастеру фильтров. Текст сформированного запроса можно просмотреть по нажатию кнопки **Запрос**.

После заполнения всех нужных параметров нажмите кнопку **ОК**.

В случае, если результат фильтрации не удовлетворяет ни одному из условий, вернется только структура таблицы. 

## Свойства
Описание общих свойств элемента см. в разделе [Свойства элемента](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements#svoistva-elementa).\
Символ `*` в названии свойства указывает на обязательность его заполнения.

| Свойство     | Тип                   | Описание                                                                            |
| ------------ | --------------------- | ----------------------------------------------------------------------------------- |
| ***Управление коллекцией:*** | | |
| Таблица\*    | [System.Data.DataTable](https://learn.microsoft.com/ru-ru/dotnet/api/system.data.datatable?view=net-5.0) | Переменная, содержащая таблицу данных |
| Запрос       | String                | Текст запроса таблицы данных. Если не заполнено, то запрос формируется по данным мастера запросов или фильтров |
| Мастер       |                       | Данные из мастера фильтров. При очистке запроса в мастере свойство остается заполненным - удалите его, если это требуется |
| ***Вывод:***  |      |    |
| Переменная\* | System.Data.DataTable | Переменная для сохранения результатов фильтрации таблицы                       |
