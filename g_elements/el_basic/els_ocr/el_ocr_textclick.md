# Клик OCR-текста мышью

![](<../../../.gitbook/assets/ocr-text-screenshot2.png>)

Элемент сканирует экран компьютера и кликает мышью на искомом тексте. Для корректной работы требуется, чтобы текст для клика был полностью виден и не перекрывался окнами других приложений, в том числе Студией. Это означает, что при [отладке процесса](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/debug) Студия должна быть свернута. 

**Рекомендации:**

1. Инструмент OCR-распознавания не обладает 100%-ой точностью, поэтому при неудачном поиске строки пробуйте использовать разные слова из одной искомой фразы (в случае, если вы ищете текст из нескольких слов). 
1. Также следует проверить, что язык искомого текста и язык, указанный в подключении к ядру OCR, совпадают. Например, если вы используете данный элемент в контейнере [Microsoft OCR](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_ocr/el_ocr_microsoft) и хотите найти на экране русский текст, то убедитесь, что в Microsoft OCR, в свойстве **Язык**, указано значение `"ru-RU"`.



## Свойства
Символ `*` в названии указывает на обязательность заполнения свойства. Описание общих свойств элемента см. [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements#svoistva-elementa).

**Настройки OCR:**

* **Переменная\*** *[LTools.OCR.OCRInst]* — переменная со ссылкой на ядро OCR. Свойство заполняется, только если элемент используется вне контейнера Microsoft OCR/Tesseract OCR/Yandex Vision OCR. Например, если соединение с OCR в вашем процессе было установлено ранее и сохранено в переменную — тогда следует указать ее в этом свойстве, чтобы подключиться к ядру.

**Процесс:**

1. **Искомый текст\*** *[String]* — искомый текст на экране. Пример: `"text"`.
1. **Кнопка мыши\*** — кнопка мыши для клика. Доступные значения:
   * `INVOKE` — значение по умолчанию. Программный клик левой кнопкой мыши через Win32, который производится без наведения курсора. Необходимо помнить, что существуют приложения, которые не поддерживают программный клик.
   * `BUTTON_LEFT` — одинарный щелчок левой кнопкой, который имитирует действие человека: наводит курсор и производит клик. 
   * `BUTTON_LEFT_DOUBLECLICK` — двойной щелчок левой кнопкой.
   * `BUTTON_RIGHT` — одинарный щелчок правой кнопкой.
   * `BUTTON_MIDDLE` — колесико.
1. **Индекс** *[Int32]* — индекс вхождения искомого текста. При наличии нескольких строк, попадающих под условие поиска, укажите порядковый номер искомого текста. По умолчанию `0` — робот кликнет по первой подходящей строке.
1. **Таймаут\*** *[Int32]* — предельное время ожидания завершения процесса (мс). По умолчанию `10000`.

**OCR:**

1. **Смещение X** *[Int32]* — cмещение по оси X относительно центра искомого слова/фразы. По умолчанию `0` — клик по центру текста. Значение указывается в пикселях: допустимы положительные и отрицательные значения. При положительном числе смещение будет производиться вправо, при отрицательном — влево. Пример: `10` (клик на 10 пикселей вправо относительно центра).
1. **Смещение Y** *[Int32]* — cмещение по оси Y относительно центра искомого слова/фразы. По умолчанию `0` — клик по центру текста. Значение указывается в пикселях: при положительном числе смещение будет производиться вниз, при отрицательном — вверх.


### Сделать скриншот

Команда **Сделать скриншот**, расположенная на элементе, является информационной и предназначена для пользователя, а не для обработки роботом: 

![](<../../../.gitbook/assets/ocr-text-screenshot2.png>)

Например, можно сделать скриншот текста на экране, чтобы при просмотре процесса быстрее понять, какой элемент требовалось найти и кликнуть. 

![](<../../../.gitbook/assets/ocr-text-screenshot1.png>)


## Только код
Пример использования элемента в процессе с типом **Только код** (Pure code):

{% tabs %}
{% tab title="C#" %}
```csharp
LTools.OCR.OcrApp app = LTools.OCR.OcrApp.InitMicrosoft(wf, "ru-RU");
app.ClickText("text", 10000, 0, 0, LTools.Desktop.Model.MouseButtons.BUTTON_LEFT);
```
{% endtab %}

{% tab title="Python" %}
```python
app = LTools.OCR.OcrApp.InitMicrosoft(wf, "ru-RU")
app.ClickText("text", 10000, 0, 0, LTools.Desktop.Model.MouseButtons.BUTTON_LEFT)
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
var app = _lib.LTools.OCR.OcrApp.InitMicrosoft(wf, "ru-RU");
app.ClickText("text", 10000, 0, 0, _lib.LTools.Desktop.Model.MouseButtons.BUTTON_LEFT);
```
{% endtab %}
{% endtabs %}

