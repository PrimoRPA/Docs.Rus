# Таблица

![](<../../../.gitbook/assets/image (413).png>)

Получает указатель на UI-элемент «таблица».

## Свойства
Описание общих свойств элемента см. в разделе [Свойства элемента](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements#svoistva-elementa).\
Символ `*` в названии свойства указывает на обязательность заполнения.\
Символ ? в типе данных указывает на то, что значение может быть `null`.

| Свойство                    | Тип                                                                       | Описание                                                              |
| --------------------------- | ------------------------------------------------------------------------- | --------------------------------------------------------------------- |
| ***Процесс:*** | | |
| Окно        | String                     | Заголовок окна программы. Для его автоматического заполнения можно использовать инструмент ![](<../../../.gitbook/assets/image (794).png>) - просто наведите им на нужный заголовок |
| ID элемента                 | String                                                                    | ID элемента                                                           |
| Элемент                     | LTools.SAP.Model.SAPUIItem                                                | Ссылка на элемент управления                                          |
| Таблица                     | [LTools.SAP.Model.SAPUIGrid](datatypes/sapuigrid.md)                      | Переменная, хранящая ссылку на таблицу                                |
| Полное чтение               | bool                                                                      | Признак полного чтения данных таблицы, включая чек-боксы, цвет и т. д. |
| Таймаут\*                   | Int32                                                                     | Предельное время ожидания завершения процесса (мс). По умолчанию `10000` |
| Строгий таймаут | Boolean                 | Определяет, нужно ли незамедлительно прерывать выполнение элемента по истечении указанного времени в свойстве **Таймаут**. По умолчанию выключено - Робот может продолжать выполнение еще какое-то время, сверх установленного лимита, для полного обхода дерева контролов. На данный момент свойство **введено в тестовом режиме**, поэтому рекомендуется использовать его аккуратно |
| ***Действия:***  | | |
| Вставить строки             | String                                                                    | Вставить строки (`"0,1,5"` либо `*` для вставки в конец)              |
| Выбрать строки              | List\<int>                                                                | Массив строк для выбора                                               |
| Выбрать ячейки              | List\<string>                                                             | Массив ячеек для выбора                                               |
| Выбрать текущую ячейку      | String                                                                    | Выбрать текущую ячейку. Значение заполняется в формате 'индекс, ключ колонки' |
| Кнопка мыши                 | -                                                                         | По умолчанию `INVOKE` - одиночный клик левой кнопкой мыши. Это программный клик через Win32, окно приложения может быть свернуто. Существуют приложения, которые не поддерживают программный клик, в этом случае потребуется выбрать другое значение. <p>Щелкните выпадающий список: 1) `BUTTON_LEFT` - одиночный левый клик. Имитирует нажатие кнопки человеком. Окно программы должно быть развернутым; 2) `BUTTON_LEFT_DOUBLECLICK` - двойной клик левой кнопкой;  3) `BUTTON_RIGHT` - одиночный клик правой кнопкой;  4) `BUTTON_MIDDLE` - колесико  </p>|
| Кнопка клавиатуры           | -                                                                         | Кнопка клавиатуры. По умолчанию `None` - не выбрана. Для установки другого значения щелкните выпадающий список. Доступные значения: `CTRL`, `ALT`, `SHIFT` |
| Клик                        | Dictionary\<int, string>                                                  | Одиночный клик ячейки                                                 |
| Двойной клик                | Dictionary\<int, string>                                                  | Двойной клик ячейки                                                   |
| Клик текущей ячейки         | bool                                                                      | Одиночный клик текущей ячейки                                         |
| Двойной клик текущей ячейки | bool                                                                      | Двойной клик текущей ячейки                                           |
| Кнопка текущей ячейки       | bool                                                                      | Определяет, нужно ли нажать кнопку текущей ячейки                     |
| Кнопка управления           | String                                                                    | Осуществляет клик кнопки управления по идентификатору                 |
| Нажать F4                   | bool                                                                      | Определяет, нужно ли нажать клавишу `F4`                              |
| Нажать Enter                | bool                                                                      | Определяет, нужно ли нажать клавишу `Enter`                           |
| Изменить значение           | String                                                                    | Изменяет значение ячейки. Заполняется в формате: 'индекс, ключ колонки, значение' |
| Удалить строки              | String                                                                    | Удаляет строки ('0,1,5')                                              |
| ***Прокрутка:***  | | |
| Горизонтальная              | int?                                                                      | Горизонтальная прокрутка                                              |
| Вертикальная                | int?                                                                      | Вертикальная прокрутка                                                |
| ***Вывод:***  | | |
| Переменная                  | [LTools.SAP.Model.SAPUIGrid](datatypes/sapuigrid.md)                      | Переменная для сохранения ссылки на таблицу                           |
| Выбранные строки            | List\<int>                                                                | Массив индексов выбранных строк                                       |
| Выбранные ячейки            | Dictionary\<int, string>                                                  | Массив выбранных ячеек                                                |
| Колонки                     | List<[LTools.SAP.Model.SAPUIGridColumn](datatypes/sapuigridcolumn.md)>    | Информация о колонках таблицы                                         |
| Ячейки                      | List\<List<[LTools.SAP.Model.SAPUIGridCell](datatypes/sapuigridcell.md)>> | Значения ячеек таблицы                                                |
| Ячейки (Таблица)            | System.Data.DataTable                                                     | Значения ячеек таблицы в формате DataTable                            |
| Текущая ячейка              | String                                                                    | Координаты текущей ячейки 'индекс, ключ колонки'                      |
| Прокрутка                   | [System.Drawing.Point](https://learn.microsoft.com/ru-ru/dotnet/api/system.drawing.point?view=net-7.0) | Текущее состояние прокрутки              |
| Лимит прокрутки             | System.Drawing.Point                                                      | Предельное значение прокрутки                                         |


## Только код
Пример использования элемента в процессе с типом **Только код** (Pure code):

{% tabs %}
{% tab title="C#" %}
```csharp
LTools.SAP.SapApp app = LTools.SAP.SapApp.Init(wf);
LTools.SAP.Model.SAPUIGrid tbl = app.Table("/app/con[0]/ses[0]/wnd[0]/usr/cntlIMAGE_CONTAINER/shellcont/shell/shellcont[0]/shell");
tbl.SelectRows(new List<int>() { 1 });
```
{% endtab %}

{% tab title="Python" %}
```python
app = LTools.SAP.SapApp.Init(wf)
tbl = app.Table("/app/con[0]/ses[0]/wnd[0]/usr/cntlIMAGE_CONTAINER/shellcont/shell/shellcont[0]/shell")
tbl.SelectRows(List[int]([ 1 ]))
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
var host = new _lib.Microsoft.ClearScript.HostFunctions();
var app = _lib.LTools.SAP.SapApp.Init(wf);		
var tbl = app.Table("/app/con[0]/ses[0]/wnd[0]/usr/cntlIMAGE_CONTAINER/shellcont/shell/shellcont[0]/shell");
var idx = host.newObj(_lib.System.Collections.Generic.List(_lib.System.Int32));
idx.Add(1);
tbl.SelectRows(idx);
```
{% endtab %}
{% endtabs %}

