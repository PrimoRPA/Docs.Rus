# Исключение

*Throw*


![](<../../../.gitbook/assets/image (126).png>)

Элемент позволяет вызвать исключение в сценарии автоматизации. Вызов исключения может быть полезен в тестировании ошибочных сценариев и помогает настроить обработку исключений разных типов.


## Свойства

Описание общих свойств см. в разделе [Свойства элемента](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements#svoistva-elementa). Обязательными для заполнения являются либо свойство **Сообщение**, либо **Переменная исключения**. Остальные параметры опциональные.

1. **Сообщение\*** *[String]* — сообщение создаваемого исключения. Пример: `"Создаем пользовательское исключение"`. Если сообщение указано, то свойство **Переменная исключения** заполнять не надо.
2. **Переменная исключения**\* — название переменной для хранения исключения. Если переменная указана, то свойства *Код*, *Сообщение* и *Тип исключения* заполнять не нужно — значения будут взяты из переменной. Переменная может быть двух типов данных:
   - *[[System.Exception](https://learn.microsoft.com/ru-ru/dotnet/fundamentals/runtime-libraries/system-exception)]*. 
   - *[[LTools.Common.Model.ExecutionExceptionInfo](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/datatypes/executionexceptioninfo)]* — переменная с этим типом данных впоследствии может использоваться в элементе [Try-Catch](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_trycatch) для повторного вызова исключения (например, в блоке Catch). Этот тип данных поддерживается в версии 1.24.6.22 (LTS), а также в Студии версии 1.24.10+.
3. **Тип исключения** *[LTools.Common.Exceptions.ExceptionTypes]* — тип исключения. Чтобы выбрать значение, нажмите выпадающий список: 
   * General — общее исключение. Значение по умолчанию. 
   * ArgumentException — недопустимый аргумент, который передается методу.
   * NullReference — попытка обращения по нулевой ссылке.
   * IO Exception — ошибка ввода-вывода. Например, когда не найден указанный файл или папка.
   * Invalid Operation — 	вызов метода недопустим в текущем состоянии объекта.
   * Time Out — истекло время, выделенное для операции.
   * Custom — пользовательское исключение.
   * Business — исключение, связанное с бизнес-логикой. Например, когда определенные данные, которые необходимы в сценарии автоматизации, являются неполными или отсутствуют.
   * Application — исключение, которое вызвано технической проблемой, например, приложение не отвечает.
5. **Код** *[Int32]* — код исключения. Код указывается пользователем на свое усмотрение, заданных кодов нет. Пример: `1`.

## Дополнительно
С версии Студии 1.24.10 доступно [пакетное логирование](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/process/elements#paketnoe-vklyuchenie-logirovaniya-elementov). При отключении логирования для элемента **Исключение**, само исключение будет продолжать логироваться в рамках пакетного логирования. Это гарантирует фиксацию данных об ошибках и исключениях независимо от настроек для остальных элементов. 

## Пример использования

В нашем публичном репозитории [Learning](https://github.com/PrimoRPA/Learning) доступен RPA-проект, демонстрирующий работу элемента совместно с Try-Catch.

1. Скачайте архив со всеми обучающими материалами по ссылке: [Скачать архив Learning](https://github.com/PrimoRPA/Learning/archive/refs/heads/master.zip).
2. Распакуйте архив и откройте в Студии проект **StudioActivities**.
3. Выберите процесс `StudioActivities/Ru/Управление/Try-Catch Исключение.ltw` для просмотра.


## Только код

Пример использования элемента в процессе с типом **Только код** (Pure code):

{% tabs %}
{% tab title="C#" %}
```csharp
throw new Exception("ThrowText");
//Для изменения типа исключения следует вместо Exception указывать тот класс, который подходит в данной ситуации. Например, ApplicationException.
throw new ApplicationException("text2");
```
{% endtab %}

{% tab title="Python" %}
```python
raise Exception("ThrowText")
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
throw "ThrowText";
```
{% endtab %}
{% endtabs %}

