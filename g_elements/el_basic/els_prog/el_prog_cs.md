# C# Script

![](<../../../.gitbook/assets/image (100) (1) (1) (1) (1) (1) (1) (1) (2) (66).png>)

![](<../../../.gitbook/assets/image (137).png>)

Элемент производит выполнение сценария на языке C#. Код может быть указан в одном из свойств:
* Выражение;
* Сценарий.

Если значение указано одновременно и в **Выражении**, и в **Сценарии**, то будет выполняться **Выражение**.

Указанное значение доступно для быстрого просмотра на панели элемента:

![](<../../../.gitbook/assets/c-script-view-code.png>)

При наведении курсора на область с кодом можно также увидеть полное значение во всплывающей подсказке:

![](<../../../.gitbook/assets/c-script-hint-2.png>)

При двойном клике на область откроется редактор кода:

![](<../../../.gitbook/assets/c-script-edit-code.png>)


### Свойства
Описание общих свойств элемента см. в разделе [Свойства элемента](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements#svoistva-elementa).\
Символ `*` в названии свойства указывает на обязательность заполнения.

| Свойство             | Тип     | Описание                                                                                                                   |
| -------------------- | ------- | -------------------------------------------------------------------------------------------------------------------------- |
| ***Сценарий:***      |         |                                                                                                                            |
| Выражение            | String  | Выражение, возвращающее текст сценария. Значение нужно указывать в кавычках "" (исключение: включен режим **Без кода**). Синтаксис не проверяется |
| Сценарий             | -       | Текст сценария. Код указывается без кавычек, синтаксис проверяется                                                         |
| ***Вывод:***         |         |                                                                                                                            |
| Результат            | T       | Переменная для сохранения результатов выполнения сценария                                                                  |
| Обновлять переменные | Boolean | Определяет, нужно ли обновлять состояния переменных выполняемой последовательности. В случае обновления нельзя использовать конструкцию return |


### Улучшения версии 1.24.6

1. **Валидация сценария**: Добавлена проверка свойства `Сценарий` в элементе **C# Script** для улучшения точности выполнения кода. Ранее это поле не участвовало в проверке.
2. **Функциональность кнопок редактирования**: Восстановлена работоспособность кнопок вызова окна редактирования в элементах WFJSScript, WFPythonScript и WFPSScript.
3. **Дополнительная проверка**: В WFCSScript добавлена проверка на наличие оператора `return` при включенной опции `Обновлять переменные`.

### Обучающий пример

На портале Learning можно скачать процесс [Скрипты.ltw](https://github.com/PrimoRPA/Learning/blob/master/StudioActivities/Ru/%D0%9F%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5/%D0%A1%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D1%8B.ltw) (либо [Scripting.ltw](https://github.com/PrimoRPA/Learning/blob/master/StudioActivities/En/Programming/Scripting.ltw)- на англ.), демонстрирующий работу элемента. Добавьте этот процесс в свой проект в Студии, чтобы просмотреть его.
