# HTML к объекту

## Словарь

* Элемент – компонент, который задает команду Роботу.
* Процесс – модуль, содержащий несколько активностей (файл \*.ltw).
* Проект – набор процессов для выполнения поставленной задачи.

## Данные
Элементы из группы «Данные» предназначены для работы:
* с таблицами, строками, датами, изображениями и архивацией данных;
* с JSON, HTML, XML-кодом.

### HTML
Группа элементов **Данные > HTML** используется в бизнес-процессах, направленных на работу с HTML-кодом. Например, такой код может прийти в теле письма. Или может понадобиться извлечь данные из HTML-кода сайта и обработать их.

#### HTML к объекту
Элемент преобразует текст формата HTML в объект, а также позволяет произвести поиск в нем с помощью XPath. Если XPath указан, результат будет иметь тип данных [AngleSharp.Dom.INode](https://github.com/AngleSharp/AngleSharp):

![](<../../../../.gitbook/assets/html-to-object-type-variable.png>)

Пример: 

• **Данные (Data)** – переменная типа String, содержащая HTML-код:
```
<!DOCTYPE html>
<html>
      <body>
      <h2>Primo RPA</h2>
      <ul style="list-style-type:square;">
  	         <li id="1" class="studio">Primo Studio</li>
  	         <li id="2" class ="robot">Primo Robot</li>
  	         <li id="3" class ="orc">Primo Orchestrator</li>
      </ul>
      </body>
</html>
 ```

Присвоение HTML-кода в Студии:

![](<../../../../.gitbook/assets/html-to-object-assign.png>)

• **XPath** – язык запросов к элементам HTML. Может быть представлен в виде абсолютного и относительного пути:
1. Относительный путь начинается с двух наклонных черт и последующим одиночным тегом нужного нам элемента. Пример:

   `//*[@id="2"]` – поиск по свойству тега id.

   `//*[@id>"1"]` – поиск по свойству тега id (все, где id больше 1).

   `//li[@class="studio"]` – поиск во всех элементах li по свойству class.
3. Абсолютный путь - является простейшим маршрутом поиска, указывающим на корневой узел документа. Начинается с наклонной черты. Пример:

   `/html/body/ul/li[2]` – поиск второго элемента списка.

Присвоение xPath в Студии:
 
![](<../../../../.gitbook/assets/html-to-object-assign-xpath.png>)

Активность **HTML to object** в Студии:

![](<../../../../.gitbook/assets/html-to-object-in-studio.png>)

• **Переменная (Variable)** – переменная типа System.Collections.Generic.List\<AngleSharp.Dom.INode\>.

### Полезные ссылки

1. Ссылка для ознакомления с теорией по созданию XPath запросов: https://devhints.io/xpath

2. Ссылка для проверки созданных XPath запросов: http://xpather.com/ 

3. Ссылка на библиотеку AngleSharp: https://github.com/AngleSharp/AngleSharp

4. :bangbang: ***Ссылка на гитхаб с примером появится, когда согласуем добавление***











