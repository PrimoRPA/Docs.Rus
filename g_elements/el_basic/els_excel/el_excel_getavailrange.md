# Найти начальную/конечную строку

![](<../../../.gitbook/assets/Найти начальную-конечную строку.png>)

Элемент помогает определить границы данных в листе Excel в рамках указанного столбца. В ответе возвращаются номера первой и последней строк с данными в столбце. Элемент работает с обоими драйверами: DX и Interop. 

Дополнительно в свойствах возможно настроить способы определения строк.

> _Описание общих свойств см. в разделе_ [_**Работа с элементами**_](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements).

| Свойство                  | Тип     | Описание                                                                                                                                    
| ------------------------- | ------- | ----------------------------------------------------------------------------------------------------------------------
| ***Excel:***       | | 
| Диапазон                  | String  | Диапазон считывания ячеек, где нужно найти заполненные строки. Например, `"A1:D12"`. Если указан символ "\*", то будет прочитан весь лист. Если не указан, будет прочитан выделенный диапазон 
| Столбец с данными\*       | String  | Адрес столбца с данными
| Страница                  | String  | Название страницы Excel, где нужно найти строки с данными         
| Индекс страницы           | Int32   | Номер страницы Excel, отсчет с 0
| Индекс первой строки      | Int32   | Количество строк, которые нужно прибавить к номеру первой строки. Например, когда в таблице есть скрытые строки
| Индекс последней строки   | - | Выберите способ определения номера последней строки. Возможные значения: 1) First Empty Row (по умолчанию) - если выбрано это значение, то последней строкой будет считаться первая пустая строка. 2) Last Populated Row - вернет номер последней строки, содержащей данные 
| Разрешенное число пустых строк | Int32 | Позволяет установить количество последовательных пустых строк в найденных данных, прежде чем будет определено, что диапазон закончился. Если свойство не заполнено, то будут пропускаться все пустые строки. В этом случае концом данных будет или конец выбранного диапазона, или последняя заполненная строка в выбранном столбце (если диапазон="\*")
| Строка заголовков         | Boolean | Установите флаг, если первая строка содержит заголовки таблицы
| ***Вывод:***       | |
| Начало диапазона данных   | Int32   | Переменная для хранения начала диапазона данных на листе Excel. Фактически - номер первой строки с данными                                              
| Конец диапазона данных    | Int32   | Переменная для хранения конца диапазона данных


{% tabs %}
{% tab title="C#" %}
```csharp
LTools.Office.ExcelApp app = LTools.Office.ExcelApp.Init(wf, @"c:\file.xlsx");
Tuple<int, int> data = app.FindFirstAndLastDataRow("A1:C22", null, 0, "A1");
```
{% endtab %}

{% tab title="Python" %}
```python
app = LTools.Office.ExcelApp.Init(wf, @"c:\file.xlsx")
data = app.FindFirstAndLastDataRow("A1:C22", None, 0, "A1")
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
var app = _lib.LTools.Office.ExcelApp.Init(wf, @"c:\file.xlsx");
var data = app.FindFirstAndLastDataRow("A1:C22", null, 0, "A1");
```
{% endtab %}
{% endtabs %}
