---
description: Copy range
---

# Копирование диапазона

Элемент копирует диапазон ячеек из файла-источника и вставляет его в другой лист Excel. Путь до файла-источника указывается в контейнере [Приложение Excel](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_excel/el_excel_app). 

Существует возможность вставить скопированный диапазон как в файл-источник, так и во внешний файл Excel. Выбор файла назначения определяется настройками, указанными в свойствах элемента.

![Элемент «Копирование диапазона»](<../../../.gitbook/assets1/windows_items/WFCopyRange1.png>)


## Свойства
Обязательные для заполнения свойства отмечены символом `*`. Описание общих свойств см. в разделе [Свойства элемента](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements#svoistva-elementa).

1. **Диапазон-источник\*** *[String]* — диапазон ячеек, которые следует скопировать. Диапазон можно указать в точности либо использовать символ подстановки `*` вместо столбца или номера строки. Например: `"A1:*12"` или `"A1:D*"`.
1. **Диапазон-приемник\*** *[String]* — диапазон ячеек для вставки данных. Можно указать диапазон полностью либо только стартовую ячейку. Пример: `"A1"`.
1. **Страница-источник** *[String]* — название страницы-источника данных. Если указан индекс страницы, название можно не заполнять. Пример: `"Лист1"`.
1. **Индекс страницы-источника** *[Int32]* — номер страницы-источника. Нумерация начинается с нуля. Если указано название страницы, индекс можно не заполнять. Пример: `0`.
1. **Страница-приемник** *[String]* — название страницы-приемника данных. Пример: `"Лист2"`.
1. **Индекс страницы-приемника** *[Int32]* — номер страницы-приемника. Нумерация начинается с нуля. Пример: `1`.
1. **Формат** — формат, в котором следует скопировать данные. Возможные значения:
   * `All` — скопируются все значения, форматы и формулы из диапазона. Значение по умолчанию.
   * `Values` — скопируются только значения. Формат ячеек и формулы будут проигнорированы — вместо формул подставится готовый результат.
   * `Formulas` — скопируются значения и формулы. Чтобы значение формул корректно отображалось при вставке, добавьте после копирования диапазона компонент [Пересчет формул](https://docs.primo-rpa.ru/primo-rpa/g\_elements/osnovnye-elementy/prilozhenie-excel/el\_excel\_calc).
   * `Formats` — скопируются только формат ячеек, шрифт и цвета. Значения и формулы проигнорируются.
1. **Путь к документу** *[String]* — путь к внешнему файлу Excel, в который следует вставить данные. Логика работы:
   * `если путь указан` — робот обновит внешний файл Excel и автоматически сохранит его состояние. При этом состояние файла-источника, открытого в текущем контейнере **Приложение Excel**, не изменится. Помните, что внешний файл и указанная страница-приемник должны существовать заранее. 
   * `если путь не указан` — робот вставит скопированный диапазон в файл-источник, открытый в текущем контейнере **Приложение Excel**. Для того чтобы сохранить изменения в файле-источнике, воспользуйтесь элементом [Сохранить документ](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_excel/el_excel_save).



## Только код

Пример использования элемента в процессе с типом **Только код** (Pure code):

{% tabs %}
{% tab title="C#" %}
```csharp
LTools.Office.ExcelApp app = LTools.Office.ExcelApp.Init(wf, @"c:\file.xlsx");
app.CopyRange("A1:C22", "A1:C22", null, 0, null, 1);
```
{% endtab %}

{% tab title="Python" %}
```python
app = LTools.Office.ExcelApp.Init(wf, @"c:\file.xlsx")
app.CopyRange("A1:C22", "A1:C22", None, 0, None, 1)
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
var app = _lib.LTools.Office.ExcelApp.Init(wf, @"c:\file.xlsx");
app.CopyRange("A1:C22", "A1:C22", null, 0, null, 1);
```
{% endtab %}
{% endtabs %}
