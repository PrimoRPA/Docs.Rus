---
description: Copy range
---


# Копирование диапазона

Элемент позволяет скопировать диапазон ячеек Excel и вставить в другой лист. Вставку возможно осуществить как внутри одного документа, так и во внешний файл Excel.

Чтобы внесенные изменения применились, используйте также элемент [**Сохранить документ**](https://docs.primo-rpa.ru/primo-rpa/g\_elements/osnovnye-elementy/prilozhenie-excel/el\_excel\_save).

![](<../../../.gitbook/assets1/WFCopyRange.png>)

## Свойства
Символ `*` в названии свойства указывает на обязательность заполнения. Описание общих свойств см. в разделе [Свойства элемента](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements#svoistva-elementa).

| Свойство                  | Тип    | Описание                                                                                                                                                                                      | Пример      | 
| ------------------------- | ------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------- | 
| Диапазон-источник\*       | String | Диапазон ячеек, которые нужно скопировать. Диапазон можно указать в точности: "A1:D12" либо использовать символ `*` вместо столбца или номера строки. Например: "A1:\*12" или "A1:D\*"        | `"A1:D12"`  | 
| Диапазон-приемник\*       | String | Диапазон ячеек для вставки данных. Можно указать диапазон полностью либо только стартовую ячейку, например, "A1"                                                                              | `"A1"`      |
| Страница-источник         | String | Название страницы-источника данных                                                                                                                                                            | `"Лист1"`   |
| Индекс страницы-источника | Int32  | Номер страницы-источника (нумерация с 0). Если указано название страницы, номер можно пропустить                                                                                              | `0`         |
| Страница-приемник         | String | Название страницы-приемника данных                                                                                                                                                            |  `"Лист2"`  |
| Индекс страницы-приемника | Int32  | Номер страницы-приемника (нумерация с 0). Если указано название страницы, номер можно пропустить                                                                                              | `1`         |
| Формат                    |        | Формат, в котором нужно скопировать данные. Чтобы выбрать формат, кликните по списку значений свойства. <p>Возможные значения:</p> <p> 1. **All** (по умолчанию) — будут скопированы все значения, форматы и формулы из диапазона.</p> <p> 2. **Values** — будут скопированы только значения. Формат ячеек и формулы будут проигнорированы — вместо формул подставится готовый результат.</p> <p> 3. **Formulas** — будут скопированы значения и формулы. Чтобы значение формул корректно отображалось при вставке, добавьте после копирования диапазона компонент [**Пересчет формул**](https://docs.primo-rpa.ru/primo-rpa/g\_elements/osnovnye-elementy/prilozhenie-excel/el\_excel\_calc).</p> <p> 4. **Formats** — будет скопирован только формат ячеек, шрифт и цвета. Значения и формулы проигнорируются </p> | `All`
| Путь к документу          | String | Путь к внешнему файлу Excel, в который нужно вставить данные. Если не задан, то диапазон вставится внутри файла-источника, указанного в контейнере [Приложение Excel](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_excel/el_excel_app) |


## Только код

Пример использования элемента в процессе с типом **Только код** (Pure code):

{% tabs %}
{% tab title="C#" %}
```csharp
LTools.Office.ExcelApp app = LTools.Office.ExcelApp.Init(wf, @"c:\file.xlsx");
app.CopyRange("A1:C22", "A1:C22", null, 0, null, 1);
```
{% endtab %}

{% tab title="Python" %}
```python
app = LTools.Office.ExcelApp.Init(wf, @"c:\file.xlsx")
app.CopyRange("A1:C22", "A1:C22", None, 0, None, 1)
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
var app = _lib.LTools.Office.ExcelApp.Init(wf, @"c:\file.xlsx");
app.CopyRange("A1:C22", "A1:C22", null, 0, null, 1);
```
{% endtab %}
{% endtabs %}
