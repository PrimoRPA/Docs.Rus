# Присоединиться к приложению

![](<../../../.gitbook/assets/image (191).png>)

Компонент осуществляет подключение к действующему процессу внешнего приложения.

**Примечания к свойствам элемента**:

1. **Заголовок** - для автоматического заполнения параметра нажмите кнопку <img src="../../../.gitbook/assets/14 (1) (2) (1) (1) (2) (1) (13).png" alt="" data-size="line">. Появится селектор для выбора заголовка приложения - достаточно кликнуть на заголовок нужного окна.
2. **Тип автоматизации** - технология автоматизации обеспечивает программный доступ к элементам пользовательского интерфейса приложений. Доступны следующие типы:
   * UIAUTOMATION - значение по умолчанию. Подходит для приложений рабочего стола, работающих по правилам Win32.
   * UIAUTOMATION\_UIA - рекомендуется использовать в случае, если в режиме UIAUTOMATION не удается получить доступ к нужному элементу управления.
   * MSAA - библиотека Microsoft Active Accessibility. Имеет больше ограничений, чем UIAUTOMATION. Обращение к MSAA будет полезным в ограниченном количество случаев: например, когда при поиске текстовых элементов необходимо использовать свойство идентификации Role.
   * DESKTOP\_ANYWHERE - позволяет взаимодействовать с приложениями, запущенными на удаленном рабочем столе (RDP, Citrix, VMWare и т.д.). Для работы с удаленным приложением необходимо установить агента Desktop Anywhere на удаленной машине. Общение происходит по протоколу HTTP.
   * RDP - используется для работы с приложениями удаленного рабочего стола [по протоколу RDP](https://docs.primo-rpa.ru/primo-rpa/primo-studio/instrumenty/rdp).
   * JAVA и JAVA\_EXT - предназначены для Java-приложений. Тип Java использует расширение Primo, тип Java\_Ext - расширения сторонних вендоров. Разрядность Студии и Робота должны совпадать с разрядностью Java.

Общие свойства элемента описаны в разделе [Работа с элементами](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements). Утилитарные свойства приведены в таблице ниже.

| Свойство               | Тип                               | Описание                                                                                                                                                                                                       |
| ---------------------- | --------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| _**Рабочий стол**_     |                                   |                                                                                                                                                                                                                |
| Заголовок              | String                            | Заголовок подключаемого приложения                                                                                                                                                                             |
| Имя процесса           | String                            | Название процесса запущенного приложения. Если указан заголовок приложения, имя процесса можно не указывать. Если заполнены оба свойства, при подключении будут учитываться оба значения                       |
| Переменная             | LTools.Desktop.DesktopInst        | Для быстрого присоединения к ранее подключенному процессу укажите переменную, которая содержит ссылку на нужный процесс. Если указана переменная, свойства **Заголовок** и **Имя процесса** можно не заполнять |
| Таймаут\*              | Int32                             | Предельное время ожидания завершения процесса (мс)                                                                                                                                                             |
| _**Процесс**_          |                                   |                                                                                                                                                                                                                |
| Текущий пользователь   | bool                              | Признак получения процессов только текущего пользователя                                                                                                                                                       |
| Тип автоматизации      | LTools.Desktop.Model.DesktopTypes | Выберите тип автоматизации для взаимодействия с десктоп-приложением. По умолчанию используется UIAUTOMATION - для приложений, работающих по правилам Win32                                                     |
| _**Desktop Anywhere**_ |                                   |                                                                                                                                                                                                                |
| Адрес                  | String                            | Если был выбран тип автоматизации DESKTOP\_ANYWHERE, укажите адрес сервиса для подключения                                                                                                                     |
| Логин                  | String                            | Логин сервиса                                                                                                                                                                                                  |
| Пароль                 | String                            | Пароль сервиса                                                                                                                                                                                                 |
| _**Вывод**_            |                                   |                                                                                                                                                                                                                |
| Переменная             | LTools.Desktop.DesktopInst        | Переменная вывода, которая сохраняет ссылку на подключенный процесс                                                                                                                                            |

{% tabs %}
{% tab title="C#" %}
```csharp
LTools.Desktop.DesktopApp app = LTools.Desktop.DesktopApp.Init(wf, "Calc*", null, 10000, true, LTools.Desktop.Model.DesktopTypes.UIAUTOMATION);
```
{% endtab %}

{% tab title="Python" %}
```python
app = LTools.Desktop.DesktopApp.Init(wf, "Calc*", None, 10000, True, LTools.Desktop.Model.DesktopTypes.UIAUTOMATION)
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
let app = _lib.LTools.Desktop.DesktopApp.Init(wf, "Calc*", null, 10000, true, _lib.LTools.Desktop.Model.DesktopTypes.UIAUTOMATION);
```
{% endtab %}
{% endtabs %}
