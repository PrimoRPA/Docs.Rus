# Присоединиться к приложению

*Eng: Attach application*

![](<../../../.gitbook/assets/image (191).png>)

Компонент осуществляет подключение к действующему процессу внешнего приложения.

**Примечания к свойствам элемента**:

1. **Заголовок** - для автоматического заполнения параметра нажмите кнопку <img src="../../../.gitbook/assets/14 (1) (2) (1) (1) (2) (1) (13).png" alt="" data-size="line">. Появится селектор для выбора заголовка приложения - достаточно кликнуть на заголовок нужного окна.
2. **Тип автоматизации** - технология автоматизации обеспечивает программный доступ к элементам пользовательского интерфейса приложений. Доступны следующие типы:
   * UIAUTOMATION - значение по умолчанию. Подходит для приложений рабочего стола, работающих по правилам Win32.
   * RDP - используется для работы с приложениями удаленного рабочего стола [по протоколу RDP](https://docs.primo-rpa.ru/primo-rpa/primo-studio/instrumenty/rdp).
   * JAVA - предназначены для Java-приложений. Тип Java использует расширение Primo, тип Java\_Ext - расширения сторонних вендоров. Разрядность Студии и Робота должны совпадать с разрядностью Java.
   * DESKTOP\_ANYWHERE - позволяет взаимодействовать с приложениями, запущенными на удаленном рабочем столе (RDP, Citrix, VMWare и т.д.). Для работы с удаленным приложением необходимо установить агента Desktop Anywhere на удаленной машине. Общение происходит по протоколу HTTP.
   * JAVA\_EXT - предназначены для Java-приложений. Тип Java использует расширение Primo, тип Java\_Ext - расширения сторонних вендоров. Разрядность Студии и Робота должны совпадать с разрядностью Java.
   * UIAUTOMATION\_UIA - рекомендуется использовать в случае, если в режиме UIAUTOMATION не удается получить доступ к нужному элементу управления.
   * MSAA - библиотека Microsoft Active Accessibility. Имеет больше ограничений, чем UIAUTOMATION. Обращение к MSAA будет полезным в ограниченном количество случаев: например, когда при поиске текстовых элементов необходимо использовать свойство идентификации Role.


### Свойства

Символ `*` в названии свойства указывает на обязательность заполнения.

| Свойство               | Тип                               | Описание                                                                                                                                                                                                       |
| ---------------------- | --------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| _**Desktop Anywhere**_ |                                   |                                                                                                                                                                                                                |
| Адрес                  | String                            | Если был выбран тип автоматизации DESKTOP\_ANYWHERE, укажите адрес сервиса для подключения                                                                                                                     |
| Логин                  | String                            | Логин сервиса                                                                                                                                                                                                  |
| Пароль                 | String                            | Пароль сервиса                                                                                                                                                                                                 |
| _**Вывод**_            |                                   |                                                                                                                                                                                                                |
| Переменная             | LTools.Desktop.DesktopInst        | Переменная вывода, которая сохраняет ссылку на подключенный процесс                                                                                                                                           |
| _**Общие**_            |                                   |                                                                                                                                                                                                                |
| Наименование           | String                            | Наименование приложения для присоединения                                                                                                                                                                      |
| Отключить логирование  | bool                              | Признак отключения логирования                                                                                                                                                                                |
| Пауза до (мс)          | Int32                             | Время паузы перед выполнением (в миллисекундах)                                                                                                                                                                |
| Пауза после (мс)       | Int32                             | Время паузы после выполнения (в миллисекундах)                                                                                                                                                                 |
| Продолжить при ошибке  | bool                              | Признак продолжения работы при возникновении ошибки                                                                                                                                                            |
| Скриншот завершения    | bool                              | Признак необходимости делать скриншот по завершении работы                                                                                                                                                     |
| Скриншот ошибки        | bool                              | Признак необходимости делать скриншот при ошибке                                                                                                                                                               |
| _**Процесс**_          |                                   |                                                                                                                                                                                                                |
| Текущий пользователь   | bool                              | Признак получения процессов только текущего пользователя                                                                                                                                                       |
| Тип автоматизации      | LTools.Desktop.Model.DesktopTypes | Выберите тип автоматизации для взаимодействия с десктоп-приложением. По умолчанию используется UIAUTOMATION - для приложений, работающих по правилам Win32                                                     |
| _**Рабочий стол**_     |                                   |                                                                                                                                                                                                                |
| Заголовок              | String                            | Заголовок подключаемого приложения                                                                                                                                                                             |
| Имя процесса           | String                            | Название процесса запущенного приложения. Если указан заголовок приложения, имя процесса можно не указывать. Если заполнены оба свойства, при подключении будут учитываться оба значения                       |
| Переменная             | LTools.Desktop.DesktopInst        | Для быстрого присоединения к ранее подключенному процессу укажите переменную, которая содержит ссылку на нужный процесс. Если указана переменная, свойства **Заголовок** и **Имя процесса** можно не заполнять |
| Таймаут*             | Int32                             | Предельное время ожидания завершения процесса (мс)            


###  Пример Learning

Для изучения работы с элементом **Присоединиться к приложению**, вы можете скачать обучающий RPA-проект по следующей ссылке: [Скачать архив Learning](https://github.com/PrimoRPA/Learning/archive/refs/heads/master.zip)

1. Скачайте архив с обучающими материалами с указанной страницы.
2. Распакуйте архив и откройте проект `StudioActivities` в Студии.
3. Найдите процесс `StudioActivities/Ru/Рабочий стол/Присоединиться к приложению.ltw` для изучения работы элемента.

## Только код

Пример использования элемента в процессе с типом **Только код** (Pure code)

{% tabs %}
{% tab title="C#" %}
```csharp
LTools.Desktop.DesktopApp app = LTools.Desktop.DesktopApp.Init(wf, "Calc*", null, 10000, true, LTools.Desktop.Model.DesktopTypes.UIAUTOMATION);
```
{% endtab %}

{% tab title="Python" %}
```python
app = LTools.Desktop.DesktopApp.Init(wf, "Calc*", None, 10000, True, LTools.Desktop.Model.DesktopTypes.UIAUTOMATION)
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
let app = _lib.LTools.Desktop.DesktopApp.Init(wf, "Calc*", null, 10000, true, _lib.LTools.Desktop.Model.DesktopTypes.UIAUTOMATION);
```
{% endtab %}
{% endtabs %}
