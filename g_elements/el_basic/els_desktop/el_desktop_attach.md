---
description: Attach application
---


# Присоединиться к приложению

![](<../../../.gitbook/assets/image (191).png>)

Элемент осуществляет подключение к действующему процессу внешнего приложения. Если нужное приложение еще не запущено, предварительно воспользуйтесь элементом [Запустить приложение](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_desktop/el_desktop_startapp).

Элемент **Присоединиться к приложению** является контейнером по отношению к другим компонентам автоматизации, которые взаимодействуют с элементами интерфейса приложения. Например, вы можете поместить в этот контейнер компонент [Клик мышью](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_uiinteraction/el_click), чтобы кликнуть по определенной кнопке приложения рабочего стола, к которому вы подключились.


### Свойства

Обязательные для заполнения свойства отмечены символом `*`. Описание общих свойств элемента см. [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements#svoistva-elementa).

**Процесс**:                                                                                                                                                                                                         

1. **Тип автоматизации** *[LTools.Desktop.Model.DesktopTypes]* — технология автоматизации, которая обеспечивает программный доступ к элементам пользовательского интерфейса приложения. Доступные значения:
   * `UIAUTOMATION` — значение по умолчанию. Современная технология автоматизации для взаимодействия с приложениями, которые работают по правилам Win32.
   * `UIAUTOMATION_UAI` — рекомендуется использовать в случае, если в режиме UIAUTOMATION не удается получить доступ к нужному приложению.
   * `MSAA` — устаревшая технология Microsoft Active Accessibility. Имеет больше ограничений, чем UIAUTOMATION. 
   * `RDP` — для взаимодействия с приложениями удаленного рабочего стола по протоколу RDP.
   * `JAVA` — для взаимодействия с Java-приложениями.
   * `JAVA_EXT` — для более глубокого взаимодействия с Java-приложениями, 
   * `DESKTOP ANYWHERE` — для взаимодействия с приложениями удаленного рабочего стола через утилиту [Desktop Anywhere](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/tools/desktop-anywhere).
1. **Текущий пользователь** *[bool]* — определяет, следует ли подключиться только к процессу текущего пользователя. По умолчанию не используется.

**Desktop Anywhere**:

> Свойства этой группы заполняются только в случае, если вы хотите присоединиться к приложению удаленного рабочего стола через утилиту Desktop Anywhere. 

1. **Адрес** *[String]* — адрес сервиса Desktop Anywhere, если в качестве типа автоматизации был выбран DESKTOP ANYWHERE.   
1. **Логин** *[String]* — логин сервиса Desktop Anywhere.
1. **Пароль** *[String]* — пароль сервиса Desktop Anywhere.


**Рабочий стол**:

1. **Заголовок** *[String]* — заголовок подключаемого приложения. Чтобы автоматически заполненить значение, нажмите кнопку <img src="../../../.gitbook/assets/14 (1) (2) (1) (1) (2) (1) (13).png" alt="" data-size="line">. Появится селектор для выбора заголовка приложения — кликните инструментом по заголовку окна приложения.
1. **Имя процесса**  *[String]* — название процесса запущенного приложения. Если указан заголовок приложения, имя процесса можно не указывать. Если заполнены оба свойства, то при подключении будут учитываться оба значения.
1. **Переменная** *[LTools.Desktop.DesktopInst]* — позволяет быстро присоединиться к уже подключенному процессу. В этом свойстве указывается название переменной, которая содержит ссылку на подключенный процесс. Если указана переменная, свойства **Заголовок** и **Имя процесса** заполнять не нужно.
1. **Таймаут*** [Int32] — предельное время ожидания завершения процесса, указывается в миллисекундах. По умолчанию `10000`.       

                                                                                                             
**Вывод**:                          

* **Переменная** *[LTools.Desktop.DesktopInst]* — название переменной, в которую сохранится ссылка на подключенный процесс.


## Пример использования

Пример использования элемента **Присоединиться к приложению** представлен в нашем публичном репозитории Learning. 

1. Скачайте архив с обучающими материалами по ссылке: [Скачать архив Learning](https://github.com/PrimoRPA/Learning/archive/refs/heads/master.zip).
2. Распакуйте архив и откройте проект `StudioActivities` в Студии.
3. Откройте процесс `StudioActivities/Ru/Рабочий стол/Присоединиться к приложению.ltw`.

## Только код

Пример использования элемента в процессе с типом **Только код** (Pure code)

{% tabs %}
{% tab title="C#" %}
```csharp
LTools.Desktop.DesktopApp app = LTools.Desktop.DesktopApp.Init(wf, "Calc*", null, 10000, true, LTools.Desktop.Model.DesktopTypes.UIAUTOMATION);
```
{% endtab %}

{% tab title="Python" %}
```python
app = LTools.Desktop.DesktopApp.Init(wf, "Calc*", None, 10000, True, LTools.Desktop.Model.DesktopTypes.UIAUTOMATION)
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
let app = _lib.LTools.Desktop.DesktopApp.Init(wf, "Calc*", null, 10000, true, _lib.LTools.Desktop.Model.DesktopTypes.UIAUTOMATION);
```
{% endtab %}
{% endtabs %}
