# Копирование диапазона

![](<../../../../.gitbook/assets1/Cropped-CopyRange.png>)

Компонент, позволяющий скопировать диапазон ячеек Excel и вставить в другой лист. Вставку возможно осуществить как внутри одного документа, так и во внешний файл Excel.

Диапазон копируется в соответствии с форматом, заданным в одноименном свойстве. Доступны следующие варианты:

* **All** (по умолчанию) - будут скопированы все значения, форматы и формулы из диапазона.
* **Values** - будут скопированы только значения. Формат ячеек и формулы будут проигнорированы - вместо формул подставится готовый результат.
* **Formulas** - будут скопированы значения и формулы. Чтобы значение формул корректно отображалось при вставке, добавьте после копирования диапазона компонент **Пересчет формул**.
* **Formats** - будет скопирован только формат ячеек, шрифт и цвета. Значения и формулы проигнорируются.

**ВАЖНО!** После копирования диапазона не забудьте использовать элемент **Сохранить документ**, чтобы внесенные изменения применились.

## Свойства

Описание общих свойств элемента см. в разделе [Свойства элемента](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements#svoistva-elementa).\
Символ `*` в названии свойства указывает на обязательность заполнения.

1. **Диапазон-источник\*** *[String]*: Укажите диапазон ячеек, которые нужно скопировать. Диапазон можно указать в точности: "A1:D12" либо использовать символ \* вместо столбца или номера строки, например: "A1:\*12" или "A1:D\*".
2. **Диапазон-приемник\*** *[String]*: Укажите диапазон ячеек для вставки данных. Например, `A1:D12` или `A1`.
3. **Страница-источник** *[String]*: Введите наименование страницы-источника данных.
4. **Индекс страницы-источника** *[Int32]*: Номер страницы-источника (отсчет с 0).
5. **Страница-приемник** *[String]*: Наименование страницы-приемника данных.
6. **Индекс страницы-приемника** *[Int32]*: Номер страницы-приемника (отсчет с 0).
7. **Формат**: Выберите, в каком формате нужно скопировать данные. Описание значений приведено выше.
8. **Путь к документу** *[String]*: Если данные нужно вставить во внешний файл Excel, укажите к нему путь. Если он не задан, диапазон будет вставлен внутри файла-источника.

## Только код
Пример использования элемента в процессе с типом Только код (Pure code):  

**C#**  
`Primo.Office.OdfOxml.ExcelApp app = Primo.Office.OdfOxml.ExcelApp.Init(wf, [file]);`   
`app.CopyRange(range, rangeTo, [sheet], [sheetIdx], [sheetTo], [sheetIdxTo], [format], [file]);`

