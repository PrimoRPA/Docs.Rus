# Добавить в очередь

![](<../../../../.gitbook/assets/image (100) (1) (1) (1) (1) (1) (1) (1) (2).png>)

![](<../../../../.gitbook/assets/image (375).png>)

Помогает добавить значение в очередь Оркестратора. Добавленное значение (элемент очереди) получит статус _New_.

Пример отображения добавленного элемента очереди в интерфейсе Оркестратора:

![](<../../../../.gitbook/assets/оркестратор. элементы очереди.png>)

**ВАЖНО!** Для корректной работы компонента **Добавить в очередь** обязательно нужно заполнить свойства **Очередь** и **Значение** (либо **Таблица**). В случае, если заполнены оба свойства - _Значение_ и _Таблица_ - в данные будет записана только таблица. 

| Свойство      |    Тип                 | Описание                           | 
| ------------- | :--------------------: | ---------------------------------- | 
| ***Процесс*** |   |  |  
| Очередь\*     | String                 | Имя очереди, в которую должен быть добавлен _Элемент очереди_ (Значение). Должно совпадать с именем очереди, созданной в Оркестраторе. Чувствительно к регистру |
| Значение      | String                 | Установите значение элементу очереди. Может быть в виде JSON либо переменной, в которой он сохранен. Обратите внимание, что в JSON потребуется заэкранировать все кавычки: **\\"** |
| Таблица       | DataTable              | Если значение имеет вид таблицы, заполните это поле (переменная) |
| Идентификатор | String                 | Ключ элемента очереди (это не ID). Ключ выполняет схожую функцию с ID, но ID присваивается автоматически при добавлении элемента в очередь, имеет формат Guid, и его нельзя изменить. Ключ же можно задать вручную как дополнительный идентификатор. Как правило, используется для упрощенного распознавания элемента |
| Метаданные    | Dictionary\<string, string> | Метаданные элемента очереди. В дальнейшем могут помочь при фильтрации. Зачастую это динамические данные |
| Тэги          | List\<string>               | Теги для элемента очереди. В дальнейшем могут помочь при фильтрации элементов |
| Недоступен до | DateTime                    | Укажите дату, до наступления которой Робот не сможет обрабатывать элемент очереди |
| Устранить после | DateTime                  | Укажите дату, после которой элемент нужно удалить из очереди |
| Забирать      | Boolean                     | Включите этот параметр, если после добавления элемента в очередь его нужно немедленно взять в работу. В результате другие роботы Оркестратора не успеют взять ваше значение в обработку |
| Таймаут       | Int32  | Лимит времени операции (мс). Если по истечении лимита операция не выполнена, Робот закончит работу с ошибкой |
| ***Вывод***   |  |   |
| Элемент       | [LTools.Enterprise.Model.QueueItem](https://docs.primo-rpa.ru/primo-rpa/g\_elements/osnovnye-elementy/orkestrator/els\_queues/datatypes) | Укажите переменную, в которую нужно сохранить добавленный элемент очереди |


**Примечания к свойствам**:

1. Описание общих свойств элемента см. в разделе [**Работа с элементами**](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements). 
2. Пример заполнения свойства **Значение** в формате JSON (кавычки нужно заэкранировать: **\\"**):
```
{"collection":{"row":{"field":\[{"name":"FIO","type":"text","value":"Иванов Иван Иванович"},{"name":"from","type":"text","value":"Москва, Улица, Номер дома"},{"name":"to","type":"text","value":"Санкт-Петербург,Улица, Номер дома"},{"name":"dateAndTime","type":"text","value":"23.08.2022 19:04"},{"name":"reestrFullPath","type":"text","value":"\\\of-FS-01\Common\Works\Название отдела\Такси реестр\реестры в оплату\такси\_август.xlsx"},{"name":"row","type":"text","value":"70"}]\}}}
```
3. **Идентификатор**. Пример: `"mykey1"`.
4. **Метаданные**. Пример:
```
{"Tags":"123","KeyField":"FIO","KeyValue":"Иван Иванович Иванов","Attempt":"1","Loaded":"9/20/2022 4:31:12 PM","Completed":"9/20/2022 11:38:06 AM","Worktime":"1","Priority":"0","Prevworktime":"0","Attemptworktime":"1","Finished":"9/20/2022 11:38:06 AM","LastUpdated":"9/20/2022 11:38:06 AM"}
```       
  Если метаданные неизвестны на момент создания элемента, но их нужно добавить позднее, действуйте по алгоритму:
  * добавьте элемент очереди с пустыми метаданными;
  * прочитайте элемент с помощью активности [**Получить из очереди**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/orkestrator/els_queues/readfromqueue) или **Получить по ID/фильтру**;
  * удалите старый элемент либо измените его статус на Success с помощью компонента [**Изменить статус в очереди**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/orkestrator/els_queues/changestatequeue);
  * добавьте новый элемент с помощью активности **Добавить в очередь** и запишите в него нужные метаданные.  
5. **Тэги**. Пример: `List{"tag"}`.
6. **Недоступен до**. Пример: `new DateTime(2022, 9, 19)`.

---

{% tabs %}
{% tab title="C#" %}
```csharp
LTools.Enterprise.OrchestratorApp.WriteQueue(wf, "queue", "data");
```
{% endtab %}

{% tab title="Python" %}
```python
LTools.Enterprise.OrchestratorApp.WriteQueue(wf, "queue", "data")
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
_lib.LTools.Enterprise.OrchestratorApp.WriteQueue(wf, "queue", "data");
```
{% endtab %}
{% endtabs %}
