# Получить из очереди по фильтру

![](<../../../../.gitbook/assets/получить из очереди по фильтру.png>)

Помогает получить нужные элементы из очереди Оркестратора в соответствии с настроенным фильтром. Обязательным для заполнения свойством является только **Очередь** - остальные фильтры настраиваются выборочно. 

Логика фильтрации: 
1. Первичная фильтрация. Осуществляется на стороне Оркестратора - элементы очереди фильтруются по всем указанным свойствам, кроме **Фильтра по значению**.
2. Вторичная - на стороне Робота. Робот фильтрует элементы очереди, полученные от Оркестратора в результате первичной фильтрации, по свойству **Фильтр по значению**.
3. Результат сохраняется в переменную вывода - в свойство **Элемент**. 

> *Описание общих свойств см. в разделе [**Работа с элементами**](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements)*

| Свойство   | Тип    | Описание                            | Пример
| ---------- | ------ | ----------------------------------- | --------- 
| ***Процесс***  |  |      | 
| Очередь\*  | String | Название очереди в Оркестраторе     | "Queque"
| ID         | String | ID элемента очереди Оркестратора, переменная | queue_id.ToString()
| Фильтр     | String | Фильтр по метаданным в виде регулярного выражения для SQL. Обратите внимание, что если Оркестратор установлен с MS SQL SERVER, то необходимо использовать шаблоны с оператором LIKE (но без его указания, только шаблон). Если  Оркестратор установлен с PostgreSQL, то доступны функции Regexp  | "%1330\|15.07.2022%"
| Фильтр по значению | String  | Фильтр по значению в виде регулярного выражения   | "\w+" 
| Тэги       | List\<string> | Фильтр по тегам элемента очереди | new List\<string>( ) { "tag1", "tag2", "tag3" }
| Логика     | -      | Только для тегов. Настраивает логику их поиска. Доступные значения: *Or* или *And*. Если установлено *Or*, то будет учитываться один и более тегов. Если установлено *And*, то у элемента должны быть все перечисленные теги | Or
| Статус     | -      | Фильтр по статусу элемента очереди. Выберите нужный из выпадающего списка  | Error
| Занимать   | Boolean | По умолчанию флаг **НЕАКТИВЕН**. Определяет, нужно ли занимать отфильтрованные записи. Если установлен, то в ответе вернутся только те значения, которые можно занять - т.е. изъять из очереди, чтобы далее с ними работал именно Ваш Робот| 
| Страница   | Int32  | Номер страницы очереди Оркестратора, на которой находится искомый элемент | 5
| Кол-во     | Int32  | Определяет, сколько элементов очереди нужно получить. Если не заполнено, вернется только 1 | 10
| Только свои | Boolean | При установке флага будут прочитаны только те сообщения, которые были добавлены в очередь с идентичной учетной записи (тем же Роботом), с которой в данный момент осуществляется настройка |
| Таймаут   | Int32  | Лимит времени операции (мс). Если по истечении лимита операция не выполнена, Робот закончит работу с ошибкой |
| ***Вывод*** |  |      |  
| Элемент    | List<[LTools.Enterprise.Model.QueueItem](https://github.com/ttalantseva/Docs.Rus/blob/main/g_elements/el_basic/els_orch/els_queues/datatypes.md)> | Список элементов очереди, полученных по фильтру  |
  
  
{% tabs %}
{% tab title="C#" %}
```csharp
object ret = LTools.Enterprise.OrchestratorApp.PeekQueueByFilter(wf, "queue", id, ".name", LTools.Enterprise.Model.QueueItemStates2.Any, false, 10);
```
{% endtab %}

{% tab title="Python" %}
```python
ret = LTools.Enterprise.OrchestratorApp.PeekQueueByFilter(wf, "queue", id, ".name", LTools.Enterprise.Model.QueueItemStates2.Any, false, 10)
```
{% endtab %}

{% tab title="JavaScript" %}
```javascript
var ret = _lib.LTools.Enterprise.OrchestratorApp.PeekQueueByFilter(wf, "queue", id, ".name", _lib.LTools.Enterprise.Model.QueueItemStates2.Any, false, 10);
```
{% endtab %}
{% endtabs %}

