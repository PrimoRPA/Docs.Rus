# Запрос HTTP

![](<../../../.gitbook/assets/Запрос HTTP.png>)

Создает запрос к конечной точке сервера для получения ответа. Поддерживает различные методы аутентификации. Работает только на ОС Windows.

*ВАЖНО!* Элемент требует установки пакета Primo.Networking через:
* [Менеджер зависимостей Студии](https://docs.primo-rpa.ru/primo-rpa/primo-studio/projects/manage-dependencies#menedzher-zavisimostei)
* [NuGet.org](https://www.nuget.org/packages/Primo.Networking)

## Свойства

### OAuth1
| Свойство         | Тип    | Описание |
|------------------|--------|----------|
| Consumer key     | String | Уникальный идентификатор клиента |
| Consumer secret  | String | Секретный ключ для аутентификации |
| OAuth1 token     | String | Токен доступа после аутентификации |
| OAuth1 secret    | String | Секретный ключ токена |

### OAuth2
| Свойство       | Тип    | Описание |
|----------------|--------|----------|
| OAuth2 token   | String | Токен доступа для API |

### Аутентификация сертификата
| Свойство               | Тип          | Описание |
|------------------------|--------------|----------|
| Сертификат клиента     | String       | Путь к файлу (.pfx/.p12) |
| Пароль сертификата     | String       | Пароль к сертификату |
| Зашифрованный пароль   | SecureString | Шифрованная версия пароля |
| Проверка SSL           | Boolean      | Включение проверки SSL |

### Ввод
| Свойство | Тип | Описание |
|----------|-----|----------|
| URL*     | String | Адрес запроса |
| Метод    | Enum | GET/POST/PUT и др. (по умолчанию GET) |
| Формат   | Enum | Формат ответа: ANY/XML/JSON/CUSTOM |

### Вывод
| Свойство | Тип | Описание |
|----------|-----|----------|
| Заголовки | Dictionary<string, string> | Заголовки ответа |
| Контент  | String | Тело ответа |
| Статус   | Int32 | HTTP-статус |

### Параметры запроса
| Свойство | Тип | Описание |
|----------|-----|----------|
| Cookies  | Dictionary<string, string> | Cookies запроса |
| Вложения | Dictionary<string, string> | Файлы для загрузки (POST/PUT) |
| Заголовки | Dictionary<string, string> | Заголовки запроса |
| Параметры | Dictionary<string, string> | Параметры URL |
| Путь к ресурсу | String | Путь сохранения файла-ответа |
| Тело     | String | Тело запроса (кавычки экранировать: \") |
| Формат   | String | Формат тела (по умолчанию XML) |
| Сегменты URL | Dictionary<string, string> | Динамические части URL ({key}) |

### Простая аутентификация
| Свойство | Тип | Описание |
|----------|-----|----------|
| Логин    | String | Логин для Basic Auth |
| Пароль   | String | Пароль |
| Зашифрованный пароль | SecureString | Шифрованная версия пароля |

## Решение проблем
### Решение типовых проблем

1\. *Не соблюдается значение таймаута, установленное в общих свойствах. Например, установлен таймаут `600000` мс (600 секунд), но ошибка таймаута появляется через 21 секунду.*

Таймаут определяет предельное время ожидания ответа от сервера. Классическая ошибка таймаута означает, что ответ от сервера получить не удалось. Такое сообщение будет иметь вид:

![](<../../../.gitbook/assets/timeout-error-http-req.png>)

Однако если в консоли отображается другое сообщение:

![](<../../../.gitbook/assets/system-timeout-error-http-req.png>)

Это означает, что с большой вероятностью существует системное ограничение ОС. В данном случае именно по истечении системного таймаута мы получили ошибку выше - он имеет приоритет перед таймаутом из свойств элемента. Соответственно, чтобы решить проблему, потребуется изменить параметры конфигурации TCP/IP. 

Подробнее о них можно прочитать [здесь](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc739819(v=ws.10)?redirectedfrom=MSDN). Рекомендуем обратить внимание на параметры [**TcpInitialRTT**](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc739819(v=ws.10)?redirectedfrom=MSDN#tcpinitialrtt) и [**TcpMaxConnectRetransmissions**](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc739819(v=ws.10)?redirectedfrom=MSDN#tcpmaxconnectretransmissions). 
