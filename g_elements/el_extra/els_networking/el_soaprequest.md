# Запрос SOAP

![](<../../../.gitbook/assets/SOAPRequest.png>)

***Важно!** Элемент доступен только при установке пакета **Primo.Networking**, который скачивается с помощью [Менеджера зависимостей Студии](https://docs.primo-rpa.ru/primo-rpa/primo-studio/projects/manage-dependencies#menedzher-zavisimostei) либо на сайте [NuGet.org](https://www.nuget.org/packages/Primo.Networking).*

Элемент осуществляет базовые виды запросов к сервисам SOAP. Работает только на ОС Windows.

## Окно мастера (wizard)
На панели элемента отображается кнопка с вызовом окна мастера. Мастер - это простой способ создания запросов SOAP и предварительного просмотра ответов сервера. Все поля, присутствующие в мастере, также доступны на панели **Свойства**. Таким образом, настроить запрос возможно либо в мастере, либо в свойствах элемента. 

Обращаем внимание, что при закрытии окна мастера изменить настройки можно только в свойствах.

![](<../../../.gitbook/assets/soap-master.png>)

Настройки запроса:
* **Описание сервиса** - укажите URL схемы WSDL с описанием сервиса. Или нажмите кнопку `...`, если файл \*.wsdl нужно найти на жестком диске.
* **Получить**  — по нажатию кнопки будет извлечена информация из файла \*.wsdl и отобразятся доступные параметры в таблице.
* **Контракт** - имя контракта, который описывает методы, предоставляемые службой SOAP. Заполняется из файла \*.wsdl.
* **Метод** - список всех поддерживаемых методов. Становится доступным после указания файла \*.wsdl. При изменении метода также изменятся параметры, отображаемые в таблице ниже.
* **Аутентификация** - тип аутентификации сервиса SOAP. Доступные значения: 
  * None - по умолчанию аутентификация не требуется; 
  * Simple - SOAP-сервис требует простой аутентификация по логину и паролю. При выборе этого значения появятся поля **Логин**, **Пароль**; 
  * Windows - Windows-аутентификация; 
  * Client Certificate - аутентификация осуществляется по сертификату клиента. При выборе этого значения появятся поля **Сертификат** (путь до файла сертификата, без кавычек) и **Пароль** (сертификата).

Таблица параметров метода:
* **Наименование** - имена поддерживаемых параметров. Заполняется из файла \*.wsdl.
* **Тип** - тип данных параметра. Поддерживаются только простые типы данных, без классов.
* **Значение** - позволяет добавить значение для каждого параметра, чтобы выполнить нужный запрос. Заполнение доступно по двойному клику строки.
* **Выполнить** (кнопка) - выполняет запрос с указанными параметрами.

После нажатия кнопки **Выполнить** можно просмотреть ответ веб-сервера в соответствующей области.

## Свойства
Все свойства элемента разделены на группы - они выделены в таблице жирным курсивом.\
Символ `*` в названии свойства указывает на обязательность заполнения.

| Свойство           | Тип                                                                                | Описание                      |
| ------------------ | ---------------------------------------------------------------------------------- | --------------------------------------------------------- |
| ***Общие***    |  | *Описание общих свойств см. в разделе [Работа с элементами](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/elements)* |
| ***Аутентификация*** |  |  |
| Аутентификация |  -    | Выберите из раскрывающегося списка тип аутентификации. Доступные значения: 1) None - по умолчанию аутентификация не требуется; 2) Simple - простая аутентификация по логину и паролю; 3) Windows - используются учетные данные Windows; 4) Client Certificate - сертификат клиента |
| ***Simple***   |  | *Параметры для типа аутентификации Simple* | 
| Логин          | String                       | Логин  |
| Пароль         | String                       | Пароль |
| Защищенный пароль | [SecureString](https://learn.microsoft.com/ru-Ru/dotnet/api/system.security.securestring?view=netcore-3.1) |  При использовании зашифрованного пароля укажите его в этом поле в виде переменной SecureString. Такой пароль не хранится в открытом виде в памяти компьютера. Получить его можно, например, из **Диспетчера учетных данных** (Credential Manager)|
| ***Сертификат*** |  | *Параметры для типа аутентификации Client Certificate* |
| Сертификат     | String    | Укажите путь к файлу сертификата либо Subject в хранилище Root |
| Пароль сертификата | String     | Укажите пароль сертификата  |
| Защищенный пароль  | [SecureString](https://learn.microsoft.com/ru-Ru/dotnet/api/system.security.securestring?view=netcore-3.1) | При использовании зашифрованного пароля сертификата укажите его в этом поле в виде переменной SecureString |
| ***SOAP***    |  |  |
| Endpoint\*    | String      | Укажите расположение схемы WSDL. Пример: `"http://www.webservicex.com/globalweather.asmx?wsdl"` |
| Contract\*    | String      | Контракт сервиса |
| Метод\*       | String      | Имя метода       |
| Параметры     | List\<Object\> | Массив параметров метода. **Важно!** В типах данных классы не поддерживаются, только простые типы |
| Тайм-аут:     | Int32       | Тайм-аут запроса в миллисекундах. Укажите максимальное время ожидания ответа от сервера в мс, по истечении которого при отсутствии отклика обращение будет прервано со статусом ошибки. По умолчанию **20000** |
| ***Вывод***   |  |  |
| Заголовки    | [Dictionary](https://learn.microsoft.com/ru-ru/dotnet/api/system.collections.generic.dictionary-2?view=net-5.0)\<string, string\> | Заголовки ответа, полученного на запрос SOAP |
| Ответ         | String      | Ответ сервиса   |



