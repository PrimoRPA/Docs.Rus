# Настройка формул

Формулы используются внутри процессов и внутри индикаторов.

Формулы добавляются в поле **Формула** в диалоге **Настроить блок**. Данное поле может использоваться как калькулятор (для этого введите в поле выражение вида 2+2 - результат вычислений будет показан в поле **Automatic calculation**; допустимые операции - сложение, вычитание, умножение и деление).

Внизу поля Automatic calculation показывается время, затраченное на вычисление каждой из формул, а также общее время. 

Для вычислений также могут использоваться параметры. Список доступных параметров можно получить, нажав на ссылку **Parameters** - список откроется в окне справа. Значения параметров сохраняются ежедневно по расписанию и сохраняются в базе данных с указанием времени. 
Также сохраняются название параметра, формула его вычисления и описание. 
В любой момент времени можно посмотреть, какое значение принимал параметр в прошлом и какая формула использовалась для его вычисления в указанное время.

Для создания нового параметра перейдите на вкладку **Структура/Параметры расчета** и на открывшейся странице со списком параметров нажмите кнопку **Добавить параметр расчета**. 

![](<../.gitbook/assets/IdeaHub_Processes_9_CalcParam.png>)

В открывшейся форме заполните поля:  
**Имя параметра** – название параметра (только заглавные буквы, цифры и символы подчеркивания)  
**Формула** – для ввода формулы могут использоваться числа, существующие параметры, функции (список функций доступен по ссылке *Functions* внизу поля Формула), синтаксис (доступен по ссылке *Syntax* внизу поля Формула)  
**Описание** – описание параметра

Нажмите кнопку **Сохранить** - параметр будет сохранен и добавлен в список.

В списке параметров расчета указываются названия параметров и формулы их расчета. Если в формуле расчета используется другой параметр, его можно найти в списке параметров, выделив его название в формуле и скопировав в поле поиска внизу экрана. 
При этом в списке параметров будут подсвечены все случаи использования. Таким образом возможно изучить все элементы, использующиеся в расчетах параметра.

Поиск параметра в списке по названию:

![](<../.gitbook/assets/IdeaHub_Processes_6_ParameterSearch.png>)

Пример написания формулы, выдающей в качестве результата процессы в разработке, у которых FTE больше 3:
1. В списке параметров найдите параметр, показывающий список процессов, находящихся в разработке – это параметр `LIST_PROCESSES_DEVELOPMENT`.
2. Введите параметр `LIST_PROCESSES_DEVELOPMENT` – в поле Automatic calculation появится список процессов в разработке, а также параметры процессов. Найдите в этом списке параметр, описывающий FTE процесса – это параметр `field_fte`.
3. В списке функций найдите функцию (и ее параметры), производящую фильтрацию данных – `filter()`.
4. Составьте формулу:  
                   	```filter(LIST_PROCESS_DEVELOPMENT, “field_fte > 3”)```

![](<../.gitbook/assets/IdeaHub_Processes_7_Formula1.png>)

При этом в поле Automatic calculation будет показан результат – список процессов, удовлетворяющих заданному условию фильтрации.

Видоизменив формулу путем добавления функции `count()` можно получить в виде результата количество процессов, удовлетворяющих заданному условию фильтрации:  
                            	```count(filter(LIST_PROCESS_DEVELOPMENT, “field_fte > 3”))```

![](<../.gitbook/assets/IdeaHub_Processes_8_Formula2.png>)
