# Доступ к терминам словаря таксономии

Словари таксономии предназначены для классификации содержимого на портале Idea Hub.

Термин — это элемент, который входит в определённый словарь. Каждый словарь группирует термины по логическому признаку.

Например, на странице **Структура > Таксономия** вы можете увидеть словарь **Департаменты/Управления**, в котором каждый термин представляет собой отдельный департамент вашей организации. 

С помощью правил доступа вы можете определить, какие операции будут разрешены пользователю с терминами выбранного словаря. Дополнительно вы можете разграничить доступ по полям термина.

## Возможные операции
* **Создать** — разрешено создавать термин словаря таксономии.
* **Обновить** — разрешено изменять термин словаря таксономии. 
* **Читать** — разрешено просматривать термин словаря таксономии.
* **Удалить** — разрешено удалять термин словаря таксономии.

Создать термин возможно только на странице **Структура > Таксономия** через административное меню.

Такие операции, как обновить, читать, удалить разрешают соответствующие действия с терминами как на странице **Структура > Таксономия**, так и на странице **Департаменты**, которая доступна через пользовательское меню.



## Типы правил
Доступ к терминам словаря зависит от выбранного типа правила:

* **Термин таксономии выбранный для пользователя** — предоставляет доступ к терминам выбранного словаря в соответствии с ролью пользователя и значением в поле учётной записи, которое ссылается на словарь. 
* **Роль** — предоставляет доступ выбранной роли пользователя. Следует учитывать, что в списке ролей есть общие роли из поставки, например **Авторизованный пользователь** — по умолчанию ею обладают все пользователи, авторизованные в системе, поэтому нет необходимости отдельно назначать эту роль пользователю.
* **Пользователь** — предоставляет доступ выбранному пользователю.
* **То же значение** — предоставляет доступ только тем пользователям, у которых значение конкретного поля из учётной записи совпадает со значением выбранного поля у термина словаря. Опционально можно выбрать, должны ли совпадать все выбранные значения в этом поле, или хотя бы одно значение. 


Для каждой операции можно настроить несколько правил доступа — в этом случае доступ будет предоставляться тем пользователям, которые соответствуют хотя бы одному правилу. 

## Настройка доступа к терминам словаря таксономии

1. Войдите в Idea Hub с учётной записью администратора или пользователя, которому разрешено редактировать форму настроек правил доступа. О том, как установить данное разрешение пользователю, см. [здесь](https://github.com/PrimoRPA/Docs.Rus/blob/2208-%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B8%D1%82%D1%8C-%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB-%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0%D0%BC-%D0%B4%D0%BB%D1%8F-%D0%B8%D0%B4%D0%B5%D0%B0-%D1%85%D0%B0%D0%B1%D0%B0/idea-hub/admin/users/access-rights.md#%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D0%BF%D1%80%D0%B0%D0%B2-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0-%D0%BA-%D1%84%D0%BE%D1%80%D0%BC%D0%B5-%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB-primo).
1. Перейдите в раздел административного **Структура > Таксономия**.
1. В строке нужного словаря выберите действие **Изменить словарь**. Откроется вкладка **Изменить** в форме редактирования словаря.

   ![](<../../../idea-hub/resources/admin/users/taxonomy-edit.png>)

1. Внизу страницы, в блоке **Контроль доступа** отобразится предварительная информация о существующих настройках. Нажмите **Редактировать правила**, чтобы изменить их.

   ![](<../../../idea-hub/resources/admin/users/taxonomy-accesscontrol.png>)

1. Откроется форма редактирования правил. Для каждой операции требуется отдельно установить правила доступа.

    ![](<../../../idea-hub/resources/admin/users/access-rules-read.png>)
   
   В блоке с нужной операцией (например, **Читать**) выберите значение для параметра **Тип правила**. От выбранного значения зависят дальнейшие настройки.

   | Тип правила                                   | Зависимые параметры                                                                                                                              |
   | --------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ |
   | Роль                                          | **Роль с доступом** — выберите роль пользователя, которому хотите разрешить доступ на просмотр всех терминов выбранного словаря. Допускается множественное значение |
   | Пользователь                                  | **Пользователи** — выберите того пользователя, которому хотите разрешить доступ на просмотр всех терминов выбранного словаря. Допускается множественное значение |
   | То же значение                                | **Роли с доступом** — выберите роль пользователя, которому хотите разрешить доступ на просмотр терминов словаря. Допускается множественное значение  <p> **Поле пользователя** — выберите поле пользователя, которое будете сравнивать со значением целевого поля </p>  <p> **Целевое поле** — выберите поле, чтобы сравнить с полем пользователя </p> <p> **Соответствие значений** — возможные состояния параметра:</p> <p>* `По крайней мере одно значение должно соответствовать`; </p> <p> * `Все значения должны соответствовать` </p>  |
   | Термин таксономии выбранный для пользователя  | **Роли с доступом** — выберите роль пользователя, которому хотите разрешить доступ на просмотр терминов словаря. Допускается множественное значение  <p> **Поле пользователя** — выберите поле пользователя, которое ссылается на термин таксономии. </p>  <p> **Включить термины** — выберите, какие термины вы хотите учитывать </p> |

1. При необходимости вы можете добавить дополнительное правило доступа к выбранной операции по кноке **Добавить правило**. В этом случае доступ будет предоставляться тем пользователям, кто соответствует хотя бы одному правилу. 
1. Нажмите **Сохранить правила** внизу страницы.


### Действия после сохранения изменений
Поскольку перестроение правил доступа занимает значительное время, то после сохранения появится кнопка **Перестроить права доступа**. При её нажатии запустится процедура, которая обновит все доступы согласно изменениям в правилах. Данную кнопку можно не нажимать — тогда обновление правил доступа произойдёт при следующем запуске cron, а кнопка после этого исчезнет.

![](<../../../idea-hub/resources/admin/users/rebuild-rules-button.png>)
