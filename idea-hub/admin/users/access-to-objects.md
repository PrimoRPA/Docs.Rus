# Доступ к объектам и полям

Под объектами в Idea Hub понимаются такие сущности, как процесс, проект, очередь, робот, машина, лицензия, дашборд.

Вы можете настроить правила доступа к выбранному объекту, чтобы определить, какие операции будут разрешены пользователю: чтение, создание, изменение, удаление объекта.

Управление доступом к перечисленным объектам выполняется в разделе административного меню **Структура > Типы материалов**.

## Типы правил
Доступ к объекту зависит от типа выбранного правила:
* **Пользователь** — доступ предоставляется выбранному пользователю.
* **Роль** — доступ предоставляется выбранной роли пользователя. Следует учитывать, что в списке ролей есть общие роли из поставки, например **Авторизованный пользователь** — по умолчанию ею обладают все пользователи, авторизованные в системе, поэтому нет необходимости отдельно назначать такую роль пользователю.
* **То же значение** — доступ предоставляется только тем пользователям, у которых значение конкретного поля из учётной записи совпадает со значением конкретного поля у объекта. Опционально можно выбрать, должны ли совпадать все выбранные значения в этом поле, или хотя бы одно значение. 
* **Термин таксономии выбранный для пользователя** — не используется для объектов.

Для каждой операции можно настроить несколько правил доступа — в этом случае доступ будет предоставляться тем пользователям, кто соответствует хотя бы одному правилу. 


## Настройка правил доступа

1. Войдите в Idea Hub с учётной записью администратора или пользователя, которому разрешено редактировать форму настроек правил доступа. О том, как установить пользователю данное разрешение, см. [здесь](https://github.com/PrimoRPA/Docs.Rus/blob/2208-%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B8%D1%82%D1%8C-%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB-%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0%D0%BC-%D0%B4%D0%BB%D1%8F-%D0%B8%D0%B4%D0%B5%D0%B0-%D1%85%D0%B0%D0%B1%D0%B0/idea-hub/admin/users/access-rights.md#%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D0%BF%D1%80%D0%B0%D0%B2-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0-%D0%BA-%D1%84%D0%BE%D1%80%D0%BC%D0%B5-%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB-primo).
1. В административном меню выберем раздел **Структура > Типы материалов**.
1. В строке выбранного объекта выберите действие **Изменить**.

   ![](<../../../idea-hub/resources/admin/users/change-object-for-rules.png>)
   
1. В открывшейся форме редактирования объекта перейдите на вкладку **Контроль доступа**, которая располагается внизу страницы. На вкладке отобразится предварительная информация о существующих настройках.

   ![](<../../../idea-hub/resources/admin/users/access-rules-preview.png>)
   
1. Нажмите **Редактировать правила**. Откроется форма редактирования, в которой для каждой операции с объектом требуется отдельно устанавливать правила доступа.

    ![](<../../../idea-hub/resources/admin/users/access-rules-read.png>)
   
1. В блоке с нужной операцией (например, **Читать**) выберите значение для параметра **Тип правила**. От выбранного значения зависят дальнейшие параметры настройки:
   * Если вы выбрали тип правила **Роль**, то в параметре **Роль с доступом** выберите роль пользователя, которому хотите разрешить доступ на просмотр объекта. Допускается множественное значение.
   * Если вы выбрали тип правила **Пользователь**, то в параметре **Пользователи** выберите того пользователя, которому хотите разрешить доступ на просмотр объекта. Допускается множественное значение.
   * Если вы выбрали тип правила **То же значение**, то вам потребуется заполнить такие параметры, как **Роли с доступом**, **Поле пользователя** и **Целевое поле** — подробнее они рассмотрены в примере ниже.
1. При необходимости вы можете добавить дополнительное правило доступа к выбранной операции по кноке **Добавить правило**. В этом случае доступ будет предоставляться тем пользователям, кто соответствует хотя бы одному правилу. 
1. Нажмите **Сохранить правила** внизу страницы.

### Действия после сохранения изменений
Поскольку перестроение правил доступа занимает значительное время, то после сохранения появится кнопка **Перестроить права доступа**. При её нажатии запустится процедура, которая обновит все доступы согласно изменениям в правилах. Данную кнопку можно не нажимать — тогда обновление правил доступа произойдёт при следующем запуске cron, а кнопка после этого исчезнет.

![](<../../../idea-hub/resources/admin/users/rebuild-rules-button.png>)

### Пример 

Рассмотрим, как установить правило доступа к такому объекту, как процесс. В данном примере мы хотим, чтобы просматривать процесс могли все бизнес-аналитики, связанные с этим процессом. 

Для этого:
1. Войдем в Idea Hub с учётной записью администратора.
1. В административном меню выберем раздел **Структура > Типы материалов**.
1. В строке **Процесс** выберем действие **Изменить**.
1. В открывшейся форме редактирования процесса перейдем на вкладку **Контроль доступа**, которая располагается внизу страницы.   
1. Нажмём **Редактировать правила**. 
1. В блоке с операцей **Читать** настроим параметры:
   * **Тип правила** — выбираем правило `То же значение`.
   * **Роли с доступом\*** — оставляем значение `Authenticated user`.
   * **Поле пользователя** — выбираем значение `ID пользователя` (машинное имя: uid).
   * **Целевое поле** — выбираем значение `Аналитик` (машинное имя: field_ba).
   * **Соответствие значений** — выбираем значение `По крайней мере одно значение должно соответствовать`. 
1. Внизу страницы нажимаем **Сохранить правила**.


В результате все авторизованные пользователи, которые являются аналитиками определенных процессов, будут иметь право на просмотр этих процессов в Idea Hub.
     


