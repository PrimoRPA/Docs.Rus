# Импорт данных

‼️ДОБАВИТЬ ИЛЛЮСТРАЦИИ - КАКИЕ ИМЕННО. МОЖНО ПОСМОТРЕТЬ В ФАЙЛЕ https://docs.google.com/document/d/1A5Zb41Gba4FaAJr44YeFKS9StfGw2ibmmWdCv0Eb1EY/edit?pli=1


## Импорт данных о процессах, департаментах и пользователях

Импорт данных из файлов Excel (.xlsx), наряду с использованием возможностей интерфейса продукта - один из способов внесения данных в Idea Hub. В процессе импорта данные читаются из файлов и вносятся в базу данных Idea Hub. 

Использование импорта полезно, если у организации уже есть определенное количество автоматизированных процессов, и ввод данных по ним вручную через интерфейс Idea Hub может потребовать значительного времени и усилий.
Импортирование файлов с заполненными таблицами позволяет ускорить этот процесс.

Для корректного импорта данных в Idea Hub необходимы 3 заполненных файла:
process.xlsx (файл с данными процессов)
areas.xlsx (файл с данными управлений и департаментов)
users.xlsx (файл с данными пользователей)

Шаблоны файлов для заполнения можно скачать на страницах описаний файлов, приведенных выше. 

!!Шаблон файла process.xlsx после скачивания может быть переименован в соответствии со стандартами, принятыми в организации.

Шаблон файла process.xlsx можно также загрузить на странице “Импорт данных”, нажав на ссылку “Получить образец файла”. Данный шаблон содержит в себе краткие описания полей и инструкции по их заполнению - чтобы их увидеть, подведите курсор мыши к ячейке с названием поля.

Кроме того, на странице “Импорт данных” можно получить уже загруженные файлы, содержащие информацию о процессах/пользователях/департаментах, имеющихся в Idea Hub.  Для этого нажмите на ссылке “Получить загруженный файл”. 

ILLUSTRATION

Файл process.xlsx содержит ссылки на департаменты в колонке “dep” (в виде кодов, которые также содержатся в колонке “code” файла areas.xlsx) . Они необходимы для того, чтобы в процессе импорта связать процессы с соответствующими им департаментами. При этом для установления этой связи нужно, чтобы департаменты существовали в базе данных Idea Hub до того, как в продукт будут импортированы процессы. Для этого перед импортом файла process.xlsx:
загрузите файл areas.xlsx, либо
внесите информацию о департаментах вручную через интерфейс.

Также в файле process.xlsx есть ссылки на пользователей, связанных с указанными в файле процессами. Ссылками являются адреса электронной почты пользователей в полях owner, contacts, robot_user, responsible_analyst, responsible_developer. Для связывания процессов с соответствующими пользователями в Idea Hub необходимо произвести действия, аналогичные описанным выше для департаментов:
загрузить файл users.xlsx, либо
внести информацию о пользователях вручную через интерфейс.

Внимание: загрузка файла на сервер и его импорт в Idea Hub - это два отдельных процесса. Этап загрузки предваряет этап импорта. Только в процессе импорта данные фактически вносятся в базу данных Idea Hub. 

Для загрузки файлов areas.xlsx, users.xlsx, process.xlsx зайдите на страницу “Импорт данных”:

ILLUSTRATION

Далее кликните на стрелке, расположенной на кнопке “Импортировать” и выберите “Загрузить файл” для соответствующей миграции:

ILLUSTRATION

Таблица на странице “Импорт данных” показывает информацию о файлах  - например, готовность к импорту, количество обработанных элементов в файлах и т.д. (за исключением миграции “Данные из Оркестратора”, о которой будет сказано ниже).

После загрузки всех трех файлов для первичной комплектации базы данных достаточно импортировать файл process.xlsx - при этом импорт загруженных файлов areas.xlsx и users.xlsx будет осуществлен автоматически.

Чтобы перейти к выбору установок для импорта, нажмите кнопку “Импортировать”.

Откроется страница “Выполнить” для выбора деталей операции импорта:

ILLUSTRATION

На этой странице можно выбрать тип операции для выполнения, а также дополнительные настройки того, каким образом содержимое файла будет импортироваться.

Операции:

Импортировать - выбрана по умолчанию. Данная операция импортирует все ранее необработанные записи из файла-источника, а также все записи, помеченные для обновления, в целевые объекты. Например, для импорта файла process.xlsx целевыми объектами являются процессы.
Откатить - при выборе этой операции из базы данных будут удалены все объекты, созданные ранее в ходе предыдущих операций импорта. При этом объекты, созданные вручную в Idea Hub, удалены не будут.
Остановить - прерывает все текущие операции импорта и отката. Данную операцию необходимо выполнять перед тем, как использовать операцию Сбросить.
Сбросить - данная операция используется, если при импорте или откате произошел сбой или ошибка, и операция перестала выполняться, не освободив при этом систему. Тогда, прежде чем начать новую операцию, необходимо сначала остановить и сбросить текущую (неуспешную).
 
Дополнительные варианты выполнения операции:

Обновить - выбрано по умолчанию. 
Если данный флажок включен, то при импорте будет обновлен весь ранее сформированный с помощью импорта контент в дополнение к импорту нового контента. То есть, содержимое импортируемого файла в этом случае будет иметь приоритет над теми данными, которые уже могут содержаться в Idea Hub (для процессов, которые были импортированы ранее). Если данные в файле и базе данных отличаются, то будут импортированы и перезаписаны данные из файла.
Если флажок снят, будет импортирован только новый контент. Данные, уже имеющиеся в Idea Hub, останутся неизмененными.

Игнорировать зависимости - в данном случае, зависимости - это взаимосвязи между файлом процессов (process.xlsx) и данными о департаментах и пользователях, содержащимися в файлах areas.xlsx и users.xlsx. 
Если этот флажок снят (как это сделано по умолчанию), при импорте файла процессов также будут автоматически импортироваться файлы, содержащие данные о пользователях и департаментах.
Если флажок установлен, будут импортированы только процессы. Такой вариант выполнения операции может быть выбран, если все данные о необходимых для процессов пользователях и департаментах были импортированы ранее.

Ограничено до - в данный момент это поле не используется.

Список идентификаторов - в данном поле можно указать через запятую список идентификаторов конкретных процессов для обновления (идентификаторы содержатся в поле “id” файла process.xlsx). В этом случае в ходе импорта будут импортированы данные только для перечисленных процессов. Это поле может быть использовано, например, для ускорения процесса обработки, если требуется импортировать только определенные процессы из большого по объему файла process.xlsx. Эта опция не работает для импорта из Оркестратора, так как список идентификаторов в этом случае недоступен.

Для старта процесса импорта нажмите кнопку “Импортировать” - процесс будет запущен. Индикатор прогресса на открывшейся странице “Импорт” покажет, на каком этапе находится процесс импорта в каждый момент времени.

Когда процесс импорта будет завершен, откроется страница “Импорт данных” со списком сообщений о статусе импорта различных элементов.

ILLUSTRATION

## Импорт из Оркестратора

Импорт данных из Оркестратора производится автоматически раз в сутки, если настроен [cron](https://docs.primo-rpa.ru/primo-rpa/primo-idea-hub/cron). Также данные можно импортировать вручную с помощью кнопки Импортировать в миграции “Данные из Оркестратора” на странице Импорт данных. 

!!ВНИМАНИЕ: Информация в колонках таблицы, относящаяся к миграции “Данные из Оркестратора”, в данный момент предназначена для использования техническими специалистами и не отражает напрямую состояние данных, поэтому просто игнорируйте ее.

При нажатии на названии миграции “Данные из Оркестратора” открывается страница “Обзор импорта/Просмотр”. На вкладке “Журналы синхронизации Оркестратора” на данной странице можно увидеть информацию о том, когда в последний раз импортировались данные из Оркестратора, а также подробную статистику импорта (к каким базам данных происходило подключение, какие запросы выполнялись, длительность операции и т.д.). 

ILLUSTRATION

Для ручного импорта из Оркестратора доступна страница “Выполнить”, аналогичная подобным страницам для импорта процессов, пользователей и департаментов. На этой странице указываются детали предполагаемой операции. Для того, чтобы открыть страницу, кликните на кнопке “Импортировать”.

!!ВНИМАНИЕ: Для импорта из Оркестратора не рекомендуется использовать операцию “Откатить”, так как это приведет к потере исторических данных без возможности их восстановления. Также не рекомендуется менять установки по умолчанию в разделе “Дополнительные варианты выполнения операции”.  

После нажатия на странице “Выполнить” кнопки “Импортировать” будет начата операция импорта. 

Данная операция может занять некоторое время; индикатор прогресса на странице при этом будет показывать, на каком этапе находится процесс.

ILLUSTRATION

Когда операция импорта будет закончена, на открывшейся странице “Импорт данных” появится сообщение о статусе импорта.
