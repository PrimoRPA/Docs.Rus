# Создание элемента для Studio (Linux)

В этом разделе вы узнаете, как разработать элемент для Primo RPA Studio на Linux. Готовый элемент необходимо будет упаковать в dll-библиотеку и затем установить в вашу Primo RPA Studio. 

Чтобы создать элемент, вам понадобится среда разработки Visual Studio (IDE). Установите ее на компьютер.


## Начало работы

> В нашем примере мы использовали Visual Studio Community 2022.

Создайте проект в Visual Studio:

1. Запустите Visual Studio.
2. Выберите **Create a new project** (Создание проекта) с шаблоном проекта **Class Library (.NET Framework)** - \\\\для линукса нужен такой же шаблон?
3. Укажите имя проекта. Оно должно начинаться с префикса **Primo.** Например: `Primo.My.Activity`. - \\\\нужна ли галка "Поместить проект и решение в одном каталоге" при создании проекта? 
4. Выберите фреймворк **.NET Framework 4.6.1**. - /// актуально для линукс?
5. Откройте окно инструментов **Solution Explorer** (Обозреватель решений). Добавьте в **References** (Ссылки) вашего проекта следующие файлы из каталога установки Primo RPA Studio (Linux):
   * LTools.Common.dll
   * LTools.Dto.dll - нужно или нет для линукс?
   * LTools.Enums.dll
   * LTools.Scripting.dll
   * LTools.SDK.dll
6. Также добавьте в ваш проект стандартные сборки: ////- их откуда брать? нужны ли они для Линукса? У Алексея в инструкции они не указаны.
   * PresentationCore
   * PresentationFramework
   * System.Xaml
   * WindowsBase


:small_blue_diamond: **Вопрос**: у Алексея в инструкции написано: "File Class1.cs needs to be deleted!".  Что это за файл, откуда берется и зачем удалять.


## Установка расширений 

1. Выбираем пункт меню Extentions > Manage Extentions (Расширения > Управление расширениями).
3. Введите в поисковой строке Avalonia, чтобы найти расширения, которые понадобятся для проекта.
4. Устанавите следующие расширения:
   * Avalonia for Visual Studio 2022;
   * Avalonia Toolkit;
   * Avalonia Templates Studio.
5. В окне инструментов Solution Explorer выбираем Manage Nuget Package.... короче там в Dependencies нужно установить библиотеки:
   * Avalonia by Avalonia
   * Avalonia Desktop
   * Avalonia Diagnostics
   * Avalonia ReactiveUI
   * XamlNameReferenceGenerator

Они понадобятся для написания кода.

## Структура проекта 

Проект библиотеки (или каждого "элемента" в библиотеке?) в Visual Studio состоит из папок. Для примера создадим в проекте следующие папки:
1. Classes - классы, которые будут использоваться в элементах в рамках этой библиотеки.
2. Elements - элементы, которые войдут в вашу библиотеку.
3. Images - тут иконка элемента хранится? или еще что-то? Какие форматы изображений разрешены (только png или еще что-то)? Есть ли рекомендуемые размеры и ограничения?
4. Localization - локализация.
5. Views - визуальные формы, на которые мы смотрим.

![](.gitbook/assets1/)


Вопрос: это более-менее общая структура для всех библиотек? что из этих папок обязательно, а что опционально? Что еще может быть в проекте?


Название (Primo.Somethig.Linux) - проекта в студии у лехи

## Как что-то создать

**Как добавить в проект визуальную составляющую элемента:**

Добавьте в проект компонент типа **User Control (WPF)** (Add ➝ New Item…). Данный элемент будет являться визуальной составляющей нашего элемента Primo. Данные будущего элемента автоматически будут смаплены на DataContext данного контролла (пример будет приведен далее).

(сама форма не отображается в вижуал студио -> по-моему, намеренно, поискать в чатах "защита от воровства")

Леха просто скопировал вьюшку из виндового проекта. 

Написать, что форма визуально не отрисовывается в вижуал студии и ошибка No Executable - это нормально. Уточнить у Адреянова, мож, как-то можно настроить.


**Как создать класс элемента:**

Создайте класс (Add ➝ Class…). Данный класс будет являться code-behind нашего элемента.

Для создания элемента:
* с синхронным поведением необходимо унаследовать класс LTools.SDK.PrimoComponentSimple<UI>.
* с тайм-аутом необходим класс LTools.SDK.PrimoComponentTO<UI>.

Где UI – это имя вашего визуального компонента из шага 5.


(написать определения, что такое синхронный элемент, а что такое элемент с таймаутом)



**Как загрузить в проект изображения:**

Правой кнопкой мыши кликните по папке Images, выберите Add > Existing Item... и загрузите нужные изображения. 

Затем кликните правой кнопкой мыши каждое изображение и откройте Properties. В группе свойств Advanced выберите для Buld Action значение Resource. (зачем это делать? это всегда и для всех картинок нужно делать? или только для иконок элемента?)


**Как настроить название проекта (или правильнее - пакета?)**   ///и зачем это делать

В окне Solution Explorer разверните Properties проекта и дважды щелкните файл `AssemblyInfo.cs`. Затем заполните поля, как на рисунке ниже:

(Рисунок Алексея)


## Создание элемента

Правой кнопкой мыши кликните по папке Elements и выберите Add -> New Item... -> Choose C# Class. Укажите имя элемента, например, `MyFirstActivity.cs` и нажмите Add.


### Визуальный облик элемента

(фактически то же самое, что и в винде. Леша копипастил)

Далее правой кнопкой мыши кликните по папке Views и выберите Add -> New Item... -> выберите User Control (WPF) -> Name: MyFirstActivity_Form.xaml -> Add.

<здесь у Алексея рисунки от руки с дизайном элемента>

Дважды кликните по файлу `MyFirstActivity_Form.xaml` и создайте колонки и строки (для чего?). В нашем примере мы создадим 2 колонки и 2 строки (но может быть и больше?). После чего отобразите получившуюся (сетку) - откройте Grid property -> ShowGridLines="True"

Просто замените новый Grid на этот код:

```
  <Grid x:Name="MyFirstActivity_Form_grd" 
            VerticalAlignment="Center" 
            HorizontalAlignment="Center" 
            ShowGridLines="True"
            Background="White"
            
  >
    <Grid.ColumnDefinitions>
        <ColumnDefinition></ColumnDefinition>
        <ColumnDefinition></ColumnDefinition>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition></RowDefinition>
        <RowDefinition></RowDefinition>
    </Grid.RowDefinitions>
  </Grid>
```

Итак, у нас определены столбцы и строки. Затем под строкой `</Grid.RowDefinitions>` добавьте изображение: 

```
<Grid Grid.Row="0" Grid.Column="0">
  <Image HorizontalAlignment="Left" 
         Source="pack://application:,,/User.My.Activity;component/Images/eye_logo.png"
         Height="40"
         Width="40"
         Margin="5,5,5,5"
  />
</Grid>
```



## 






##










##



##
