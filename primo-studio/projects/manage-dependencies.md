# Управление зависимостями

Роботы Primo могут использовать сторонние библиотеки в своих проектах. После подключения библиотек их можно использовать в кодовых вставках. Этим же путем можно добавлять в проекты дополнительные элементы. Имеются следующие способы импорта зависимостей:

1. Копирование всех необходимых файлов \*.dll в папку `Referenced` Студии и робота (для обычных библиотек).
2. Копирование всех необходимых файлов \*.dll в корневую папку робота и Студии (для элементов).
3. Ручное добавление зависимостей.
4. Использование менеджера зависимостей.

Загрузка зависимостей в проект занимает некоторое время. Таким образом, подключенные библиотеки появятся в редакторе скриптов только после того, как в панели состояния Студии погаснет транспарант «Загружаю зависимости....».

![](<../../.gitbook/assets/image (372).png>)

### Менеджер зависимостей

Зависимости для проектов Primo могут распространяться в виде пакетов NuGet (\*.nupkg) как прямым копированием, так и посредством портала [nuget.org](https://www.nuget.org/). 

Для запуска Менеджера зависимостей используйте кнопку **Управление зависимостями** главного меню <img src="../../.gitbook/assets/managePackages32.png" alt="" data-size="line">, либо щелкните правой кнопкой по пункту «.Зависимости» на панели проекта. Откроется окно вида:

![](<../../.gitbook/assets/image (323).png>)

Зависимости разбиты на четыре основные группы:

* **Проект** (Project) - в этой группе находятся зависимости, прикрепленные к самому проекту. Физически они располагаются в папке `.Dependencies` проекта. Зависимости могут быть установлены как из локального репозитория Студии, так и с портала nuget.org.
* **Студия** (Studio) - в группе находятся зависимости, содержащиеся в локальном репозитории Студии. Добавить новые зависимости можно, либо перейдя в группу Nuget.org, либо вручную - путем копирования в папку `.Dependencies` корневого каталога Студии. При ручном добавлении, в папке `.Dependencies` нужно создать подпапку с именем вашего пакета nuget (без расширения), после чего скопировать в нее файл пакета nuget (\*.nupkg). Например, для пакета `Antlr.3.5.0.2.nupkg` нужно создать папку `Antlr.3.5.0.2`. В случае установки с портала nuget.org зависимость будет автоматически импортирована в текущий проект. Для импорта только в Студию необходимо предварительно закрыть текущий проект.
* **Nuget.org** - в группе содержатся пакеты с портала nuget.org. Для работы с ними необходимо подключение к Интернету.\
  :small_blue_diamond: ***Примечание***. *Официальные элементы можно искать по ключевому слову **Primo** или **Rondem***.
* Сторонние источники - о том, как добавить дополнительные источники, см. в [разделе Nuget](https://docs.primo-rpa.ru/primo-rpa/primo-studio/settings/nuget).

### Импорт зависимостей 
Зависимости импортируются по следующему алгоритму:
1. Осуществляется поиск в репозитории Студии.
2. Если зависимость найдена, то она будет установлена из репозитория Студии.
3. Если не найдена, то будет произведена установка из nuget.org с последующим копированием в локальный репозиторий Студии.

Импорт/удаление/обновление зависимостей осуществляется пакетно, т.е. в момент нажатия управляющих кнопок (Добавить/Удалить/Обновить) устанавливаются метки (обозначены пиктограммами <img src="../../.gitbook/assets/stateToInstall.png" alt="" data-size="line"> <img src="../../.gitbook/assets/4 (1) (1) (2) (1) (1) (1) (2) (3).png" alt="" data-size="line"> <img src="../../.gitbook/assets/10 (2) (1) (2) (1) (1) (1) (2) (2).png" alt="" data-size="line"> ), установка производится после нажатия кнопки **Сохранить**.

По нажатию кнопки **Сохранить** выводится окно со списком предполагаемых изменений:

![](<../../.gitbook/assets/image (358).png>)

После нажатия кнопки **Установить** (Install) будут произведены все описанные изменения, а в нижней части окна отобразится журнал работы установщика зависимостей.

После завершения изменений проект будет перезагружен. 

:bangbang: ***Сохраните все изменения в алгоритмах перед началом работы с зависимостями.***

### Восстановление зависимостей

В случае, если в папке `.Dependencies` проекта отсутствуют необходимые зависимости, в палитре Проект будут отображаться ошибки (`htmlagilitypack` в данном примере).

![](<../../.gitbook/assets/image (441).png>)

Восстановить зависимости можно как вручую путем копирования, так и автоматически: для этого нужно нажать на любую зависимость правой кнопкой и выбрать пункт меню **Восстановить зависимости**.

***
