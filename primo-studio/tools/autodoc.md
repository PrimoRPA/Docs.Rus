# Автодок (AutoDoc)

*AutoDoc* — это утилита командной строки, разработанная для автоматического формирования документации по проектам Primo, так называемый паспорт Робота. 
С её помощью можно сгенерировать подробные отчёты по переменным, аргументам, структуре процессов и диаграммам, которые помогут в анализе и сопровождении проектов.
По умолчанию *AutoDoc* устанавливается в директорию *Plugins\AutoDoc* в папке установки **Primo RPA Studio**. 
Конкретный путь может отличаться в зависимости от операционной системы и разрядности, например:

- *Windows* (x64): C:\Program Files\Primo\Primo Studio x64\Plugins\AutoDoc
- *Windows* (x86): C:\Program Files (x86)\Primo\Primo Studio\Plugins\AutoDoc

## Системные требования AutoDoc 
AutoDoc требует установленной платформы *.NET 6.0*
 Минимальные требования:
- *Microsoft .NET 6.0 LTS*
- *Операционные системы*:
  - Windows 11, Windows 10 (версия 1607+), Windows Server 2019, Windows 8.1
- *Процессор*: x64, Arm64 или Arm32
- *Память*: Минимум 1 ГБ ОЗУ
- *Java Development Kit (JDK)* (необходим для использования локального рендерера)


## Основные параметры запуска

AutoDoc запускается через командную строку с использованием следующих параметров:
```
PrimoAutodoc.exe -i/-input "папка с Primo-проектом" -o/-output "папка сформированной документации" [-t/templates "папка пользовательских шаблонов"] [-word] [-local] [-oe]
```
В квадратных скобках указываются необязательные параметры командной строки.

Описание параметров:
- *-i / -input*: Путь к процессу или к папке с проектом Primo (обязательный).
- *-o / -output*: Путь к выходной папке, в которую будет сгенерирована документация. (обязательный)
- *-t / -templates*: Путь к папке с пользовательскими шаблонами.
- *-word*: Формирование документации в формате Word. По умолчанию используется HTML.
- *-local*: Использование локального рендерера схем процессов Primo RPA.
- *-oe*: Кодировка вывода консоли. Пример: -oe 65001|| -oe utf-8. Примечание: Значением может быть идентификатор кодовой страницы или имя текущей кодировки.
- *-?(-help): Отобразить справку.


## Описание файлов и шаблонов
В папке Resources содержатся настроечные файлы и шаблоны, используемые для генерации документации.

- *AppsAndSites.txt* — описания для приложений и сайтов.
- *DocsRegexp.txt* — регулярные выражения для файлов-документов.
- *elements.csv* — описания активностей проекта: группа — описание — название класса
- *PropertiesDict.csv* — описания свойств активностей.
- *tags.csv* — соответствие тегов и групп активностей.
- *Template.uml* — шаблон для UML диаграмм.

### Razor-шаблоны для HTML-документации:
- *project.cshtml* — шаблон для описания проекта.
- *process.cshtml* — шаблон для описания процесса, где строка {Activities} заменяется списком активностей.
- *ActivityInfo.cshtml* — шаблон для активностей проекта.

## Конфигурация

Конфигурационный файл *appsettings.json* используется для настройки программы, что характерно для приложений, разработанных на *.NET Core**
В нем можно указать путь к внешним программам для автоматической обработки тегов. Несколько программ могут быть указаны одновременно, разделяясь вертикальной чертой (|).

Пример содержимого файла *appsettings.json*:

```
{
  "UseCustomTagger": "False",
  "Tagger": ["D:\\DEV\\TaggerStub.exe | D:\\DEV\\Tagger_01.exe"]
  "OutputEncodingName":"utf-8",
  "Language":"ru-Ru"
}
```

- *UseCustomTagger* — включает использование внешних программ для обработки тегов. Если значение установлено в True, система будет использовать внешние программы, указанные в поле *Tagger*.
- *Tagger* — путь к программам, которые проставляют теги.
- *OutputEncodingName* - определяет кодировку сообщений в консоли.
- *Language* - определяет язык сообщений консоли по умолчанию.

## Локальный рендеринг изображений

Для генерации диаграмм с использованием локального рендерера необходимо:
1. Установить *Java Development Kit (JDK)*.
2. Прописать переменную среды *JAVA_HOME* (желательно без пробелов в пути).
3. Убедиться, что в папке с программой есть файл *plantuml.jar*.

## Примечание

AutoDoc не имеет графического интерфейса, но можно создать *.bat* файл для удобного запуска с нужными параметрами.

AutoDoc автоматически присваивает имя итоговому файлу на основе названия проекта. 
Чтобы увидеть результат, перейдите в папку, указанную в параметре *-o, и откройте сгенерированный *.docx** (если использовался -word) или *.html* файл в соответствующей программе.


### Примеры команд:

**1. Собрать паспорт робота по умолчанию**
``` 
PrimoAutodoc.exe -i "D:\Primo\PrimoProjects\HR001_Small" -o "D:\Primo\Docum"
``` 
"D:\Primo\PrimoProjects\HR001_Small" — папка с проектом. Внутри нее находится файл project.ltp, файлы ltw и подпапки
"D:\Primo\Docum" — выходная папка, в ней будет создан файл Proj_HR001_Small.html и папка HR001_Small с html-документацией внутри

**2. Собрать паспорт робота с использованием пользовательского шаблона**
``` 
PrimoAutodoc.exe -i "D:\Primo\PrimoProjects\HR001_Small" -o "D:\Primo\Docum" -t "D:\Primo\Templates"
``` 
"D:\Primo\Templates"— папка пользовательских шаблонов

**3. Собрать паспорт робота в формате MS Word.**
``` 
PrimoAutodoc.exe -i "D:\Primo\PrimoProjects\HR001_Small" -o "D:\Primo\Docum" –word
``` 
-word — с этим параметром создается документация в формате MS Word. Без этого параметра, документация создается по умолчанию, в формате HTML.

**4. Принудительное включение локального рендера схем процессов Primo RPA.**
``` 
PrimoAutodoc.exe -i "D:\Primo\PrimoProjects\HR001_Small" -o "D:\Primo\Docum" –local
``` 
-local — использовать локальный рендер схем процессов Primo RPA. Для этого нужно: 
	- установить Java Development Kit;
	 - установить переменную среды JAVA_HOME (желательно чтобы путь был без пробелов); 
	- убедиться, что в папке с программой есть файл "plantuml.jar" (11Mb)
По умолчанию, используется удаленный рендер схем, который требует наличия доступа в интернет.

**5. Изменение текстовой кодировки вывода консоли.** 
``` 
PrimoAutodoc.exe -i "D:\Primo\PrimoProjects\HR001_Small" -o "D:\Primo\Docum" -oe "utf-8" 
```
"utf-8" — значение устанавливаемой кодировки. В качестве значения может быть строка с именем кодировки или числовой идентификатор кодовой страницы, например, 65001. Кодировку по умолчанию можно так же задать в настройках приложения. 

**6. Получить справку.** 
``` 
PrimoAutodoc.exe -? 
``` 

- *HR001_Small* — папка с проектом. Внутри неё находятся файлы проекта (.ltp, .ltw и др.).
- *Docum* — выходная папка, в которой будет создан файл Proj_HR001_Small.html с документацией.
- *Templates* — папка с шаблонами для документации (необязательно).

   ![](../../.gitbook/assets1/autodoc2.png) 

   ![](../../.gitbook/assets1/autodoc1.png) 

