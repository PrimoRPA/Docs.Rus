# Шаблоны AutoDoc

При генерации документации Робота (паспорт робота) в *AutoDoc* применяются несколько шаблонов для описания проектов и их структуры:

- **Project.cshtml** — Шаблон для описания проекта (*.ltp).
- **Process.cshtml** — Шаблон для описания процесса.
- **ActivityInfo.cshtml** — Шаблон для активностей проекта.
- **Template.uml** - Шаблон UML для визуализации процессов.
- **Template.docx** - Шаблон для автоматической генерации описания проекта в формате документа **MS Word**

Каждый из этих шаблонов использует свою модель данных, которая определяется директивой `@model`.

## Структура папки Resourses

В *AutoDoc* все шаблоны расположены в папке **Resources**. Она содержит необходимые файлы настроек и шаблоны, необходимые для генерации документации, включая:
 - Подпапки **assets** и **mazer**, которые содержат скрипты, шрифты и изображения для оформления конечных документов.
 - Файлы `.csv`, которые представляют собой словари или списки соответствий для отображения наименований типов, свойств и других элементов.
    - *tags.csv* — устанавливает соответствие между группами элементов и тегами.
    - *PropertiesDict.csv* — содержит отображаемые значения для некоторых свойств активностей.
    - *elements.csv* — описывает активности, включая группу, описание и название класса.

При создании пользовательских шаблонов в *AutoDoc* важно понимать синтаксис разметки и внедренного кода. Рекомендуется изучить справочник по синтаксису **Razor**, доступный по следующей ссылке: [Справочник по синтаксису Razor](https://learn.microsoft.com/ru-ru/aspnet/core/mvc/views/razor?view=aspnetcore-8.0).
Чтобы создать собственный шаблон, рекомендуется скопировать папку **Resources** и внести необходимые изменения в шаблоны *AutoDoc* под свои требования. Пользовательские шаблоны можно указать при запуске *AutoDoc* с параметрами `-t` или `-templates`.

Формат готовых документов зависит от параметров запуска:
- По умолчанию документы создаются в формате HTML.
- Для создания документов MS Word формата *.docx* используйте параметр `-word`.



### Описание свойств, используемых в шаблонах `*.cshtml`

Раздел содержит подробное описание свойств и типов данных, которые применяются в шаблонах `*.cshtml` для создания отчетов и документации.

####  Типы данных и их описание

**1. Тип *ProjectInfo***

Этот тип описывает общие данные о проекте, такие как его компоненты, теги, ресурсы и т. д.

| Свойство          | Тип                   | Описание                                          |
|-------------------|-----------------------|---------------------------------------------------|
| **ArgumentCount** | `int`                 | Общее количество аргументов                       |
| **Assets**        | `HashSet<string>`     | Общий список ресурсов                             |
| **ComponentCount**| `int`                 | Общее количество компонентов                      |
| **Descr**         | `string`              | Описание проекта из файла Itp                    |
| **GitRepo**       | `string`              | Путь к репозиторию GIT                            |
| **GroupUsage**    | `Dictionary<string, int>` | Группы элементов (наименование, количество)  |
| **HtmlKeywords**  | `string`              | Ключевые слова для метаданных страницы            |
| **Libraries**     | `HashSet<string>`     | Общий список библиотек                            |
| **Name**          | `string`              | Наименование проекта из файла Itp              |
| **ProcessCount**  | `int`                 | Общее количество процессов                        |
| **Queues**        | `HashSet<string>`     | Общий список очередей                             |
| **Tags**          | `HashSet<string>`     | Общий список тегов (tags.csv)                                |
| **Toc**           | `List<ToCItem>`       | Содержание — список элементов проекта             |
| **VariableCount** | `int`                 | Общее количество переменных                       |

**2. *Тип ProcessInfo***

Этот тип описывает информацию о каждом процессе, включая переменные, компоненты, аргументы и другие свойства, специфичные для процесса.

| Свойство               | Тип                           | Описание                                                         |
|------------------------|-------------------------------|------------------------------------------------------------------|
| **Activities**         | `List<ActivityInfo>`          | Список элементов процесса верхнего уровня                        |
| **Arguments**          | `List<ScriptVariable>`        | Аргументы                                                        |
| **ArgumentsGroups**    | `List<string>`                | Список групп аргументов                                          |
| **Assets**             | `HashSet<string>`             | Ресурсы                                                          |
| **BackPath**           | `string`                      | Относительный путь от папки процесса до папки проекта ("../..")          |
| **Components**         | `List<SerializationComponent>`| Компоненты процесса верхнего уровня                              |
| **Description**        | `string`                      | Описание проекта из файла Itw                                    |
| **GetTotalActivitiesCount** | `int`                   | Получить общее количество элементов                                       |
| **GlobalVariables**    | `List<ScriptVariable>`        | Переменные                                                       |
| **GlobalVariablesGroups** | `List<string>`            | Список групп переменных                                          |
| **HtmlKeywords**       | `string`                      | Ключевые слова для метаданных страницы                           |
| **HtmlText**           | `string`                      | Часть пути от папки отчетной документации до файла отчета html (с расширением файла) |                             |
| **HtmlPathName**       | `string`                      | Часть пути от папки отчетной документации до файла отчета HTML (без расширения файла)                        |
| **HtmlTreePrefix**     | `string`                      | Html строка неразрывных пробелов `&nbsp;`, соответствующая уровню вложенности процесса (Кол-во пробелов соответствует кол-ву папок в RelativePath)                    |
| **Name**               | `string`                      | Наименование процесса из файла Ltw                               |
| **ProjectHtml**        | `string`                      | Наименование файла с описанием проекта                           |
| **Queues**             | `HashSet<string>`             | Очереди                                                          |
| **RelativePath**       | `string`                      | Часть пути от папки проекта к подпапке с файлом процесса         |
| **SvgFileNameBigFull** | `string`                      |Устаревшее название 
| **SvgFileNameBig**     | `string`                      |  Путь к полной диаграмме процесса                           |
| **SvgFileNameSmall**   | `string`                      | Путь к краткой диаграмме процесса                                |
| **Tags**               | `HashSet<string>`             | Список тегов   tags.csv                                                  |
| **TocTodo**            | `List<ToCItem>`               | Список задач  (элементы WFToDo)                                                   |

***3. Тип ToCItem***

Этот тип описывает отдельные элементы содержания проекта, такие как описание, имя и ссылку на документ.

| Свойство      | Тип       | Описание                                    |
|---------------|-----------|---------------------------------------------|
| **Descr**     | `string`  | Описание элемента                           |
| **IsFolder**  | `string`  | Признак папки                               |
| **Name**      | `string`  | Имя элемента                                |
| **Prefix**    | `string`  | Префикс (путь до вложенного элемента)       |
| **Link**      | `string`  | Ссылка на документ — описание шаблона       |

***4. Тип ScriptVariable***

Тип `ScriptVariable` содержит информацию о переменных сценария, таких как имя, тип и значение по умолчанию.

| Свойство            | Тип          | Описание                                     |
|---------------------|--------------|----------------------------------------------|
| **subsheetid**      | `string`     | Идентификатор на листе                       |
| **IsGlobal**        | `bool`       | Признак глобальной переменной                |
| **Name**            | `string`     | Имя переменной                               |
| **Group**           | `string`     | Группа                                       |
| **Comment**         | `string`     | Комментарий                                  |
| **DataTypeString**  | `string`     | Тип переменной в строковом виде              |
| **Direction**       | `string`     | Назначение                                   |
| **DefaultValue**    | `DefaultValue`| Значение по умолчанию                       |
| **DefaultValueText**| `string`     | Значение по умолчанию в текстовом виде       |
| **ToHtml()**        | `string`     | Строка описания переменной для вставки в HTML|

**5. *Тип SerializationComponent***

Тип `SerializationComponent` описывает компоненты процесса, включая название, версию сборки и свойства компонента.

| Свойство           | Тип                   | Описание                                  |
|--------------------|-----------------------|-------------------------------------------|
| **AssemblyName**   | `string`              | Имя и версия сборки                       |
| **ClassName**      | `string`              | Имя класса компонента                     |
| **ClassRu**        | `string`              | Имя класса для документации  из elements.csv              |
| **Components**     | `Components`          | Дочерние компоненты                       |
| **NextElements**   | `HashSet<string>`     | Список идентификаторов последующих компонентов, выполняющихся после текущего компонента |
| **Properties**     | `Properties`          | Свойства компонента                       |

***6. Тип Components***

Тип `Components` используется для хранения списка компонентов процесса.

| Свойство                  | Тип                           | Описание                     |
|---------------------------|-------------------------------|------------------------------|
| **SerializationComponent** | `List<SerializationComponent>` | Список компонентов          |

***7. Тип Properties***

Тип `Properties` описывает свойства компонента и включает список элементов `SerializationItem`.

| Свойство                  | Тип                           | Описание                     |
|---------------------------|-------------------------------|------------------------------|
| **SerializationItem**     | `List<SerializationItem>`     | Список свойств               |



***8. Тип SerializationItem***

Тип `SerializationItem` описывает элементы сериализации, их значения и текстовое представление.

| Свойство       | Тип                    | Описание                                     |
|----------------|------------------------|----------------------------------------------|
| **IsListValue**| `string`               | Признак наличия нескольких значений  "false" или "true        |
| **ListValue**  | `List<SerializationItem>`| Список значений                              |
| **Name**       | `string`               | Имя элемента                                 |
| **Value**      | `Value`                | Значение элемента                            |
| **ValueText**  | `string`               | Текстовое значение элемента                  |

***9. Тип ActivityInfo***

Тип `ActivityInfo` описывает вложенные элементы активности, их идентификаторы, свойства и другие характеристики.

| Свойство            | Тип                   | Описание                                        |
|---------------------|-----------------------|-------------------------------------------------|
| **Activities**      | `List<ActivityInfo>`  | Список вложенных элементов                      |
| **BlockCatch**      | `ActivityInfo`        | Элемент BlockCatch и входящие в него активности                              |
| **BlockElse**       | `ActivityInfo`        | Элемент BlockElse и входящие в него активности                              |
| **BlockFinally**    | `ActivityInfo`        | Элемент BlockFinally и входящие в него активности                           |
| **BlockThen**       | `ActivityInfo`        | Элемент BlockThen  и входящие в него активности                             |
| **BlockTry**        | `ActivityInfo`        | Элемент BlockTry  и входящие в него активности                              |
| **Descr**           | `string`              | Описание элемента                               |
| **Guid**            | `string`              | Идентификатор элемента                          |
| **HasChildren**     | `bool`                | Наличие вложенных элементов (Есть записи в свойстве Activities)                    |
| **Header**          | `string`              | Заголовок элемента                              |
| **HtmlBorderColor** | `string`              | Цвет рамки границ элемента в отчете. Зависит от типа элемента               |
| **IsFirstLevel**    | `bool`                |Признак элемента корневого уровня               |
| **Link**            | `string`              | Ссылка на отдельный файл описания элемента                         |
| **Name**            | `string`              | Наименование элемента                           |
| **Num**             | `int`                 | Порядковый номер в списке активностей           |
| **PngFile**         | `string`              | Путь к файлу снимка экрана, отображаемому в элементе                          |
| **Props**           | `List<ActivityProp>`  | Свойства элемента                               |
| **ShortClass**      | `string`              | Короткое имя типа элемента                     |

***10. Тип ActivityProp***

Тип `ActivityProp` описывает свойства активности, такие как имя, язык и текстовое значение.

| Свойство     | Тип       | Описание                                |
|--------------|-----------|-----------------------------------------|
| **IsCode**   | `bool`    | Признак вычисляемости поля              |
| **Language** | `string`  | Язык                                    |
| **Name**     | `string`  | Имя свойства                            |
| **Value**    | `string`  | Текстовое значение свойства             |






