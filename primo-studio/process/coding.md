# Работа с кодом

Студия предоставляет возможность разрабатывать сценарии автоматизации в режиме чистого кода - Pure code. Для этого при создании сценария - или, иначе, *процесса* - выберите тип **Только код** (1) и укажите язык программирования (2).

![](<../../.gitbook/assets1/choose-pure-code.png>) 

По умолчанию используется язык С#, но вместо него вы можете выбрать Python или JavaScript. После создания процесса откроется редактор кода для работы:

![](<../../.gitbook/assets1/work-area-pure-code.png>)

**Как добавить в процесс элемент?**

Для работы с элементами перетащите нужный элемент в код, после чего будет создан образец для его вызова.

![](<../../.gitbook/assets/add-element-to-code-1.png>)

**Как в процессе вызвать другой процесс?**

Чтобы вызвать другой процесс, перетащите соответствующий файл процесса из панели проекта в код.

![](<../../.gitbook/assets1/dragdrop-proccess-in-proccess.png>) 

**Как использовать аргументы?**

Код поддерживает [аргументы](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/args) - переменные для обмена данными между процессами. Работа с ними не отличается от других типов процессов. Для работы с аргументами также можно использовать методы GetArgument и SetArgument глобальной переменной [wf](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/workflow).

**Возможности меню редактора кода**

Для создания [шаблона поиска](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/searchpatterns) в редакторе кода предусмотрены кнопки <img src="../../.gitbook/assets/image (22).png" alt="" data-size="line"> . Чтобы отредактировать шаблон, выделите его в коде и также используйте одну из этих кнопок.

![](<../../.gitbook/assets/selector-in-code.png>)

Чтобы установить [**Точку останова**](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/debug#tochka-ostanova), нажмите в меню кнопку <img src="../../.gitbook/assets/stop.png" alt="" data-size="line">.

![](<../../.gitbook/assets/breakpoint-in-only-code.png>)

В коде появится строка вызова точки останова: 

![](<../../.gitbook/assets/added-breakpoint-in-only-code.png>)

:bangbang: ***В языках Python и JavaScript последний параметр отвечает за номер строки точки останова.***

Если во время [отладки](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/debug) требуется просмотреть текущее состояние переменных, то:
* Добавьте точку останова к нужному элементу и примените команду **Отладить процесс**.

  ![](<../../.gitbook/assets/command-debug-in-only-code.png>)

* На панели **Элементы/Проект** вызовите контекстное меню и выберите пункт **Закрытые панели**.

  ![](<../../.gitbook/assets/closed-panels-in-code.png>)

* Нажмите появившуюся кнопку **Вывод**, чтобы отобразить панель.

  ![](<../../.gitbook/assets/output-in-code.png>)

* Перейдите на панель **Вывод**, нажав соответствующую кнопку внизу. 

  ![](<../../.gitbook/assets/panel-output-in-code.png>)

* Просмотрите состояния переменных на момент остановки выполнения кода.

  ![](<../../.gitbook/assets/value-var-in-output-in-code.png>)

  Если в панели **Вывод** отображаются неверные данные - например, с прошлой отладки в режиме последовательности - просто нажмите кнопку **Обновить**.

  ![](<../../.gitbook/assets/update-value-var-in-output-in-code.png>)

## Ограничения

В зависимости от выбранного языка, правила оформления и работа с кодом будут отличаться. Например, в языке C# будет создана специальная переменная **\_\_debug**, отвечающая за работу с отладчиком. 

Также в языках присутствуют следующие ограничения:

* В языке C# в панели **Переменные** отображаются только переменные уровня класса (поля и свойства).
* В языке Python в панели **Переменные** отображаются только переменные, имена которых начинаются с символа подчеркивания.
* Язык JavaScript не поддерживает отображения переменных и панели **Наблюдение**.
* Панель **Наблюдение** работает только с видимыми переменными.


## Learning

На странице [Learning](https://github.com/PrimoRPA/Learning) доступен RPA-проект **PureCode**. Он содержит примеры использования элементов в процессах с типом **Только код** (Pure code). В проекте находятся 3 подпапки - С, JS, Python - они соответствуют выбранному языку при создании процесса.

Как открыть проект:

1. Скачайте архив со всеми обучающими материалами по ссылке: [Скачать архив Learning](https://github.com/PrimoRPA/Learning/archive/refs/heads/master.zip).
2. Распакуйте архив, запустите Студию и откройте проект из папки **PureCode** (файл `project.ltp`).
3. Просмотрите `README.md`, чтобы ознакомиться с содержанием проекта.
