# Работа с кодом

Студия предоставляет возможность разрабатывать сценарии автоматизации в режиме чистого кода - Pure code. Для этого при создании сценария - или, иначе, *процесса* - выберите тип **Только код** (1) и укажите язык программирования (2).

![](<../../.gitbook/assets1/choose-pure-code.png>) 

По умолчанию используется язык С#, но вместо него вы можете выбрать Python или JavaScript. После создания процесса откроется редактор кода для работы:

![](<../../.gitbook/assets1/work-area-pure-code.png>)

**Как добавить в процесс элемент?**

Для работы с элементами перетащите нужный элемент в код, после чего будет создан образец для его вызова.

![](<../../.gitbook/assets/add-element-to-code-1.png>)

В разделах, посвященных описанию элементов, как правило, можно найти подраздел *Только код* - он содержит примеры использования элементов в чистом коде. См. пример для элемента [Получить значение](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_assets/el_orch_getvalue#tolko-kod): 

![](<../../.gitbook/assets1/example-code-in-element.png>)

Также рекомендуем изучить демонстрационный RPA-проект, выполненный в чистом коде. Подробнее см. в подразделе [Learning](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/coding#learning).

**Как в процессе вызвать другой процесс?**

Чтобы вызвать другой процесс, перетащите соответствующий файл процесса из панели проекта в код.

![](<../../.gitbook/assets1/dragdrop-proccess-in-proccess.png>) 

**Как использовать аргументы?**

Код поддерживает [аргументы](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/args) - переменные для обмена данными между процессами. Работа с ними не отличается от других типов процессов. Для работы с аргументами также можно использовать методы GetArgument и SetArgument глобальной переменной [wf](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/workflow).

**Возможности меню редактора кода**

Для создания [шаблона поиска](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/searchpatterns) в редакторе кода предусмотрены кнопки <img src="../../.gitbook/assets/image (22).png" alt="" data-size="line"> . Чтобы отредактировать шаблон, выделите его в коде и также используйте одну из этих кнопок.

![](<../../.gitbook/assets/selector-in-code.png>)

Чтобы установить [**Точку останова**](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/debug#tochka-ostanova), нажмите в меню кнопку <img src="../../.gitbook/assets/stop.png" alt="" data-size="line">.

![](<../../.gitbook/assets/breakpoint-in-only-code.png>)

В коде появится строка вызова точки останова: 

![](<../../.gitbook/assets/added-breakpoint-in-only-code.png>)

:bangbang: ***В языках Python и JavaScript последний параметр отвечает за номер строки точки останова.***

Обращаем внимание, что в версии Студии 23.11 для отладчика чистого кода реализована версия ядра v2. Среди ее преимуществ:
* Вместо кода для точки останова теперь используются цветовые индикаторы (см. на рисунке ниже).
* Стали видны текущие значения локальных переменных функции. Ранее, в версии v1, в панели **Вывод** отображались только текущие значения переменных класса.
* На точке останова стало возможным перейти к коду функции.

![](<../../.gitbook/assets1/set-breakpoint.png>) 

Выбрать ядро отладчика чистого кода пользователь может в окне [настроек](https://docs.primo-rpa.ru/primo-rpa/primo-studio/settings#otladchik) Студии. По умолчанию используется версия v1. 

![](<../../.gitbook/assets1/version-of-debagger.png>)

Если во время [отладки](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/debug) вам требуется просмотреть текущее состояние переменных:
1. Добавьте точку останова к нужному элементу и примените команду **Отладить процесс**.

   ![](<../../.gitbook/assets/command-debug-in-only-code.png>)

2. На панели **Элементы/Проект** вызовите контекстное меню и выберите пункт **Закрытые панели**.

   ![](<../../.gitbook/assets/closed-panels-in-code.png>)

3. Нажмите появившуюся кнопку **Вывод**, чтобы отобразить панель.

   ![](<../../.gitbook/assets/output-in-code.png>)

4. Перейдите на панель **Вывод**, нажав соответствующую кнопку внизу. 

   ![](<../../.gitbook/assets/panel-output-in-code.png>)

5. Просмотрите состояния переменных на момент остановки выполнения кода.

   ![](<../../.gitbook/assets/value-var-in-output-in-code.png>)

6. Если в панели **Вывод** отображаются неверные данные - например, с прошлой отладки в режиме последовательности - просто нажмите кнопку **Обновить**.

   ![](<../../.gitbook/assets/update-value-var-in-output-in-code.png>)


## Ограничения

В зависимости от выбранного языка, правила оформления и работа с кодом будут отличаться. Например, в языке C# будет создана специальная переменная **\_\_debug**, отвечающая за работу с отладчиком. 

Также в языках присутствуют следующие ограничения:
* В языке Python в панели **Переменные** отображаются только переменные, имена которых начинаются с символа подчеркивания.
* Язык JavaScript не поддерживает отображения переменных и панели **Наблюдение**.
* Панель **Наблюдение** работает только с видимыми переменными.


## Learning

На странице [Learning](https://github.com/PrimoRPA/Learning) доступен RPA-проект **PureCode**. Он содержит примеры использования элементов в процессах с типом **Только код**. В проекте находятся 3 подпапки - С, JS, Python - они соответствуют выбранному языку при создании процесса.

Как открыть проект:

1. Скачайте архив со всеми обучающими материалами по ссылке: [Скачать архив Learning](https://github.com/PrimoRPA/Learning/archive/refs/heads/master.zip).
2. Распакуйте архив, запустите Студию и откройте проект из папки **PureCode** (файл `project.ltp`).
3. Просмотрите `README.md`, чтобы ознакомиться с содержанием проекта.
