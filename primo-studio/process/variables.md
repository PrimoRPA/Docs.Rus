# Переменные и аргументы

## Переменные

Переменные используются в работе сценариев для хранения промежуточных данных. Управление переменными осуществляется на панели **Переменные**.

![](<../../.gitbook/assets/0 (168).png>)

Переменная состоит из следующих частей:

* **Имя переменной** – задается в соответствии с правилами выбранного языка (C#, Python или JavaScript).
* **Тип переменной** – тип данных переменной на выбранном языке.
* **Комментарий** – текст, описывающий назначение переменной (необязательно).
* **Значение по умолчанию** – выражение на выбранном языке программирования. Результат выполнения выражения будет присвоен переменной. Необязательно для заполнения. Если переменной не задано значение по умолчанию, то ее начальное значение будет NULL.

Для добавления переменной можно использовать опцию быстрого создания переменной из контекстного меню соответствующего свойства:

![](<../../.gitbook/assets/image (368).png>)

Или можно нажать кнопку **Создать переменную** ![](<../../.gitbook/assets/1 (141).png>) в панели **Переменные** и в появившемся окне ввести информацию о ней.

Для более удобного выбора типа переменной нажмите кнопку **"…"** и в открывшемся окне **Тип данных** найдите нужный:

![](<../../.gitbook/assets/3 (8).png>)

Для работы с обобщенными типами существует ассистент выбора обобщенного типа:

![](<../../.gitbook/assets/4 (9).png>)

Для удаления переменной необходимо выделить строчку с ней в таблице и либо нажать кнопку **Удалить переменную** ![](<../../.gitbook/assets/13 (1) (1) (2) (1) (1) (2) (2).png>), либо кнопку **Delete**.

Для редактирования переменной необходимо дважды кликнуть на строке, значение которой нужно изменить.

Тип переменной является автодополняемым значением, например, достаточно ввести List\<String> и нажать Enter. Система сама приведет тип к System.Collections.Generic.List\<System.String>.

## Аргументы

Аргумент является переменной, предназначенной для обмена между процессами. Он отличается от обычной переменной наличием свойства **Направление**, которое пределяет, сможет ли аргумент получать и передавать данные в вызывающий процесс. Свойство **Направление** имеет следующие значения:

* IN – аргумент работает только на прием.
* OUT – аргумент работает только на передачу.
* IN\_OUT – аргумент работает в обе стороны.

![](<../../.gitbook/assets/6 (5).png>)

Также переменную можно перетащить в панель свойств выбранного элемента.

Для вызова одного процесса из другого необходимо перетащить вызываемый процесс из панели **Проект** в треугольник, определяющий место вызова подпроцесса в сценарии:

![](../../.gitbook/assets/7.png)

Для подключения к аргументам подпроцесса нужно нажать кнопку ![](<../../.gitbook/assets/8 (3).png>). В открывшемся окне, в колонке **Назначение**, укажите выражения на выбранном языке программирования (C#, Python или JavaScript) либо имена переменных, используемых при взаимодействии с подпроцессом. По завершении редактирования окно можно закрыть.

![](../../.gitbook/assets/9.png)

## Глобальная переменная \_Workflow

Дополнительно в Студии доступна специальная переменная \_Workflow, которая является глобальной.

При вызове данной переменной в расширенном редакторе элемента (например, в элементе **Присвоение**) будут доступны следующие свойства:

![](../../.gitbook/assets/workflow.png)

1. Caller - ссылка на объект процесса, который вызвал текущий процесс.
2. Current - ccылка на объект текущего процесса.
3. CurrentWorkflowPath - ссылка на путь текущего процесса, то есть к конкретному ltw-файлу (с версии 1.1.29).
4. GetArgument - позволяет получить агрумент.
5. SetArgument - позволяет изменить агрумент.

С помощью свойства Logging.ScreenshotsPath можно изменить путь по умолчанию до папки со скриншотами. Пример: в C# script укажите свой путь к файлам скриншотов, используя синтаксис \_Workflow.Logging.ScreenshotsPath = "\<screens_folder>\", где screens_folder - новая папка для сохранения скриншотов, назначенная по умолчанию, которая будет создана в папке проекта.
