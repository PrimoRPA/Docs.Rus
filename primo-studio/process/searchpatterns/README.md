# Шаблоны поиска

**Шаблон поиска** - это свойство некоторых элементов Студии, которое управляет настройками поиска компонентов приложений и представляет собой JSON-файл. Такое свойство, например, есть у элемента [Клик мышью](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_uiinteraction/el_click).

Шаблон можно сформировать автоматически, нажав кнопку **Выбрать компонент** ![](<../../../.gitbook/assets/image (794).png>). Она вызывает захват элемента управления в зависимости от категории приложения. На данный момент имеются следующие категории:

* **Браузер**
* **Рабочий стол**
* **SAP** 

Если категория неизвестна, то редактор шаблона поиска будет выглядеть следующим образом:

![](<../../../.gitbook/assets/image (959).png>)

Редактировать шаблон поиска можно двумя способами:
* В свойстве **Шаблон поиска** при нажатии многоточия - ![](<../../../.gitbook/assets/Шаблон поиска. Многоточие (2).png>). В результате откроется JSON-файл для правки.
* При нажатии кнопки ![](<../../../.gitbook/assets/image (516) (1) (2) (1) (1) (2) (2).png>) - откроется графическое окно редактирования шаблона. Вид окна зависит от типа элемента и представлен на рисунках ниже - в подразделах категорий.

Удалить шаблон можно кнопкой ![](<../../../.gitbook/assets/13 (1) (1) (2) (1) (1) (1).png>), либо нажав клавишу Del.

**Примечание**. В шаблонах поиска можно использовать имена переменных в формате {переменная}.

## Браузер ![](<../../../.gitbook/assets/Категория. Браузер.png>)

Шаблон поиска элементов для категории **Браузер** выглядит следующим образом:

![](<../../../.gitbook/assets/image (562).png>)

Для добавления элемента шаблона вручную:
1. Нажмите кнопку ![](<../../../.gitbook/assets/12 (2) (3) (1) (1) (1).png>), после чего выделите новую строку и введите данные в поля **Тэг, Текст, Индекс** (начинается с единицы) и **Искать во фреймах** (поиск внутри элементов iframe). 
2. Для уточнения поиска можно ввести имена и значения атрибутов тэга в таблицу (ключ, значение). Если указать несколько строк, поиск элемента в браузере будет вестись вглубь от самого верхнего шаблона.

Для автоматического добавления элемента нажмите кнопку **Выбрать компонент** ![](<../../../.gitbook/assets/14 (1) (2) (1) (1) (2) (2).png>) и в нужном окне браузера кликните искомый элемент. Также можно использовать быструю кнопку на самом элементе.

При нажатии кнопки **Отобразить компонент** ![](<../../../.gitbook/assets/15 (1) (1) (1) (1).png>) будет выделен элемент управления, обозначенный в текущем шаблоне.

Кнопка **Инспектор UI** ![](<../../../.gitbook/assets/6 (2).png>) служит для отображения/скрытия модуля исследования интерфейсов:

![](<../../../.gitbook/assets/7 (6).png>)

В данном модуле можно исследовать структуру приложения. При помощи кнопок ![](<../../../.gitbook/assets/18 (1) (2) (1) (1) (2) (2).png>) и ![](<../../../.gitbook/assets/19 (1) (2) (1) (1) (2).png>) происходит перенос выбранных элементов в шаблон.

## Рабочий стол ![](<../../../.gitbook/assets/Категория. Десктоп.png>)

Шаблон поиска элементов **Рабочий стол** выглядит следующим образом:

![](<../../../.gitbook/assets/image (942).png>)

Для добавления элемента шаблона вручную:
1. Нажмите кнопку ![](<../../../.gitbook/assets/12 (2) (3) (1) (1) (2) (2).png>), далее выделите новую строку и введите данные в поля **Name, AutomationID, ClassName, ControlType, LocalizedControlType** и **Индекс** (начинается с единицы). 
2. Для уточнения поиска можно ввести имена и значения атрибутов искомого компонента в таблицу (ключ, значение). Если указать несколько строк, поиск элемента в роботизируемом приложении будет вестись вглубь от самого верхнего шаблона. Для укороченного маршрута включите параметр **Быстрый поиск**.

**ВНИМАНИЕ!!! При работе с Java, разрядность Студии и Робота должны совпадать с разрядностью Java.**

Для автоматического добавления элемента нажмите кнопку **Выбрать компонент** ![](<../../../.gitbook/assets/14 (1) (2) (1) (1) (2).png>) и в окне нужного приложения кликните искомый элемент. Также можно использовать быструю кнопку на самом элементе.

При нажатии кнопки **Отобразить компонент** ![](<../../../.gitbook/assets/15 (1) (1) (1) (1) (2).png>) будет выделен элемент управления, обозначенный в текущем шаблоне.

Кнопка **Инспектор UI** ![](<../../../.gitbook/assets/16 (1).png>) служит для отображения/скрытия модуля исследования интерфейсов:

![](../../../.gitbook/assets/17.png)

В данном модуле можно исследовать структуру приложения. При помощи кнопок ![](<../../../.gitbook/assets/18 (1) (2) (1) (1) (2) (1).png>) и ![](<../../../.gitbook/assets/19 (1) (2) (1) (1) (2) (1).png>) происходит перенос выбранных элементов в шаблон.

В случае, если необходим обход всего дерева контроллов, лучше воспользоваться кнопкой **Автопоиск** с установленным чекбоксом **Все дерево**:

![](<../../../.gitbook/assets/image (453).png>)

## SAP ![](<../../../.gitbook/assets/Категория. SAP.png>)

При работе с SAP рекомендуется использовать специализированные компоненты.

Шаблон поиска для категории **SAP** выглядит следующим образом:

![](<../../../.gitbook/assets/image (551).png>)

Если происходит работа с WebView SAP, шаблон поиска будет иметь следующий вид:

![](<../../../.gitbook/assets/image (465).png>)

Область Browser представляет собой шаблон поиска для браузера.

В шаблонах поиска SAP допускается использование символа \*.

## Контейнеры

По-прежнему рекомендуется использовать элементы совместно с контейнерами. Для этого в редакторе шаблона поиска нужно выбрать **Контейнер**:

![](<../../../.gitbook/assets/image (509) (1) (2) (1) (1) (2).png>)
