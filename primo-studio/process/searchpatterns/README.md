# Шаблоны поиска

**Шаблон поиска** - это свойство ряда элементов Студии, которое используется для взаимодействия с пользовательским интерфейсом программ. Оно позволяет идентифицировать компонент приложения и получить к нему программный доступ. Свойство **Шаблон поиска** есть, например, у элемента [Клик мышью](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_uiinteraction/el_click) - с его помощью можно определить кнопку приложения, по которой нужно кликнуть. 

Шаблон поиска представляет собой JSON-файл, который содержит заданный набор свойств для идентификации компонента и другие вспомогательные параметры. Его можно сформировать вручную или автоматически. Для автоматического формирования шаблона используется кнопка **Выбрать компонент** ![](<../../../.gitbook/assets/image (794).png>) - она вызывает захват элемента управления в зависимости от категории приложения. 

Primo RPA поддерживает поиск в следующих категориях приложений (режимах):

* **Браузер**
* **Рабочий стол**
* **SAP** 
* **Контейнер** - *подробнее см. ниже, в подразделе **Выбор режима***.

Редактировать шаблон можно двумя способами:
* **В формате правки JSON-файла.** Для открытия файла нажмите в свойстве **Шаблон поиска** значок многоточия. Пример: ![](<../../../.gitbook/assets/Шаблон поиска. Многоточие (2).png>). 
* **Через окно редактора шаблона**. Для открытия графического окна нажмите кнопку ![](<../../../.gitbook/assets/image (516) (1) (2) (1) (1) (2) (2).png>). Окно редактора шаблона видоизменяется в зависимости от типа приложения, примеры интерфейса представлены на рисунках ниже.

## Интерфейс редактора шаблона

Интерфейс редактора шаблона зависит от типа приложения, в котором необходимо найти компонент. В ситуации, когда категория приложения неизвестна, редактор шаблона поиска будет выглядеть следующим образом:

![](<../../../.gitbook/assets/Шаблон поиска. Неизвестно.png>)

После выбора типа приложения (вручную или автоматически) в окне редактора появятся соответствующие параметры поиска и возможные команды.

Редактор шаблона для типов **Браузер** и **Рабочий стол** имеет следующие общие элементы интерфейса:

![](<../../../.gitbook/assets/Шаблон поиска. Интерфейс редактора.png>)

1. **Тип приложения** - иконка выбора между вариантами среды, для которой создается шаблон. К примеру, на рисунке выше выбран тип приложений **Рабочий стол**.
2. **Подтип** - список значений зависит от выбранной среды. Например, в режиме **Рабочий стол** потребуется выбрать тип автоматизации, в режиме **Браузер** - тип браузера.
3. **Заголовок** - параметр для поиска. Например, в режиме **Рабочий стол** здесь необходимо указать название десктоп-приложения.
4. **Выбрать компонент** - позволяет автоматически выбрать элемент управления и добавить его в шаблон.
5. **Отобразить компонент** - выделяет элемент управления, который был задан в шаблоне.
6. **Инспектор UI** - инструмент для детального исследования интерфейсов приложений. Выводит окно с подробной информацией обо всех открытых приложениях и их компонентах. Позволяет перенести выбранный элемент в шаблон.
7.  ![](<../../../.gitbook/assets/12 (2) (3) (1) (1) (1).png>) - кнопка для ручного добавления элемента управления в шаблон.
8. ![](<../../../.gitbook/assets/13 (1) (1) (2) (1) (1) (1).png>) - кнопка для удаления элемента из шаблона. Возможно удалить клавишей Del.


## Процесс поиска

Рассмотрим, как происходит поиск компонента на примере работы с приложением **Калькулятор** (категория **Рабочий стол**).

С точки зрения ОС Windows, приложение состоит из ряда компонентов (кнопки, текстовые поля, таблицы), объединенных в дерево. Любая кнопка, которую видит пользователь в интерфейсе программы, будет входить в данное дерево. В свою очередь, каждый компонент обладает набором свойств: они идентифицируют элемент приложения, предоставляют информацию о его специфике и назначении, разбивают все компоненты рабочего стола по тегам и классам.

Для идентификации компонента Primo RPA также использует поиск по его свойствам, или, иначе, селекторам. 

Откроем приложение **Калькулятор** в Windows. Создадим в Студии новый проект и выполним следующие действия:
1. Добавим контейнер [**Присоединиться к приложению**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_desktop/el_desktop_attach). В свойстве **Заголовок** воспользуемся кнопкой ![](<../../../.gitbook/assets/image (794).png>) для быстрого указания названия приложения (Калькулятор).
2. Поместим в контейнер элемент [**Клик мышью**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_uiinteraction/el_click). 
3. На панели элемента **Клик мышью** нажмем кнопку **Выбрать компонент** ![](<../../../.gitbook/assets/image (794).png>) - для его автоматического добавления в шаблон. 

![](<../../../.gitbook/assets/Шаблон поиска. Калькулятор.png>)
 
**Внимание! Окно с приложением **Калькулятор** должно находиться на переднем плане!**

После нажатия кнопки ![](<../../../.gitbook/assets/image (794).png>) мы переместимся в окно с **Калькулятором**, чтобы выбрать нужный компонент. При наведении указателя на элемент приложения, он будет подсвечиваться, а в левом верхнем углу появится его увеличенное изображение. 

![](<../../../.gitbook/assets/Шаблон поиска. Выбор кнопки в Калькуляторе.png>)

Выберем **кнопку 5** - появится окно с выбором свойств для идентификации компонента (селекторы).

![](<../../../.gitbook/assets/Селекторы калькулятора.png>)

**AutomationID** - одно из главных свойств для компонентов приложений рабочего стола. Оно не изменяется при каждом запуске и однозначно идентифицирует компонент вне зависимости от экземпляра процесса Windows, в котором он задействован. 

> *Опция **Полное дерево контроллов** - это многоуровневый селектор, который имеет ряд трудностей при использовании. Он работает намного медленнее, чем точечный выбор параметров.*

Выберем параметры **AutomationID**, **Name** (имя элемента автоматизации) и нажмем **ОК** - наш селектор создан. Он сохранится в JSON-файле шаблона поиска. Если просмотреть готовый шаблон через окно редактора, он будет выглядеть таким образом:

![](<../../../.gitbook/assets/Шаблон поиска. Контейнер.png>)

В дальнейшем, при обработке шаблона, Робот возьмет заданные свойства и проанализирует дерево компонентов в поисках позиции, которая имеет указанные значения в параметрах **AutomationID** и **Name**. При совпадении значений компонент будет найден.  

## Выбор режима

Студия самостоятельно определяет режим редактора шаблона (Рабочий стол, Браузер, SAP, Контейнер) при условии, что компонент приложения был добавлен в шаблон автоматически - кнопкой ![](<../../../.gitbook/assets/image (794).png>). Добавление по кнопке ![](<../../../.gitbook/assets/image (794).png>) рекомендуется использовать в первую очередь, при возникновении сложностей - попробуйте ручное добавление.

Так, в примере с Калькулятором готовый шаблон отобразился в режиме **Контейнер**. Это произошло по той причине, что элемент **Клик мышью** был помещен в элемент-контейнер **Присоединиться к приложению**. Студия самостоятельно определила тип приложения **Калькулятор** и отобразила в шаблоне редактора параметры поиска для приложения рабочего стола.

Размещение элементов в контейнере экономит ресурсы компьютера и улучшает работу с нагруженными проектами. 

## Категории приложений

Работа с шаблоном поиска в категориях приложений *Рабочий стол, Браузер, SAP* описана в разделе [**Типы приложений**] (ДОБАВИТЬ ССЫЛКУ). 

## Инспектор UI

Работа с инструментом **Инспектор UI** подробнее описана [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-studio/instrumenty/uiexplorer). 

