# Новый редактор шаблона поиска

Новый редактор шаблона поиска — это улучшенная версия старого редактора, которая призвана сделать его удобнее и повысить точность поиска элементов управления.

В новый редактор внесены следующие изменения:

1. **Подсказки для горячих клавиш**.

   В окне **Выбор элемента** (Element selection) добавлены подсказки для горячих клавиш, которые вы можете использовать при выборе элемента управления.
  
   ![Окно Выбор элемента](<../../../.gitbook/assets/picker-3.png>)

1. **Всплывающие подсказки при работе со свойствами элемента управления**.

   Добавлены всплывающие подсказки, помогающие скорректировать шаблон поиска. Значения свойств стали доступны для редактирования.
  
   ![Вкладка Параметры](<../../../.gitbook/assets/edit-value-in-pattern-editor.png>)

1. **Вкладки `Структура` и `Код`**.

   В редакторе шаблона появились вкладки **Структура** и **Код** (шаблон поиска в формате JSON).

   Дополнительно появилась возможность быстро поменять текущий селектор. 

   ![Вкладка Структура](<../../../.gitbook/assets/structure-tub-in-editor.png>)

   ![Вкладка Код](<../../../.gitbook/assets1/code.png>)

1. **Корректное отображение результатов валидации**.

   На этапе выбора свойств стало возможным проверить корректность шаблона (селектора). Для этого используйте кнопку **Валидация настроек шаблона**. Функция запускает проверку текущих настроек — результат отображается внизу редактора. 

   ![Валидация настроек шаблона](<../../../.gitbook/assets1/validation.png>)  

1. **Отображение шаблона в виде дерева**.

   Шаблон поиска можно отображать в виде дерева, что упрощает навигацию и управление элементами шаблона.

   ![Кнопка Показывать дерево](<../../../.gitbook/assets1/as_tree.png>)

1. **Путь до элемента**.

   В окне редактора добавлена опция **Путь до элемента**, позволяющая управлять родительскими и дочерними селекторами. Путь до элемента помогает определить точное расположение элемента в иерархии пользовательского интерфейса.
 
   ![Путь до элемента](<../../../.gitbook/assets/button-path-to-element-in-editor-pattern.png>)

   Дочерние и родительские селекторы добавляются/удаляются при помощи команд контекстного меню.

   ![Управление иерархией селекторов через контекстное меню](<../../../.gitbook/assets/daughter-selector-context-menu.png>)

   Функция полезна в ситуациях, когда бывает сложно определить нужный элемент управления только по его параметрам.

   ![Управление дочерним селектором](<../../../.gitbook/assets/parameters-daughter-selector.png>)

1. **Копирование кода шаблона поиска**.
  
   Стало возможным скопировать код шаблона для использования в других проектах.

   ![](<../../../.gitbook/assets1/copecode.png>)

1. **Переименование и удаление параметров**.

   Стало возможным добавить новый параметр, а также переименовать или удалить существующие параметры для более точного определения элемента.

   ![Кнопки управления параметрами](<../../../.gitbook/assets1/deleteparam.png>)

1. **Поддержка Java Applet**.

   Добавлена опция для включения или отключения поддержки **Java Applet** при работе с элементами интерфейса. Эта опция позволяет работать с элементами Java-апплетов, интегрированных в веб-страницы или приложения.

   ![Java Applet](<../../../.gitbook/assets1/par_javaapplet.png>)

### Режим выбора элемента на экране 

Кнопка *"Режим выбора элемента на экране"* (иконка Волшебная палочка) в Редакторе шаблона поиска используется для переключения между различными методами распознавания элемента. Если один элемент может быть обнаружен разными способами, система автоматически создает несколько вариантов шаблонов поиска.

#### Рекомендации:
- Если шаблон сформирован некорректно или элемент определился, например, как рабочий стол, это связано с приоритетом используемых методов. Нажмите кнопку несколько раз, чтобы переключить методы и выбрать подходящий вариант.
- При необходимости можно воспользоваться ручным режимом выбора элемента на экране.
- Некорректное распознавание элемента не является ошибкой, а отражает гибкость инструмента, который адаптируется для работы с различными интерфейсами.

### Браузерный селектор

В редакторе шаблона браузерного селектора добавлен параметр **Активировать вкладку**. Этот параметр позволяет автоматизировать процесс переключения на нужную вкладку в браузере перед выполнением действия, если текущая активная вкладка не соответствует указанным параметрам (URL, Заголовок, Индекс).

-  Если флажок установлен, робот проверяет, соответствует ли текущая активная вкладка параметрам, заданным в селекторе.  
-  Если вкладка не соответствует, робот автоматически активирует нужную вкладку и затем выполняет действие (например, клик).

При наличии нескольких вкладок с одинаковыми URL или Заголовком рекомендуется использовать параметр **Индекс вкладки** для однозначного указания нужной вкладки. **Функция доступна с версии 1.24.8**

![Параметр Активировать вкладку](<../../../.gitbook/assets1/aktivirovat_vkladku.png>)

>  С версии Студии  *1.25.1* редактор шаблонов поддерживает работу с веб-элементами на страницах браузера Microsoft Edge, работающих в режиме эмуляции **Internet Explorer (IE)**. 
   * Возможен выбор элементов с помощью инструмента *Волшебная палочка* как в режиме **Браузер**, так и в режиме **Рабочий стол**.  
   * Добавлена поддержка редактирования ранее выбранных элементов и валидации шаблонов в указанном режиме.  

## Регулярные выражения (RegEx) 

С версии *1.25.1* в редакторе шаблонов в режиме работы *Рабочий стол (Desktop)* и *Браузер (Browser)* добавлена возможность использовать регулярные выражения (RegEx) для параметров селектора.

По умолчанию для параметров установлен режим *"Обычный"* (иконка `A+`).  
Для переключения в режим регулярных выражений нажмите на значок `A+` и в выпадающем меню выберите *"Регулярное выражение"* (иконка `. *`).

   ![](<../../../.gitbook/assets1/Regex.png>)


- *Режим "Обычный"* — используется для точного сопоставления значений.
- *Режим "Регулярное выражение"* — позволяет задавать шаблоны для работы с динамическими элементами.


### Искать во Фреймах

Свойство *"Искать во Фреймах"* предназначено для поиска элементов внутри HTML-фреймов `<frame>` и `<iframe>`, но при его использовании существуют следующие ограничения:

 -  **1. Защищённые фреймы:**
   Если фрейм защищён настройками браузера, то поиск внутри него невозможен.
  -  **2. Разные домены:**
   Поиск не выполняется, если содержимое фрейма загружается с другого домена или хоста. Например:
      - Работает: <iframe src="/local.html"> (тот же домен).
      - Не работает: <iframe src="https://externaldomain.com/page.html"> (другой домен).

Для корректной работы убедитесь, что фрейм загружает содержимое с того же домена и не имеет ограничений безопасности.


### Старый редактор шаблона поиска

Для использования старого редактора шаблона поиска перейдите в раздел **Настройки ➝ Общие ➝ Элементы** и установите галочку напротив опции **Использовать старый редактор шаблона поиска по умолчанию**.

![Использовать старый шаблон поиска](<../../../.gitbook/assets1/use_old_patt.png>)

### Строгий поиск

Начиная с версии Студии 1.25.1 в редакторе шаблонов добавлен чекбокс ***Строгий поиск***. По умолчанию он отключен. Если чек-бок установлен, то поиск будет выполняться строго по указанному дереву элементов, без пропуска слоев, что позволяет более точно идентифицировать элементы на экране.


#### ⚠  Обратите внимание! 

Строгий поиск работает только при отключенном параметре *Быстрый поиск*. Для корректного использования убедитесь, что *Быстрый поиск* не активен.


 ![Строгий поиск](<../../../.gitbook/assets1/strict_search.png>)



> Новый редактор шаблонов не поддерживается для элементов *Поколение 1* (папка "Рабочий стол - Поколение 1"). Для них используется старый редактор.
