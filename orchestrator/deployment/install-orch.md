# Порядок установки компонентов

Развертывание Оркестратора подразумевает последовательную установку двух подсистем: 
* Оркестратора;
* Робота.

Все шаги полностью самодостаточны, содержат установку необходимых переменных окружения, открытия [портов](https://docs.primo-rpa.ru/primo-rpa/orchestrator/ports) на файерволе ОС, настройку прав и т.п.

## Установка Оркестратора

Установите компоненты подсистемы **Оркестратор**, последовательно выполнив шаги из таблицы.

| Шаг                           | Примечание     |
| ----------------------------- | -------------- |
| 1. Предварительная настройка машины Оркестратора | См. разделы: <p>- [Windows 2016 Server - Предварительная настройка машины Оркестратора;](https://docs.primo-rpa.ru/primo-rpa/orchestrator/setting-up-machines/windows/presetting-orch-machine)<p>- [CentOS 8 - Предварительная настройка машины Оркестратора.](https://docs.primo-rpa.ru/primo-rpa/orchestrator/setting-up-machines/linux/presetting-orch-machine)</p> Либо одноименные руководства в формате \*.docx из комплекта поставки |
| 2. Установка PostgreSQL (+pgbouncer) или MS SQL SERVER |  |
| 3. Установка RabbitMQ     | Если RabbitMQ был установлен ранее, требуется удалить все очереди. <p> Может быть установлен для соединения по SSL. См. в комплекте поставки «Руководство по настройке работы сервисов оркестратора с RabbitMQ через SSL.docx» </p> |
| 4. Установка WebApi и MachineInfo\* | Включает шифрование паролей в конфигурационных файлах.  <p>При установке на Linux chmod назначить в соответствии с «Руководством по предварительной настройке машины Оркестратора под CentOS 8.docx» (входит в комплект поставки) </p> |
| 5. Установка Notifications     | *См. примечание к п.4*      |
| 6. Установка NuGet             | *См. примечание к п.4*      |
| 7. Установка States            | *См. примечание к п.4*      |
| 8. Установка RDP2              | *См. примечание к п.4.* <p>Может быть установлен на сервере Оркестратора либо на отдельном сервере.</p> <p>**Не следует устанавливать RDP2 на машине робота!**</p>     |
| 9. Установка RobotLogs         | *См. примечание к п.4*     |
| 10. Установка Front            | -                        |

> \* *Если не используется сервис MachineInfo, необходима первоначальная настройка БД. Это требует разрешения выполнения в БД команд shell ОС. В настоящей версии Оркестратора рекомендуется использовать сервис MachineInfo.*

Изначально можно пропустить шаги **5–7** (Notifications, NuGet, States) и выполнить установку этих компонентов позже. Другие шаги не могут быть пропущены.

Установка LogEventsWebhook может быть произведена позже, когда будет разработан и развернут интеграционный шлюз Заказчика (см. [Интеграция с внешними системами](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/integration)). 

Руководства по установке всех перечисленных компонентов входят в комплект поставки Оркестратора (файлы \*.docx).

### Условия для корретной работы
1. **Windows**. Службы устанавливаются под администратором и работают под LocalSystem.
2. **Linux**. Службы устанавливаются и работают от root.
3. **Учетные записи**. На машинах Оркестратора и БД используются только для поддержки и администрирования системы.
4. **Права учетной записи в БД**. Должна иметь права на чтение/вставку/изменение/удаление записей таблиц и создание объектов БД - для возможности автоматических миграций.

### Пошаговая установка Оркестратора
Видео по установке Оркестратора на Windows Server 2019 с WebApi (IIS) можно просмотреть [здесь](https://www.youtube.com/watch?v=IAIRmChw65k&ab_channel=PrimoRPA).

<a href="https://www.youtube.com/watch?v=IAIRmChw65k"><img src="https://raw.githubusercontent.com/PrimoRPA/Docs.Rus/main/.gitbook/assets/video_preview/test_gif.gif" width="850" title="hover text"></a>

## Установка Робота
После установки Оркестратора можно переходить к установке Робота. 

Последовательно выполните шаги из таблицы.

| Шаг                                              | Примечание     |
| ------------------------------------------------ | -------------- |
| 1. Настройка машины робота                       | 1. См. [Настройка машины робота под Windows 2016 Server](https://docs.primo-rpa.ru/primo-rpa/orchestrator/setting-up-machines/windows/robotmachine) <p>2. См. [Настройка машины робота под CentOS 8](https://docs.primo-rpa.ru/primo-rpa/orchestrator/setting-up-machines/linux/robotmachine) </p> |  
| 2. Установка Agent на машине робота              | 1. См. [Установка Агента Оркестратора из инсталлятора под Windows 2016 Server](https://docs.primo-rpa.ru/primo-rpa/orchestrator/setting-up-machines/windows/agentinstaller) или [Установка Агента без инсталлятора под Windows 2016 Server](https://docs.primo-rpa.ru/primo-rpa/orchestrator/setting-up-machines/windows/appendix). <p> 2. См. [Установка Агента Оркестратора под CentOS 8](https://docs.primo-rpa.ru/primo-rpa/orchestrator/setting-up-machines/linux/agentinstall) </p> |  


### Условия для корретной работы

1. **Windows**. Используйте на машине робота одну учетную запись для службы Агента Оркестратора. Она нужна, чтобы Агент смог проделать предварительную работу по запуску Робота и создать задачу в Windows, которая запустит Робота.
2. **Linux**. Требуется одна учетная запись для функционирования Агента Оркестратора.




