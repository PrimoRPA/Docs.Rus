# Установка компонентов

Установка компонентов Оркестратора подразумевает последовательную установку двух подсистем: 
* Оркестратора;
* Робота.

## Установка Оркестратора

Сначала требуется установить компоненты для подсистемы «Оркестратор». Ниже приведены шаги установки, которые нужно выполнять ***последовательно***. Все шаги самодостаточны, содержат установку необходимых переменных окружения, открытия портов на файерволе ОС, настройку прав и т.п.

Руководства по установке перечисленных компонентов входят в [комплект поставки Оркестратора]().

**Примечания к установке:**
1. **Windows**. Службы устанавливаются под администратором и работают под LocalSystem.
2. **Linux**. Службы устанавливаются и работают от root.
3. **Учетные записи**. На машинах Оркестратора и БД используются только для поддержки и администрирования системы.\
   Учетная запись в БД должна иметь права на чтение/вставку/изменение/удаление записей таблиц и создание объектов БД (для возможности автоматических миграций).

### Шаг 1. Предварительная настройка машины

После установки выбранной ОС на машине Оркестратора необходимо выполнить её предварительную настройку. Следуйте инструкциям: 

1. **Windows 2016 Server** - см. раздел [Предварительная настройка машины Оркестратора под Windows 2016 Server](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/windows/presetting-orch-machine).
2. **Linux** - см. раздел [Предварительная настройка машины Оркестратора под CentOS 8](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/linux/presetting-orch-machine).

Либо одноименные руководства в формате \*.docx из комплекта поставки.

### Шаг 2. Установка БД

После настройки машины Оркестратора переходим к установке базы данных:
* PostgreSQL (+pgbouncer);
* или MS SQL SERVER.

//Инструкции????

### Шаг 3. Установка RabbitMQ 

Если компонент RabbitMQ был установлен ранее, требуется удалить все очереди.  (??)

Если не был установлен, то.... (??)

Может быть установлен для соединения по SSL. См. в комплекте поставки «Руководство по настройке работы сервисов оркестратора с RabbitMQ через SSL.docx».

### Шаг 4. Установка WebApi и MachineInfo

Если не используется сервис MachineInfo, необходима первоначальная настройка БД. Это требует разрешения выполнения в БД команд shell ОС. В настоящей версии Оркестратора рекомендуется использовать сервис MachineInfo.

Включает шифрование паролей в конфигурационных файлах.  

При установке на Linux chmod назначить в соответствии с «Руководством по предварительной настройке машины Оркестратора под CentOS 8.docx» (входит в комплект поставки).

### Шаг 5. Установка Notifications

:small_blue_diamond: ***Примечание.** Изначально можно пропустить этот шаг и вернуться к нему позже.*

Включает шифрование паролей в конфигурационных файлах. При установке на Linux chmod назначить в соответствии с «Руководством по предварительной настройке машины Оркестратора под CentOS 8.docx» (входит в комплект поставки).

### Шаг 6. Установка NuGet 

:small_blue_diamond: ***Примечание.** Изначально можно пропустить этот шаг и вернуться к нему позже.*

Включает шифрование паролей в конфигурационных файлах. При установке на Linux chmod назначить в соответствии с «Руководством по предварительной настройке машины Оркестратора под CentOS 8.docx» (входит в комплект поставки).


### Шаг 7. Установка States 

:small_blue_diamond: ***Примечание.** Изначально можно пропустить этот шаг и вернуться к нему позже.*

Включает шифрование паролей в конфигурационных файлах. При установке на Linux chmod назначить в соответствии с «Руководством по предварительной настройке машины Оркестратора под CentOS 8.docx» (входит в комплект поставки).


### Шаг 8. Установка RDP2   

Включает шифрование паролей в конфигурационных файлах. При установке на Linux chmod назначить в соответствии с «Руководством по предварительной настройке машины Оркестратора под CentOS 8.docx» (входит в комплект поставки).

Может быть установлен на сервере Оркестратора либо на отдельном сервере. **Не следует устанавливать RDP2 на машине робота!**

### Шаг 9. Установка RobotLogs 

Включает шифрование паролей в конфигурационных файлах. При установке на Linux chmod назначить в соответствии с «Руководством по предварительной настройке машины Оркестратора под CentOS 8.docx» (входит в комплект поставки).

### Шаг 10. Установка Front 

-  (???)

### Рекомендации

Изначально можно пропустить шаги 5–7 и выполнить установку этих компонентов позже. Другие шаги не могут быть пропущены.

Установка LogEventsWebhook может быть произведена позже, когда будет разработан и развернут интеграционный шлюз Заказчика (см. [Интеграция с внешними системами](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/integration)). 


### Пример установки за 8 шагов
Видео по установке Оркестратора на Windows Server 2019 с WebApi (IIS) можно просмотреть [здесь](https://www.youtube.com/watch?v=IAIRmChw65k&ab_channel=PrimoRPA). 

<a href="https://www.youtube.com/watch?v=IAIRmChw65k"><img src="https://raw.githubusercontent.com/PrimoRPA/Docs.Rus/main/.gitbook/assets/video_preview/test_gif.gif" width="850" title="hover text"></a>

## Установка Робота
После установки Оркестратора можно переходить к установке Робота. 

Последовательно выполните шаги из таблицы.

| Шаг                                              | Примечание     |
| ------------------------------------------------ | -------------- |
| 1. Настройка машины Робота                       | 1. См. [Настройка машины Робота под Windows 2016 Server](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/windows/robotmachine) <p>2. См. [Настройка машины Робота под CentOS 8](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/linux/robotmachine) </p> |  
| 2. Установка Agent на машине Робота              | 1. См. [Установка Агента Оркестратора из инсталлятора под Windows 2016 Server](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/windows/agentinstaller) или [Установка Агента без инсталлятора под Windows 2016 Server](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/windows/appendix). <p> 2. См. [Установка Агента Оркестратора под CentOS 8](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/linux/agentinstall) </p> |  


### Условия для корретной работы

1. **Под Windows**. Используйте на машине Робота одну учетную запись для службы Агента Оркестратора. Она нужна, чтобы Агент смог проделать предварительную работу по запуску Робота и создать задачу в Windows, которая запустит Робота.
2. **Под Linux**. Требуется одна учетная запись для функционирования Агента Оркестратора.




