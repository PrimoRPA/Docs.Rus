# Настройка очереди проектов

## Очередь на основе RabbitMQ

По умолчанию используется очередь проектов на основе RabbitMQ (рекомендуемый вариант). Такая очередь работает по принципу:
1.	Для выполнения проекта Оркестратор ставит проект в очередь.
2.	При выходе проекта из очереди Оркестратор ищет свободного подходящего робота:
    * **если находит** – робот запускается с проектом;
    * **если не находит** – проект отправляется в одну из очередей ожидания в зависимости от своего [приоритета](https://docs.primo-rpa.ru/primo-rpa/orchestrator/basics#dobavlenie-rpa-proekta) (1 – 3). По истечении времени ожидания (несколько секунд) проект выходит из очереди ожидания и снова отправляется в очередь проектов (п.1).

Таким образом, очередь представляет циклический буфер, который по мере добавления в очередь новых проектов и при отсутствии роботов будет увеличиваться.

Настройка времени задержки в очереди ожидания осуществляется в секции RabbitMQ:

![](<../../../.gitbook/assets/config-project-queue-1.png>)  

Чем выше эти значения, тем дольше проект будет находиться в очереди ожидания, и тем выше вероятность, что пока проект будет там находиться, другой проект успеет занять освободившегося робота, изменив, возможно, ожидаемый порядок выполнения проектов.

Чем меньше эти значения, тем выше нагрузка на систему – будет происходить постоянный поиск подходящего робота, хотя это, возможно, заведомо не нужно для таких временных промежутков, если проекты выполняются достаточно долго.


## Очередь с гарантированным порядком запуска проектов

Описанное выше поведение очереди можно изменить на очередь проектов с гарантированным порядком запуска проектов. В этом случае проектам должны быть назначены приоритеты в секции RobotStart: 

![](<../../../.gitbook/assets/config-project-queue-2.png>)       

Таким образом, сначала будут обрабатываться все элементы в очереди, которые **уже не получили** свободных роботов. И только потом новые элементы. 

Параметры:
* **BatchSize** - количество новых элементов, обрабатываемых за одну итерацию опроса очереди.
* **ThreadSleep** - время (мсек) между итерациями опроса.
