# Email входящей почты

Email входящей почты используется в [заданиях](https://docs.primo-rpa.ru/primo-rpa/orchestrator/basics/tasks) с триггером «Запуск при получении Email». При настройке триггера можно использовать базовый либо дополнительный адрес:
* Базовый email задается [в настройках тенанта](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/tenants) в конфигурационном файле (системным администратором).
* Дополнительные почтовые ящики возможно указать в UI в разделе **Настройки > Email входящей почты**. Права доступа есть только у администратора. 

## Как добавить дополнительный адрес

Чтобы добавить дополнительный email, перейдите в раздел **Настройки > Email входящей почты**. 

Нажмите кнопку **Добавить Email**:

![](<../../.gitbook/assets/email-tab.png>)

Откроется форма:

![](<../../.gitbook/assets/add-email-form-1-part.png>)

Поле **Логин** заполняется только в том случае, если email и логин для аутентификации в почте не совпадают.

Далее выберите почтовый протокол:
* POP3 (по умолчанию);
* IMAP;
* MS Exchange - доступен с версии 23.11.

#### POP3

Почтовый протокол POP3 не хранит письма на сервере, а загружает их на определенное устройство: компьютер, ноутбук или смартфон. После чего удаляет электронную почту с сервера. Таким образом, письма на сервере не остаются, и если вдруг письмо по ошибке будет удалено с устройства, скачать его заново не получится. При этом перенесенные письма можно посмотреть в любой момент без доступа к интернету.

Если вы выбрали протокол POP3, потребуется также заполнить поля:
* **Pop3** - сервер входящей почты. Например, `pop.yandex.ru`.
* **Pop3 Port** - номер порта, который использует сервер входящей почты. Например, `995`. Большинство серверов используют порт 110 для получения незашифрованных писем или порт 995 - для зашифрованных.

#### IMAP

Почтовый протокол IMAP не удаляет письма с сервера, а продолжает их хранить. Таким образом, письма можно прочитать с любого устройства, подключенного к интернету. 

Если вы выбрали протокол IMAP, потребуется указать имя сервера Imap и номер его порта. Большинство серверов используют порт 143, который позволяет получать незашифрованные письма, или порт 993 - для безопасного подключения к электронной почте. 

#### MS Exchange

Протокол MS Exchange необходим для подключения к серверам Microsoft Exchange, а также позволяет использовать зашифрованные веб-соединения по порту 443/TCP для защиты данных. 

Если вы выбрали MS Exchange, следом отобразится поле **EWSUrl** - укажите в нем адрес сервера входящей почты.

#### Переключатели

![](<../../.gitbook/assets/add-email-form-2-part.png>)

* **Require Authenticate** - определяет, требуется ли аутентификация.
* **Use Ssl** - определяет, используется ли шифрование с помощью SSL/TLS/STARTTLS.
* **Use standart not SSL Port** - определяет, используется ли [стандартный порт](https://github.com/jstedfast/MailKit/blob/master/FAQ.md#ssl-handshake-exception) без шифрования. По умолчанию используется - флаг **UseSsl** при этом игнорируется.
* **Удалять полученные письма** - определяет, будут ли удаляться письма после получения. По умолчанию не удаляются. В случае IMAP, если письма не удаляются, то они помечаются как прочитанные.

В завершение нажмите **Сохранить**, чтобы добавить email входящей почты. 

Результат: при добавлении задания с триггером по email, ваш дополнительный адрес отобразится среди значений списка Email:

![](<../../.gitbook/assets/email-task-add-email-2.png>)





