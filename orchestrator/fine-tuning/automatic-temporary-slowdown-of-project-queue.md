# Автоматическое временное замедление очереди проектов при пиках нагрузки на машинах роботов 

Для снижения/устранения риска отказа в обслуживании при запуске робота на машине робота с проектом, который вышел из очереди проектов, по причине перегруженности машины роботов, можно использовать автоматическое замедление очереди проектов – проект продолжит ждать в очереди проектов, пока нагрузка на машине робота не спадет до приемлемой.

Описание параметров, влияющих на автоматическое временное замедление очереди проектов при пиках нагрузки на машинах роботов (секции Worker и ProjectQueue), приведено в таблицах 22 и 23


ТАБЛИЦА – Параметры сбора метрик производительности с машин роботов (секция Worker)

1. **CollectBackgroundPerformance** - собирать метрики производительности машин в фоне, одновременно с проверкой их доступности. Если включена, может использоваться автоматическое временное замедление очереди проектов при пиках нагрузки на машинах роботов. Только для CollectWorkerStatusService = 1
2. **PerformanceDeltaPrcnt** - шаг разбиения шкалы 0 - 100 на интервалы, например, (0, 25, 50, 75, 100).
3. **PerformanceDelta100Prcnt** - величина (абсолютное значение процента), на которую метрики должны отличаться от 100%, чтобы был зафиксирован факт перегрузки машины.


ТАБЛИЦА 2 - Параметры автоматического временного замедления очереди проектов при пиках нагрузки на машинах роботов (секция ProjectQueue)

1. **WorkerPerformanceHighDuration** - продолжительность (сек) нахождения метрик машины робота в диапазоне высокой нагрузки, при которой проект должен снова уйти в очередь проектов. Если равно 0 – замедление очереди не используется. Если равно 0, метрики производительности с машин роботов все равно собираются, если этот сбор включен.
2. **WorkerPerformanceHighCPUOnly** - для принятия решения о том, что машина робота перегружена, использовать только CPU%. 
3. **WorkerPerformanceHighResolver** - тип определения высокой нагрузки:
   * 0 – Фиксированное значение, например, 95%. Не связано с Worker.PerformanceDeltaPrcnt.
   * 1 – 100% – Worker.PerformanceDeltaPrcnt

Если шкала разбивается на большие интервалы (см. таблица 20, №п/п 2) или не кратные 100, то попадание нагрузки в последний интервал может быть грубой оценкой или не оправдано завышенной. Тогда можно эту оценку указать явно в AbsoluteWorkerPerformanceHigh и использовать тип 1.

4. **AbsoluteWorkerPerformanceHigh** - абсолютное значение нагрузки, которое считается высоким. Только для WorkerPerformanceHighResolver = 0. 


