# Инструкции по разметке изображений

## Перед началом работы
*Ознакомьтесь с [рекомендациями по разметке данных](https://github.com/PrimoRPA/Docs.Rus/blob/1299-%D0%BD%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D1%82%D1%8C-%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82-%D0%BF%D0%BE-primoai/primo-ai/other/dataset-quality-requirements.md).*


## Описание рабочей области

Разметка изображения производится на странице **Разметка данных**. На ней вы увидите следующую рабочую область.

![](<../../../../.gitbook/assets1/primo-ai/user-guide/labeling-workspace.png>)

#### 1. Панель инструментов

Сверху расположена панель инструментов для работы с изображением. Слева направо:
* **Select (v)** — позволяет выбрать размеченное поле. В настоящее время не используется.
* **Drag/Pan (right or middle click) (d)** — позволяет перетащить изображение в пределах рабочей области.
* **Zoom In/Out (scroll)  (z)** — позволяет увеличить или уменьшить масштаб изображения в рабочей области. Также масштаб возможно изменить колесиком мыши.
* **Add Bounding Box (b)** — описывающий прямоугольник. Основной инструмент для разметки данных, используется для обозначения местоположения и размера объекта на изображении. Bounding box должен минимально охватывать объект на изображении.
* **Fit to screen (f)** — расположить изображение по размеру экрана.
* **Rotate image (r)** — повернуть повернуть изображение. 

#### 2. Функциональный блок для работы со схемой разметки
В данном блоке возможно:
* Выбрать схему разметки, если вы ее создали заранее
* Создать схему разметки, если в проекте нет ни одной схемы
* Добавить в схему новые поля

#### 3. Функциональный блок для работы с регионами

Регион представляет собой сохраненную размеченную область. Новый регион появляется после того, как:
1. Вы выбрали поле в схеме разметки.
2. Инструментом **Add Bounding Box (b)** выделили область с данными, которая относится к этому полю.
3. Выбрали датасет и нажали **Сохранить разметку**.



#### 4. Функциональный блок для работы с датасетами

В каждом проекте существует 2 датасета, созданных автоматически:
* Обучение — на этом наборе данных модель будет тренироваться. Поместите в этот датасет 90% размеченных изображений.
* Тестовый — на этом наборе данных модель будет проверять свои способности между этапами обучения. Поместите в этот датасет 10% размеченных изображений.

#### 5. Галерея изображений проекта

В галерее отображаются все изображения, которые вы загрузили в проект. После того, как вы закончили разметку одного изображения, кликните по другой миниатюре, чтобы переключиться между изображениями. При необходимости добавить новое изображение, нажмите `+`. 


## Как разметить изображения

### Создайте схему разметки

:large_orange_diamond:***Важно**. Если схема уже создана, просто выберите ее в списке значений*.

В функциональном блоке **Схема** разверните список значений и, если он пуст, нажмите кнопку **Создать схему**. Схема определяет, какие поля должна находить нейронная сеть в изображениях. 

![](<../../../../.gitbook/assets1/primo-ai/classifier-5.png>)

Укажите произвольное название\* схемы и нажмите **Сохранить**. 

> \**Название может состоять только из букв и цифр, дефиса, подчеркивания и точки.*

### Добавьте поля в схему разметки
:large_orange_diamond:***Важно**. Пропустите данный шаг, если схема уже создана, и все необходимые поля добавлены*.

Добавьте в схему поля, соответствующие типу документа: 
* нажмите кнопку **Добавить поле**, назовите\* поле passport, сохраните изменения;
* нажмите кнопку **Добавить поле**, назовите поле snils, сохраните изменения;
* нажмите кнопку **Добавить поле**, назовите поле torg-12, сохраните изменения.

![](<../../../../.gitbook/assets1/primo-ai/classifier-6.png>)

> \**Поля могут называться иначе, но должны передавать взаимосвязь с типом документа*.

### Соотнесите поля с изображениями

В панели справа выберите тип поля в соответствии с текущим изображением документа. Например, если вы начали работу с изображением документа Торг-12, то в панели справа тоже выберите поле torg-12.

![](<../../../../.gitbook/assets1/primo-ai/classifier-7-new.png>)

В верхней панели выберите инструмент **Add Bounding Box (b)**.

![](<../../../../.gitbook/assets1/primo-ai/classifier-bounding-box.png>)

Выделите инструментом **Add Bounding Box (b)** значимую часть документа — область с данными. На рисунке ниже область с данными отображается пунктирной линией.

![](<../../../../.gitbook/assets1/primo-ai/classifier-9.png>)

Справа, в блоке «Датасет», выберите тип датасета «Обучение» и нажмите кнопку **Сохранить разметку**.

![](<../../../../.gitbook/assets1/primo-ai/classifier-9-2.png>)

Перейдите к следующему изображению вашей галереи:
* сначала выберите тип поля в соответствии с документом на изображении. Например, если следующее изображение относится к паспорту, то выберите поле passport (1);
* инструментом **Add Bounding Box (b)** выделите значимую часть документа на изображении;
* сохраните разметку изображения в датасете «Обучение» (2 и 3). 

![](<../../../../.gitbook/assets1/primo-ai/classifier-labeling-other-docs.png>)
  
Завершите разметку оставшихся изображений проекта. Добавляя изображение в датасет, не забывайте каждый раз сохранять разметку.

### Разделите датасеты

Оставьте примерно 10-20% изображений для тестового датасета. Соотнесите каждое изображение с правильным полем, выделите область с данными инструментом **Add Bounding Box (b)**, но при сохранении разметки изображения укажите датасет «Тестовый».

Изображения, добавленные в тестовый датасет, будут помечены зеленым цветом в вашей галерее.

![](<../../../../.gitbook/assets1/primo-ai/classifier-test-dataset.png>)


### Проверьте качество разметки

После окончания разметки изображений проверьте еще раз соответствие документов выбранным полям. Ошибка негативно повлияет на качество распознавания документов моделью-классификатором.


## Удалить разметку
