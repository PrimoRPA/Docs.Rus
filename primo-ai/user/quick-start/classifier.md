# Работа с классификатором документов

В данном разделе вы узнаете, как работать со встроенным проектом «Классификатор». Проект предназначен для работы с моделью классификации документов или, иначе, *моделью-классификатором*. Данная модель будет полезна, если пользователь хранит у себя смешанные изображения документов и хочет автоматически распределить их по типам перед тем, как перейти к распознаванию данных в едином типе документов. 

## Ожидаемый результат 
Обученная модель должна уметь определять 3 типа документов: 
* паспорт;
* СНИЛС;
* Торг-12.


## Стадии работы 
1. В веб-интерфейсе Primo RPA AI Server можно выполнить следующие действия:
   * Обучить модель-классификатор.
   * Настроить и запустить процесс инференса на целевой машине.
     * Создайте шаблон процесса инференса.
     * Перейдите в шаблон и создайте процесс инференса.
     * Запустите процесс инференса на целевой машине.
2. В приложении Primo RPA Studio необходимо разработать RPA-проект для продолжения работы по классификации документов обученной моделью.
     * Настройте RPA-проект, в рамках которого вы хотите распознавать реальные типы документов классификатором.
     * Запустите выполнение RPA-проекта и получите результат классификации документов.


## Обучение модели-классификатора
Общий порядок действий:
1. Перейдите в проект «Классификатор».
1. Добавьте в проект изображения для формирования датасета, на котором будет обучаться нейронная сеть.
1. Разметьте добавленные изображения:
   * *создайте схему разметки;*
   * *добавьте в схему поля, соответствующие типу документа;*
   * *соотнесите поля с изображениями;*
   * *добавьте 90% размеченных изображений в обучающий датасет.*
   * *добавьте 10% размеченных изображений в тестовый датасет.*
1. Создайте шаблон обучения для модели-классификатора.
1. Перейдите в шаблон и создайте процесс обучения.
1. Запустите процесс обучения на целевой машине.
1. Дождитесь окончания процесса обучения, чтобы получить обученную модель.

### Шаг 1 — Переходим в проект

Перейдите в раздел проектом «Классификатор».

![](<../../../.gitbook/assets1/primo-ai/classifier-1.png>)

### Шаг 2 — Добавляем изображения

***Примечание**. Ознакомьтесь с [требованиями к изображениям для обучения](https://github.com/PrimoRPA/Docs.Rus/blob/1299-%D0%BD%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D1%82%D1%8C-%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82-%D0%BF%D0%BE-primoai/primo-ai/user/other/dataset-quality-requirements.md). Помните, что требуется добавить минимум 20 изображений одного типа документа.*

1. Перейдите в подраздел проекта «Данные».
2. Нажмите кнопку **Добавить изображения**.

   ![](<../../../.gitbook/assets1/primo-ai/classifier-2-new.png>)
 
3. Выберите со своего диска все изображения, которые вы хотите добавить. 
4. Нажмите **Сохранить**, чтобы изображения добавились в проект.

Загруженные изображения отобразятся в таблице данных проекта.

![](<../../../.gitbook/assets1/primo-ai/classifier-3.png>)

### Шаг 3 — Размечаем изображения

#### Перед началом работы
*Ознакомьтесь с [рекомендациями по разметке данных](https://github.com/PrimoRPA/Docs.Rus/blob/1299-%D0%BD%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D1%82%D1%8C-%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82-%D0%BF%D0%BE-primoai/primo-ai/user/other/datalabeling-requirements.md).*

#### 3.1. Создайте схему разметки
Перейдите в подраздел проекта «Разметка данных».

![](<../../../.gitbook/assets1/primo-ai/classifier-4.png>)

В панели справа, в блоке **Схема**, разверните список значений и нажмите кнопку **Создать схему**. Схема определяет, какие поля должна находить нейронная сеть в изображениях. 

![](<../../../.gitbook/assets1/primo-ai/classifier-5.png>)

Укажите произвольное название\* схемы и нажмите **Сохранить**. 

> \**Название может состоять только из букв и цифр, дефиса, подчеркивания и точки.*

#### 3.2. Добавьте поля в схему разметки
Добавьте в схему поля, соответствующие типу документа: 
* нажмите кнопку **Добавить поле**, назовите\* поле passport, сохраните изменения;
* нажмите кнопку **Добавить поле**, назовите поле snils, сохраните изменения;
* нажмите кнопку **Добавить поле**, назовите поле torg-12, сохраните изменения.

![](<../../../.gitbook/assets1/primo-ai/classifier-6.png>)

> \**Поля могут называться иначе, но должны передавать взаимосвязь с типом документа*.

#### 3.3. Соотнесите поля с изображениями
* *Колесиком прокрутки можно увеличивать и уменьшать масштаб изображения в рабочей области.*
* *Если изображение необходимо повернуть, используйте инструмент **Rotate image (r)**.*

В панели справа выберите тип поля в соответствии с текущим изображением документа. 

Например, если вы начали работу с изображением документа Торг-12, то в панели справа тоже выберите поле torg-12.

![](<../../../.gitbook/assets1/primo-ai/classifier-7-new.png>)

В верхней панели выберите в верхней панели инструмент **Add Bounding Box (b)**.

![](<../../../.gitbook/assets1/primo-ai/classifier-8.png>)

Выделите инструментом **Add Bounding Box (b)** значимую часть документа — область с данными. На рисунке ниже область с данными отображается пунктирной линией.

![](<../../../.gitbook/assets1/primo-ai/classifier-9.png>)

Справа, в блоке «Датасет», выберите тип датасета «Обучение» и нажмите кнопку **Сохранить разметку**.

![](<../../../.gitbook/assets1/primo-ai/classifier-9-2.png>)

Перейдите к следующему изображению:
* выберите тип поля в соответствии с документом на изображении. Например, если следующее изображение относится к паспорту, то выберите поле passport;
* инструментом **Add Bounding Box (b)** выделите значимую часть документа;
* сохраните разметку изображения в датасете «Обучение». 

![](<../../../.gitbook/assets1/primo-ai/classifier-10.png>)
  
Завершите разметку оставшихся изображений проекта. Добавляя изображение в датасет, не забывайте каждый раз сохранять разметку.

Оставьте примерно 10-20% изображений для тестового датасета.

#### 3.4. Разделите датасеты

Оставьте примерно 10-20% изображений для тестового датасета. Изображения из тестового датасета помечаются внизу рабочей области зеленой галочкой.

#### 3.5. Проверьте качество разметки

После окончания разметки изображений рекомендуется проверить качество разметки. Проверьте еще раз соответствие документов выбранным полям. Эта ошибка может негативно повлиять на качество распознавания модели классификатора.


### Шаг 4 — Создаем шаблон обучения

1. Перейдите в подраздел проекта «Обучение» на вкладку «Шаблоны обучения».
1. Нажмите кнопку **Добавить шаблон обучения**.
1. Заполните форму:
   * Укажите название шаблона.
   * Выберите тип «Классификатор».
   * В качествве шаблона модели выберите ....?
   * Выберите скрипт (?? не нужно же)
   * При необходимости укажите краткое описание модели, которое позволит идентифицировать шаблон среди других.
   * Оставшиеся параметры рекомендуется оставить без изменений. Исключение составляет параметр **Искусственно расширить датасет** — в нем выберите значение «повороты + экспозиция + шум».
1. Сохраните шаблон обучения.


### Шаг 5 — Создаем процесс обучения

1. Перейдите в подраздел проекта «Обучение» на вкладку «Шаблоны обучения».
1. Выберите для шаблона «Классификатор» действие «Процессы».
1. Нажмите кнопку **Добавить процесс обучения**.
1. В форме добавления процесса укажите:
   * Целевую машину, на которой будет проводиться обучение модели классификатора;
   * Датасет «Обучение», на котором будет тренироваться модель.
1. Сохраните настройки, чтобы процесс добавился в систему.

### Шаг 6 — Запускаем процесс обучения

1. Перейдите в подраздел проекта «Обучение» на вкладку «Шаблоны обучения».
1. Выберите для шаблона «Классификатор» действие «Процессы».
1. Для созданного процесса обучения выберите действие «Запустить».

![](<../../../.gitbook/assets1/.png>)

### Шаг 7 — Проверяем наличие обученной модели

1. Убедитесь, что обучение модели завершено успешно.
1. Перейдите в подраздел проекта «Модели» — в таблице отобразится имя вашей обученной модели.


## Настройка и запуск процесса инференса




## Работа с RPA-проектом






