# Требования для подготовки датасета изображений для обучения нейросетки (детектирование полей в отсканированных документах)


#### Введение
Для успешной тренировки нейросети, предназначенной для детектирования полей в отсканированных документах, необходимо подготовить качественный и разнообразный датасет. В этом документе изложены требования и рекомендации для подготовки такого датасета.

#### 1. Общие Требования

1. **Разнообразие документов**:
    - Включите документы с различными форматами и макетами, чтобы охватить все возможные варианты, которые будут поступать в систему на этапе инференса - темные, светлые, остканированные, сфотографированные, преобразованные из векторных форматов и пр.
Убедитесь, что датасет отражает реальные сценарии использования (тени, шумы, изгибы бумаги, если таковые встречаются).

2. **Разрешение и качество изображений**:
    - Разрешение изображений должно быть достаточным для четкого распознавания полей (рекомендуется не менее 100 DPI).
    - Избегайте изображений с низким качеством, размытостью или сильными артефактами.

3. **Размер датасета**:
    - Минимум - несколько десятков изображений для документов определенного формата (вида). Большее количество позволит обучить модель с лучшими обобщающими способностями.  
Так например, если у вас есть счета от разных клиентов, которые несколько отличаются по формату (со штрих-кодом и без, с логотипом поставщика и без логотипа и т.д.), то надо подготовить образцы минимум по несколько десятков штук каждого вида.


#### 2. Разметка Данных

1. **Правильно определите Типы полей для разметки** (важно при инференсе):
    - Текстовые поля (string)
    - Поля с датами (date)
    - Поля с численными данными (numeric)

2. **Определите максимальное количество строк в полях данных**  (важно при инференсе)
    В накладных Торг-12 Поставщик, Плательщик обычно имеют 2 строки данных (string), а номер документа и его дата - 1 строку.
В теле таблицы обычно до 5-ти строк информации в столбце "Товар" и одна строка в численных столбцах.

3. **Определите язык распознавания**  (важно при инференсе)
    - rus
    - eng
    - rus+eng
Чем уже выбор, тем надежнее сработает OCR. Не надо указывать 'rus+eng', если текст предполагается только на русском.

4. **Консистентность разметки**:
    - Разметка должна быть выполнена одинаковым образом для всех изображений.

**Качество разметки данных важнее размера датасета!**

#### 3. Дополнительные Условия

1. **Аугментация данных**:
    - Применяйте аугментации для увеличения разнообразия датасета: повороты, изменение яркости и контрастности, добавление шума. Размер датасета может быть искусственно увеличен в 5 раз.
Однако это пропорционально увеличит время обучения.
Если у вас GPU - всегда используйте аугментацию данных.


2. **Баланс классов**:
    - Обеспечьте равномерное распределение различных типов полей по всему датасету.
    - Избегайте перекоса в сторону какого-либо одного типа поля.
Например, в накладной встречаются документы с отсутствующим полем "Основание" - постарайтесь обеспечить несколько десятков таких образцов, однако они не должны быть доминирующими по количеству.

#### 4. Проверка и Валидация Датасета

1. **Качество разметки**:
    - Проведите проверку качества разметки на выборке изображений.
    - Исправьте любые ошибки и неточности в разметке.

2. **Разделение на тренировочный и тестовый наборы**:
    - Разделите датасет на тренировочный (90%) и тестовый (10%) наборы.
    - Убедитесь, что тестовый набор включает разнообразные типы форматов и полей.


#### Заключение

Подготовка качественного датасета — это ключевой шаг для успешного обучения нейросети. Следуя данным требованиям, вы сможете создать датасет, который обеспечит эффективное обучение модели для детектирования полей в отсканированных документах.

Если у вас возникли вопросы или требуется дополнительная информация, пожалуйста, свяжитесь с разработчиками проекта Primo.AI.
