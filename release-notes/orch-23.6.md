# Обновления в версии Оркестратора 23.6

Примечания к выпуску Оркестратора 23.6 описывают изменения для версии приложения, выпущенной в июне 2023 года.

### Новые функции
1. Добавлена возможность деактивировать просроченные/невалидные лицензии. Функция доступна администратору Оркестратора в разделе **Настройки > Лицензии** при выборе соответствующей лицензии. Деактивация позволяет избавиться от избыточных записей в журнале, связанных с проверкой лицензий на просроченность/валидность (+ UI). Деактивированную лицензию впоследствии можно вновь сделать активной. 
1. В форму развертывания дистрибутива Робота, в том числе массового, добавлена настройка **Интервал**. Параметр определяет интервал передачи Роботом своего состояния в Оркестратор (запрос KeepAlive). Увеличение интервала может пригодиться для больших проектов, где нет необходимости часто отправлять состояние Робота в Оркестратор. Значение указывается в миллисекундах. 
1. В форму редактирования пользователя добавлена настройка **Требовать смену пароля при следующем входе в систему**. Если параметр включен, то смена пароля станет обязательным условием. Управление настройкой доступно администратору (в т.ч. тенанта) в разделе **Настройки > Пользователи**.
1. Добавлена возможность множественного выделения элементов очереди для последующего клонирования или удаления.
1. Стало невозможным удаление очереди обмена данными, если она используется в триггерах. 
1. В форму публикации NuGet-пакетов (**Настройки > NuGet**) добавлена возможность копировать команды, предназначенные для публикации пакетов без Оркестратора. 
1. Добавлен вывод типа ОС для Робота с возможностью фильтрации по нему. - на странице "Все роботы" не вижу ОС и фильтра. https://89.208.85.131:44392/administration/robots
1. Оптимизирована логика процессов, связанных с:
   * запуском триггеров;
   * ограничением для потока событий триггеров.
   * извлечением элементов из очереди данных по FIFO;
   * приемом и обработкой состояний роботов

Оптимизации:

1. Оптимизация мягкого останова. https://dev.azure.com/primorpa/Primo/_workitems/edit/2498 и на стороне робота - https://dev.azure.com/primorpa/Primo/_workitems/edit/2503
1. Оптимизирован запуск триггеров.  https://dev.azure.com/primorpa/Primo/_workitems/edit/2499
1. Оптимизировано извлечение из очереди данных по FIFO. https://dev.azure.com/primorpa/Primo/_workitems/edit/2500 
1. Оптимизация: ограничение для потока событий триггеров. https://dev.azure.com/primorpa/Primo/_workitems/edit/2501
1. Оптимизация приема и обработки состояний роботов. https://dev.azure.com/primorpa/Primo/_workitems/edit/2537
1. Оптимизация занятия и освобождения лицензий - ?
1. Оптимизация освобождения RDP-сессий - ?
1. Оптимизация обработки события старта и завершения проекта роботом - ?
1. Оптимизация актуализации активных пользователей - ?
1. Оптимизация соединений/каналов с раббит - баг: Раббит не создает каналы в WebApi при старте https://dev.azure.com/primorpa/Primo/_workitems/edit/2064 - оно?
1. Оптимизация подсчета запущенных роботов. Добавлен подсчет количества процессов роботов на Агенте - (2497) в чем суть, раньше неправильно считалось? (почему в поле "Макс. кол-во работающих роботов" можно устанавливать отриц значения?)

### Исправленные ошибки
1. Исправлена ошибка, в результате которой при поиске подходящего Робота возникали блокировки в БД: улучшена логика синхронизации параллельных алгоритмов.  - (Изменение блокировок БД , теперь есть только 1 алгоритм самый оптимальный  LockFreeWithCache) + UseLocalLock. - ошибка была: забивался пул соединений БД и БД переставала отвечать на запросы, докировки и тд. )
1. Исправлена ошибка, в результате которой невозможно было разблокировать Робота, если на машине Робота было превышено максимальное количество Роботов.
1. Исправлена некорректная сортировка элементов в очереди обмена данными при отображении в UI. Теперь новые элементы всегда попадают в конец очереди.
1. Исправлена ошибка с удалением используемого в очереди проектов задания.
1. При изменении пагинации (со `100/стр.` на иное значение) в разделе **Очереди обмена данными** таблица становилась пустой. Ошибка исправлена.
1. Исправлена ошибка с подсчетом лицензий на главной странице (**Обзор**): из подсчета исключены отозванные лицензии.
1. Баг: Не отображаются статусы на странице робот у очереди - родитель: https://dev.azure.com/primorpa/Primo/_workitems/edit/2367, дочерняя https://dev.azure.com/primorpa/Primo/_workitems/edit/2368 - В разделе **Роботы > Очереди обмена данными** в колонке **Кол-во роботов** -> Таблица Роботы очереди поправить вывод статусов в колонках Статус развертывания, Статус по аналогии как это сделано в таблице Роботов (там есть те же колонки и статусы). 
1. "Исправление бага со слетающими блокировками" - это о чем, какая задача?
1. Бесконечный счетчик попыток разлогирования отключенного RDP-пользователя - что за счетчик, где. https://dev.azure.com/primorpa/Primo/_workitems/edit/2395
1. баг: При попадании проекта в очередь на выполнение, запуск проекта не происходит https://dev.azure.com/primorpa/Primo/_workitems/edit/2538 - нужно? "Предположительно дело в автоматической очистке таблицы RpaProjectsQueue. Проекты, находящиеся в очереди на момент очистки таблицы, остаются в очереди и не извлекаются из нее." - дело в этом? как поправили?
1. баг: Робот перестает запускаться при добавлении новой версии к проекту и назначении её активной https://dev.azure.com/primorpa/Primo/_workitems/edit/2260 (у Пономарева если что спросить)

