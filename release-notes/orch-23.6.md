# Обновления в версии Оркестратора 23.6

Примечания к выпуску Оркестратора 23.6 описывают изменения для версии приложения, выпущенной в июне 2023 года.

### Новые функции
1. В форму развертывания дистрибутива Робота, в том числе массового, добавлена настройка **Интервал**. Параметр определяет интервал передачи Роботом своего состояния в Оркестратор (запрос KeepAlive). значение указывается в миллисекундах. 
(упомянуть про конфиг в доке - связка)
Улучшение UI: Возможность настраивать AliveInterval для Робота. Я как пользователь системы Хочу видеть поле AliveInterval в форме массового развертывания роботов Чтобы более удобно иметь возможность конфигурировать развертывание. (задача https://dev.azure.com/primorpa/Primo/_workitems/edit/2517. Почему у этой задачи есть подзадача https://dev.azure.com/primorpa/Primo/_workitems/edit/2518, почему не в ней самой решение?)
Он определяет интервал отправки запросов KeepAlive (состояние Робота) к Оркестратору. Увеличение интервала отправки запроса может пригодиться для больших проектов, где нет необходимости слишком часто отправлять состояние Робота в Оркестратор.

### Исправленные ошибки
1. Исправлена ошибка сортировки элементов при отображении в очереди обмена данными. Теперь новые элементы всегда попадают в конец очереди.
1. Баг: Не отображаются статусы на странице робот у очереди - родитель: https://dev.azure.com/primorpa/Primo/_workitems/edit/2367, дочерняя https://dev.azure.com/primorpa/Primo/_workitems/edit/2368 - В разделе **Роботы > Очереди обмена данными** в колонке **Кол-во роботов** -> Таблица Роботы очереди поправить вывод статусов в колонках Статус развертывания, Статус по аналогии как это сделано в таблице Роботов (там есть те же колонки и статусы). 
1. Исправлена ошибка отображения таблицы в разделе **Очереди обмена данными**: при изменении значения пагинации (со `100/стр.` на иное) таблица становилась пустой. https://dev.azure.com/primorpa/Primo/_workitems/edit/2273 - добавлять?


## УТОЧНИТЬ - ФИЧИ:

1. В разделе **Настройки > Лицензии** добавлена возможность деактивировать просроченные/невалидные лицензии (по какой кнопке?). Также добавлена фильтрация лицензий по двум условиям: отозванные и/или деактивированные. (?) "Возможность деактивировать просроченные/невалидные лицензии, аналог логического удаления".  - это откуда?
1. "Добавлен запрет на удаление очереди обмена данными, если она используется в триггерах". - в интерфейсе выскочит ошибка с текстом?
1. Изменение блокировок БД при поиске подходящего робота, возможность менять алгоритмы (Legacy, LockFree, LockFreeWithCache) + UseLocalLock. - это откуда и что именно значит?
1. Добавлен вывод типа ОС для робота с возможностью фильтрации по нему - на странице "Все роботы" не вижу ОС и фильтра. https://89.208.85.131:44392/administration/robots
1. Выделение несколько элементов очереди для клонирования или удаления - (1213) 
1. Обход смены пароля - (2008) 
1. Улучшение UI: Добавлена валидация значения параметра **Cron-строка расписания опроса очереди или интервал опроса** при создании задания по триггеру **Запуск при наличии новых элементов в очереди обмена данными**. Теперь система проверяет наличие значения в одном из двух полей (cron-строка или интервал), при его отсутствии выводит ошибку. - почему пропускает невалидное значение скрон-строки и отрицательные значения в интервале и кол-ве элементов очереди? https://dev.azure.com/primorpa/Primo/_workitems/edit/2493
1. В разделе настроек **NuGet** (UI) в форму публикации NuGet-пакетов добавлена возможность копировать команды, предназначенные для публикации пакетов без Оркестратора. (Почему названо url, это же 2 команды?)


Нет подробной информации - блок задач "Критические оптимизации для Камаза и ГПН":
1. Оптимизация мягкого останова. https://dev.azure.com/primorpa/Primo/_workitems/edit/2498 и на стороне робота - https://dev.azure.com/primorpa/Primo/_workitems/edit/2503
1. Оптимизирован запуск триггеров.  https://dev.azure.com/primorpa/Primo/_workitems/edit/2499
1. Оптимизировано извлечение из очереди данных по FIFO. https://dev.azure.com/primorpa/Primo/_workitems/edit/2500 
1. Оптимизация: ограничение для потока событий триггеров. https://dev.azure.com/primorpa/Primo/_workitems/edit/2501
1. Оптимизация приема и обработки состояний роботов. Включая вычисление занятых/свободных лицензий. https://dev.azure.com/primorpa/Primo/_workitems/edit/2537

Другое:
1. Оптимизация занятия и освобождения лицензий - ?
1. Оптимизация освобождения RDP-сессий - ?
1. Оптимизация обработки события старта и завершения проекта роботом - ?
1. Оптимизация актуализации активных пользователей - ?
1. Оптимизация соединений/каналов с раббит - ?
1. Оптимизация подсчета запущенных роботов. Добавлен подсчет количества процессов роботов на Агенте - (2497) 


## УТОЧНИТЬ - ОШИБКИ:
1. "Исправлена ошибка с подсчетом лицензий на главной. Из подсчета исключены отозванные лицензии" - имеется в виду страница **Обзор**? Спросить про подсчет энтерпрайз и десктоп лицензий из скринов.
1. "Исправлена ошибка с неразблокированием найденного робота при превышении максимального количества роботов на машине робота". - какой номер задачи? как происходит разблокировка робота, вручную по кнопке "разблокировать"? а блокировка? Исправлена ошибка, в результате которой невозможно было разблокировать робота, если на машине Робота было превышено максимальное количество роботов.
"Исправление бага со слетающими блокировками" - это о чем, какая задача?
1. Бесконечный счетчик попыток отключенного разлогирования RDP-пользователя - что за счетчик, где. https://dev.azure.com/primorpa/Primo/_workitems/edit/2395
1. баг: При попадании проекта в очередь на выполнение, запуск проекта не происходит https://dev.azure.com/primorpa/Primo/_workitems/edit/2538 - нужно? "Предположительно дело в автоматической очистке таблицы RpaProjectsQueue. Проекты, находящиеся в очереди на момент очистки таблицы, остаются в очереди и не извлекаются из нее." - дело в этом? как поправили?
1. Исправлен баг с удалением используемого в очереди проектов задания
1. Исправление oшибки конкурентного доступа в StartRobotCommandBusService
1. AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Unexpected end of request content - поправили какую-то ошибку в каком-то http запросе? подробнее.



**Отсутствуют в редми, но есть в задачах спринта**: 

Ни ссылки на sd, ни развернутых комментов тестировщиков, ни скринов, ничего. 

1. Сгладить нагрузку от очереди проектов на пиках - это про что, где-то что-то добавилось для пользователя? Ему нужно что-то конфигурировать?
https://dev.azure.com/primorpa/Primo/_workitems/edit/2400 (а в это задаче нет подзадачи, например)
1. баг: Робот не запускается по триггеру на изменение папки на машине робота https://dev.azure.com/primorpa/Primo/_workitems/edit/2262 - почему не пишем?
1. был ли вообще баг? Робот перестает запускаться при добавлении новой версии к проекту и назначении её активной https://dev.azure.com/primorpa/Primo/_workitems/edit/2260
1. баг: Раббит не создает каналы в WebApi при старте https://dev.azure.com/primorpa/Primo/_workitems/edit/2064 - нужно?


## для себя (не в релизе):
1. баг: Отрицательные значения полей "Запуск в ограниченном кол-ве экземпляров" и "Задержка освобождения RDP-сессии (мсек)" при редактировании проекта  (=была возможность указывать отриц значения? Только при редакт-ии или при добавлении проекта тоже?) https://dev.azure.com/primorpa/Primo/_workitems/edit/2292 
1. Все роботы - колонка статус - (это статус выполнения проекта Роботом, верно?) какие статусы есть? "Недоступен" - это говорит о чем? "Ожидает"? "Стартует" - включает в себя все стадии запуска робота из приложения 2, сами стадии отображаются только в логах? 
