# Primo Studio 23.6
Примечания к выпуску Студии 23.6 описывают изменения для версии приложения, выпущенной в июне 2023 года.

## Новые функции 
1. У элемента [**Добавить в очередь**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_queues/addtoqueue) появилось опциональное свойство **Приоритет**. Оно определяет порядок сортировки элементов для извлечения из очереди. Высшим приоритетом является `0`.
1. У элемента [**Клик OCR-текста мышью**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_ocr/el_ocr_textclick) появилось опциональное свойство **Индекс**, в котором задается указатель найденной строки. Индекс помогает быстрее определить нужный текст в ситуации, когда сразу несколько строк подходят под условие поиска.
1.  У элемента **Получить из очереди по ID** появилось опциональное свойство **Занимать**. аналог свойства из получить по фильтру. По умолчанию выключено.
1. 1592 - Добавлено свойство **Строгий таймаут** (Strict timeout) для элементов, работающих с UI и SAP. Фича (строгий таймаут) - экспериментальная. Содержание фичи в том, что старые таймауты нестрогие в том смысле, что в некоторых случаях могут выполняться намного дольше заданного значения (проверка на истечение таймаута выполняется только между обращениями к другим процессам, из-за чего реальное время выполнения элемента может многократно превосходить заданный таймаут). Строгий таймаут должен прерывать выполнение строго по истечении заданного срока. Примерная формулировка для подсказки: "прерывать выполнение, не дожидаясь завершения обхода дерева". Строгое соблюдение тайм-аута. Поведение для старых (созданных ранее) процессов: строгий таймаут по-умолчанию выключен. Поведение для новых элементов в процессе: по-умолчанию включен.
Зачем сделано: перестанет робот зависать... из-за таймаутов. раньше элемент выполнялся дольше заданного таймаута. сейчас прерывается. когда робот выполняет поиск селектора из др приложения, они ждут... и порой долго ждут. и старая реализация была такова, что ожидание старый таймаут не прерывал. робот мог ждать и неск минут, пока др приложение ответит. строг таймаут гарантирует что сверх установленного времени ожидания не будет. фича по умолч выключена. если не понимает клиент зачем она нужна, то пока пусть не используют.
Миша: есть дерево контроллов у окна, пока робот их все не обойдет, робот не испокаивался, несмотря на таймаут. 

Важно: у присутствия элемента, если таймаут вышел строгий, ошибки не будет. уточнить, что это значит: робот просто идет дальше?



1. 2314, 1110 - Get Text возвращает unnamed в ПО TWR (не определяются селектора в ПО TWR ITC). Элемент **Получить текст**. Если в по TWR применить активность Get Text, то она возвращает значение unnamed. Нужен аналог Get visible text или чтоб получать данные как с изображения, ну или что-то докрутить в этой активности. У клиентов, которые пытаются автоматизировать старое ПО (где основа написана в 2000х годах - банковское ПО, например), наш робот не мог оттуда достать простой текст. Только OCR-элементами. Мы усилили Получить текст. когда мы используем режим "нэйтив" (он похож на режим гет визибл текст в ЮП), он выдирает из рендер-системы Виндовс текст. Режим стал мощнее и лучше распознает текст. Чтобы хорошо работало со старыми приложениями, появилась доп настройка "Цель" (ее надо использовать с нэйтив), у нее 2 значения: 1)GDI ; 2)посмотреть в студии - они взламывают старые прилаги, которые не поддерживают UI автомэйшн. Если 1 не работает, сработает второй. Это помогает автоматизировать старый софт! Если работает дефотный режим, лучше тогда его и юзать. Также, если выбран дефолтный режим, настройка "Цель игнорируется". 
 + появилось свойство вывода "Блоки текста" - только для режимов нэйтив и нэйтив фулл. Его нужно исп-ть вместо обычной переменной (строковой), когда нужно дальше с этим выводом что-то делать в этом процессе, например, искать координаты конкретного слова (координаты пока есть только если цель GDI). структура в которой есть текст, экранные координаты X Y, ширина-высота. Разбивает она текст слабо предсказуемо: иногда по словам, иногда по предложениям, иногда по кнопкам. Выдает инфу по сгруппированным блокам (которые заранее сложно предсказать). Опираясь на этот вывод разраб может в процессе зачитать 2-ю графу или сделать из него потом клик мышью, используя координаты. (спросить у тестера, плохо понятно). 
Важно! Для того, чтобы эта активность сработала, требуется, чтобы искомый текст (и контрол? плохо слышно) был на экране. Т.е. окно не должно перекрываться. 
Приоритеты: дефолт_нэйтив (с целью) - если ничего не работает, то тогда OCR (уточнить у Самсонова, какой именно элемент работает с экранном).




1. В русскоязычном интерфейсе Студии стал работать поиск элемента по имени класса. Имя класса можно просмотреть в свойствах элемента (пример: `WFAttachExcel`). Улучшение призвано облегчить работу RPA-разработчика при смене языка интерфейсов. (Проверить в 23.6: по имени класса ищет и в рус и в англ интерфейсе? Подумать, где в доках можно указать возможность поиска по классам.)
1. Добавлен аргумент `aliveinterval`, использующийся при запуске Робота из командной строки. Он определяет интервал отправки запросов KeepAlive от Робота к Оркестратору (сбор состояний Роботов). Фактически управление новым аргументом осуществляется только через Оркестратор и не подходит для ручных запусков. Увеличение интервала отправки запроса может пригодиться для больших проектов, где нет необходимости слишком часто отправлять состояние Робота в Оркестратор.
1. В соответствии с новым дизайном обновлены иконки Студии и Робота. Внешние различия иконок позволяют быстрее ориентироваться между приложениями. 



## Исправленные ошибки
1. 1996 - При попытке открыть Excel-файл с надстройкой SAP Analysis for Microsoft Office возникала ошибка `Excel instance not found`. Описание способа устранения ошибки добавлено в раздел [Приложение Excel](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_excel/el_excel_app#загрузка-надстроек).
1. В процессе с типом **Диаграмма** добавление элемента в контейнер **Последовательность** приводило к зависанию Студии при выполнении процесса. Ошибка исправлена, добавление элемента и последующее выполнение происходят корректно.
1. В диаграмме был недоступен переход к найденному элементу из окна Поиска (Ctrl + F). Ошибка исправлена. 
1. Исправлена ошибка, которая возникала при попытке cкопировать/вырезать элемент из последовательности и затем использовать его множественную вставку.
1. Из класса [QueueItem](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_queues/datatypes) (элемент очереди Оркестратора) удален параметр RetryCount. Параметр содержал техническую информацию, поэтому его удаление не влияет на практику использования класса.
1.  2320 https://dev.azure.com/primorpa/Primo/_sprints/backlog/Studio%20Team/Primo/23.6/23.6%20(Sprint%202)?workitem=2320 - подвисала студия при попытке открытия несуществующего проекта. те. проект был уже когда-то открыт, он добавляется в список ранее открытых проектов, потом кто-то его с диска удалили - при попытке открыть этот проект студия зависала.
1.   1481 - Студия не разворачивается при паузе на "точке останова" (при отладке процесса). Когда запускаем процесс, Студия должна свернуться, когда до точки останова доходит - должна развернуться и показать, где остановилась.
1.   1512 - [import] Невозможность импортировать процесс с UIpath на Primo на новой версии Студии. Ошибка эдлокфилд. 
1.   1517 - Debug mode. Проблема с работой в отладке в онли код. отладка работала неправильно: были недоступны кнопки След.шаг и Возобновить выполнение. Исправлено. (ошибки по брейкпонтам: миша против того, что брейкпойнты работали при закрытых процессах. так что это минус). но войдут в релиз другие подзадачи: (3-е видео)
1. 1603 - При попытке записи зависает универсальный рекордер и вешает Студию. были проблемы с универсальным рекордером - он зависал. (ЗАпись - Универсальная запись).

