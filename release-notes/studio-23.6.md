# Primo Studio 23.6
Примечания к выпуску Студии 23.6 описывают изменения для версии приложения, выпущенной в июне 2023 года.

## Новые функции 
1. У элемента [**Получить текст (UI)**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_uiinteraction/el_gettext) появились свойства:
   * **Цель** - помогает лучше распознавать текст в старых ПО, которые не поддерживают UI Automation. Ранее, чтобы получить текст из таких приложений, требовалось использовать OCR-элементы. Работает только с режимом Native или Native Full, для режима Default игнорируется. По умолчанию для цели установлено значение GDI, однако если это не приводит к нужному результату, возможно изменить цель на USP10.
   * **Блоки текста** - переменная вывода, которая сохраняет полученные данные в виде сгруппированных блоков текста. Это опциональное свойство, которое является альтернативой строковой переменной вывода и работает только с режимом Native или Native Full. Свойство помогает извлекать текстовые данные из форм/таблиц десктопных приложений. Рекомендуется применять в случае, когда с полученным текстом нужно продолжить работу: например, найти координаты нужного слова, чтобы выполнить клик мышью. 
1. У элемента [**Добавить в очередь**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_queues/addtoqueue) появилось опциональное свойство **Приоритет**. Оно определяет порядок сортировки элементов для извлечения из очереди. Высшим приоритетом является `0`.
1. Для элемента [**Получить из очереди по ID**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_queues/peekqueueid) добавлено опциональное свойство **Занимать**. Параметр определяет, нужно ли возвращать в ответе только те элементы очереди, которые можно сразу же изъять для обработки Роботом. По умолчанию параметр выключен.
1. У элемента [**Клик OCR-текста мышью**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_ocr/el_ocr_textclick) появилось опциональное свойство **Индекс** - в нем задается указатель найденной строки. Индекс помогает быстрее определить нужный текст в ситуации, когда сразу несколько строк подходят под условие поиска.
1. Для элементов, работающих с UI и SAP, добавлено свойство **Строгий таймаут** (Strict timeout). На данный момент он введен в тестовом режиме, поэтому рекомендуется использовать его с осторожностью. Параметр определяет необходимость строго следовать установленному таймауту: по его истечении выполнение элемента будет прервано сразу. По умолчанию свойство выключено - Робот может продолжать выполнение еще какое-то время, сверх установленного лимита, для полного обхода дерева контролов. 
1. В русскоязычном интерфейсе Студии стал работать поиск элемента по имени класса. Имя класса можно просмотреть в свойствах элемента (пример: **WFAttachExcel**). Улучшение призвано облегчить работу RPA-разработчика при смене языка интерфейсов. 
1. Добавлен аргумент `aliveinterval`, использующийся при запуске Робота из командной строки. Он определяет интервал отправки запросов KeepAlive (состояние Робота) к Оркестратору. Фактически управление аргументом `aliveinterval` осуществляется только через Оркестратор и не подходит для ручных запусков. Увеличение интервала отправки запроса может пригодиться для больших проектов, где нет необходимости слишком часто отправлять состояние Робота в Оркестратор.
1. В соответствии с новым дизайном обновлены иконки Студии и Робота. Внешние различия иконок позволяют быстрее ориентироваться между приложениями.  

## Исправленные ошибки
1. При попытке открыть Excel-файл с надстройкой SAP Analysis for Microsoft Office возникала ошибка `Excel instance not found`. Описание способа по устранению ошибки в загрузке этой и похожих надстроек добавлено в раздел [Приложение Excel](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_excel/el_excel_app#загрузка-надстроек).
1. Невозможно было получить повторный элемент очереди со статусом New через соответствующие компоненты Студии (например, **Получить из очереди**). Ошибка исправлена, повторные элементы обрабатываются Роботом.
1. В процессе с типом **Диаграмма** добавление элемента в контейнер **Последовательность** приводило к зависанию Студии при выполнении процесса. Ошибка исправлена, добавление элемента и последующее выполнение происходят корректно.
1. В диаграмме был недоступен переход к найденному элементу из окна Поиска (Ctrl + F). Ошибка исправлена. 
1. Исправлена ошибка, которая возникала при попытке cкопировать/вырезать элемент из последовательности и затем использовать его множественную вставку.
1. Из класса [QueueItem](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_queues/datatypes) (элемент очереди Оркестратора) удален параметр RetryCount. Параметр содержал техническую информацию, поэтому его удаление не влияет на практику использования класса.
1. При отладке процесса не разворачивалось окно Студии на паузе в **точке останова**. Это мешало понять, что отладка приостановлена. Ошибка исправлена, окно Студии вновь разворачивается (при соответствующей настройке отладчика).
1. Включение универсальной записи приводило к зависанию Студии. Ошибка исправлена.
1. Элемент **Эмуляция спецкнопки** не эмулировал нажатие комбинации из трех клавиш при включенном параметре **Новое ядро**. Ошибка исправлена, при указании в свойствах трех кнопок эмуляция нажатия производится корректно.
1. При отмене действия (Ctrl+Z), связанного с изменением переменных/аргументов, возникала ошибка и последующее зависание Студии. В частности, если команда использовалась при работе с элементом **Множественное присвоение**. Ошибка исправлена. Удаление/добавление присвоений откатить невозможно.
1. Исправлена ошибка импорта: она возникала на проектах, которые в предыдущих версиях Студии импортировались успешно. Корректный импорт процессов восстановлен.
1. При попытке открыть удаленный (несуществующий) проект из истории недавних открытий (меню **Файл > Проект > Недавние**) происходило зависание Студии. Ошибка исправлена, работа Студии не нарушается. При этом пользователю выводится сообщение о том, что указан некорректный путь к проекту.
1. Не работало расширение браузера Google Chrome в ситуации, когда файл `ext.chrome` (C:\Users\user_name\AppData\Local\Primo.Exchange\ext.chrome) оказывался пустым или имеел нечитаемые данные. С этой версии в случае подобной проблемы файл `ext.chrome` будет пересоздан с настройками по умолчанию при запуске/отладке процесса.
1. При отладке процесса с типом **Только код** (Only code), в котором есть точки останова, возникала ошибка: были неактивны кнопки **Сделать шаг** и **Возобновить процесс**. Ошибка исправлена для обеих версий ядра Робота.

