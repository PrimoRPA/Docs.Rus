# Primo Studio 23.6
Примечания к выпуску Студии 23.6 описывают изменения для версии приложения, выпущенной в июне 2023 года.

## Новые функции 
1. У элемента [**Добавить в очередь**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_queues/addtoqueue) появилось опциональное свойство **Приоритет**. Оно определяет порядок сортировки элементов для извлечения из очереди. Высшим приоритетом является `0`.
1. У элемента [**Клик OCR-текста мышью**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_ocr/el_ocr_textclick) появилось опциональное свойство **Индекс**, в котором задается указатель найденной строки. Индекс помогает быстрее определить нужный текст в ситуации, когда сразу несколько строк подходят под условие поиска.
1. Добавлено опциональное свойство **Занимать** для элемента [**Получить из очереди по ID**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_queues/peekqueueid). Параметр определяет, нужно ли возвращать в ответе только те значения, которые можно сразу занять - изъять из очереди, чтобы с ними начал работу ваш Робот. По умолчанию параметр выключен.
1. 1592 - Добавлено свойство **Строгий таймаут** (Strict timeout) для элементов, работающих с UI и SAP. Фича (строгий таймаут) - экспериментальная. Содержание фичи в том, что старые таймауты нестрогие в том смысле, что в некоторых случаях могут выполняться намного дольше заданного значения (проверка на истечение таймаута выполняется только между обращениями к другим процессам, из-за чего реальное время выполнения элемента может многократно превосходить заданный таймаут). Строгий таймаут должен прерывать выполнение строго по истечении заданного срока. Примерная формулировка для подсказки: "прерывать выполнение, не дожидаясь завершения обхода дерева". Строгое соблюдение тайм-аута. Поведение для старых (созданных ранее) процессов: строгий таймаут по-умолчанию выключен. Поведение для новых элементов в процессе: по-умолчанию включен.
Зачем сделано: перестанет робот зависать... из-за таймаутов. раньше элемент выполнялся дольше заданного таймаута. сейчас прерывается. когда робот выполняет поиск селектора из др приложения, они ждут... и порой долго ждут. и старая реализация была такова, что ожидание старый таймаут не прерывал. робот мог ждать и неск минут, пока др приложение ответит. строг таймаут гарантирует что сверх установленного времени ожидания не будет. фича по умолч выключена. если не понимает клиент зачем она нужна, то пока пусть не используют.
Миша: есть дерево контроллов у окна, пока робот их все не обойдет, робот не испокаивался, несмотря на таймаут. 

Важно: у присутствия элемента, если таймаут вышел строгий, ошибки не будет. уточнить, что это значит: робот просто идет дальше?



1. 2314, 1110 - Get Text возвращает unnamed в ПО TWR (не определяются селектора в ПО TWR ITC). Элемент **Получить текст**. Если в по TWR применить активность Get Text, то она возвращает значение unnamed. Нужен аналог Get visible text или чтоб получать данные как с изображения, ну или что-то докрутить в этой активности. У клиентов, которые пытаются автоматизировать старое ПО (где основа написана в 2000х годах - банковское ПО, например), наш робот не мог оттуда достать простой текст. Только OCR-элементами. Мы усилили Получить текст. когда мы используем режим "нэйтив" (он похож на режим гет визибл текст в ЮП), он выдирает из рендер-системы Виндовс текст. Режим стал мощнее и лучше распознает текст. Чтобы хорошо работало со старыми приложениями, появилась доп настройка "Цель" (ее надо использовать с нэйтив), у нее 2 значения: 1)GDI ; 2)посмотреть в студии - они взламывают старые прилаги, которые не поддерживают UI автомэйшн. Если 1 не работает, сработает второй. Это помогает автоматизировать старый софт! Если работает дефотный режим, лучше тогда его и юзать. Также, если выбран дефолтный режим, настройка "Цель игнорируется". 
 + появилось свойство вывода "Блоки текста" - только для режимов нэйтив и нэйтив фулл. Его нужно исп-ть вместо обычной переменной (строковой), когда нужно дальше с этим выводом что-то делать в этом процессе, например, искать координаты конкретного слова (координаты пока есть только если цель GDI). структура в которой есть текст, экранные координаты X Y, ширина-высота. Разбивает она текст слабо предсказуемо: иногда по словам, иногда по предложениям, иногда по кнопкам. Выдает инфу по сгруппированным блокам (которые заранее сложно предсказать). Опираясь на этот вывод разраб может в процессе зачитать 2-ю графу или сделать из него потом клик мышью, используя координаты. (спросить у тестера, плохо понятно). 
Важно! Для того, чтобы эта активность сработала, требуется, чтобы искомый текст (и контрол? плохо слышно) был на экране. Т.е. окно не должно перекрываться. 
Приоритеты: дефолт_нэйтив (с целью) - если ничего не работает, то тогда OCR (уточнить у Самсонова, какой именно элемент работает с экранном).



1. В русскоязычном интерфейсе Студии стал работать поиск элемента по имени класса. Имя класса можно просмотреть в свойствах элемента (пример: `WFAttachExcel`). Улучшение призвано облегчить работу RPA-разработчика при смене языка интерфейсов. (Проверить в 23.6: по имени класса ищет и в рус и в англ интерфейсе? Подумать, где в доках можно указать возможность поиска по классам.)
1. Добавлен аргумент `aliveinterval`, использующийся при запуске Робота из командной строки. Он определяет интервал отправки запросов KeepAlive от Робота к Оркестратору (сбор состояний Роботов). Фактически управление новым аргументом осуществляется только через Оркестратор и не подходит для ручных запусков. Увеличение интервала отправки запроса может пригодиться для больших проектов, где нет необходимости слишком часто отправлять состояние Робота в Оркестратор.
1. В соответствии с новым дизайном обновлены иконки Студии и Робота. Внешние различия иконок позволяют быстрее ориентироваться между приложениями. 


## Исправленные ошибки
1. 1996 - При попытке открыть Excel-файл с надстройкой SAP Analysis for Microsoft Office возникала ошибка `Excel instance not found`. Описание способа устранения ошибки добавлено в раздел [Приложение Excel](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_excel/el_excel_app#загрузка-надстроек).
1. Невозможно было получить повторный элемент очереди со статусом New через соответствующие компоненты Студии (например, **Получить из очереди**). Ошибка исправлена, повторные элементы обрабатываются Роботом.
1. В процессе с типом **Диаграмма** добавление элемента в контейнер **Последовательность** приводило к зависанию Студии при выполнении процесса. Ошибка исправлена, добавление элемента и последующее выполнение происходят корректно.
1. В диаграмме был недоступен переход к найденному элементу из окна Поиска (Ctrl + F). Ошибка исправлена. 
1. Исправлена ошибка, которая возникала при попытке cкопировать/вырезать элемент из последовательности и затем использовать его множественную вставку.
1. Из класса [QueueItem](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_queues/datatypes) (элемент очереди Оркестратора) удален параметр RetryCount. Параметр содержал техническую информацию, поэтому его удаление не влияет на практику использования класса.
1. При отладке процесса не разворачивалось окно Студии на паузе в **точке останова**. Это мешало понять, что отладка приостановлена. Ошибка исправлена, окно Студии вновь разворачивается (при соответствующей настройке отладчика).
1. Включение универсальной записи приводило к зависанию Студии. Ошибка исправлена.
1. Элемент **Эмуляция спецкнопки** не эмулировал нажатие комбинации из трех клавиш при включенном параметре **Новое ядро**. Ошибка исправлена, при указании в свойствах трех кнопок эмуляция нажатия производится корректно.
1. При отмене действия (Ctrl+Z), связанного с изменением переменных/аргументов, возникала ошибка и последующее зависание Студии. В частности, если команда использовалась при работе с элементом **Множественное присвоение**. Ошибка исправлена. Удаление/добавление присвоений откатить невозможно.
1. Исправлена ошибка импорта: она возникала на проектах, которые в предыдущих версиях Студии импортировались успешно. Корректный импорт процессов восстановлен.
1. При попытке открыть удаленный (несуществующий) проект из истории недавних открытий (меню **Файл > Проект > Недавние**) происходило зависание Студии. Ошибка исправлена, работа Студии не нарушается. При этом пользователю выводится сообщение о том, что указан некорректный путь к проекту.
1. Не работало расширение браузера Google Chrome в ситуации, когда файл `ext.chrome` (C:\Users\user_name\AppData\Local\Primo.Exchange\ext.chrome) оказывался пустым или имеел нечитаемые данные. С этой версии в случае подобной проблемы файл `ext.chrome` будет пересоздан с настройками по умолчанию при запуске/отладке процесса.
1. При отладке процесса с типом **Только код** (Only code), в котором есть точки останова, возникала ошибка: были неактивны кнопки **Сделать шаг** и **Возобновить процесс**. Ошибка исправлена для обеих версий ядра Робота.

