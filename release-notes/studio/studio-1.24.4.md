# Primo Studio 1.24.4

История изменений в Primo Studio для Windows за апрель 2024-го года.

## Обновления и улучшения (режим Pro)

1. Расширены возможности возможности работы с **JSON**. Теперь поддерживается автоматическая десериализация не только в **Dictionary**, но и в различные типы коллекций, включая **List<T>**.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7413 (Уточнить у разработки)

1. Улучшена работа с множеством окон в SAP: обеспечена возможность выбора элементов и взаимодействия в нескольких окнах одновременно, упрощая параллельную работу с разными транзакциями.
   
 https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/13293

2. Улучшена работа селекторов при взаимодействии с Java-элементами через плагин **Java_ext**, обеспечивающего точное формирование селекторов как с применением, так и без использования свойства "**Text**"

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7635

3. Добавлена функциональность в **Pick branch** , позволяющая задать действие по умолчанию для ситуаций, когда не срабатывает ни один из условных ветвей Pick branch.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/3706

4. В элементе **Filter Range (Excel)** добавлена возможность фильтрации по нескольким критериям одновременно, что улучшает гибкость работы с данными Excel.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/10375

5. Добавлена функция подсветки для элементов "Ссылка на процесс" при добавлении аргументов. Теперь, когда пользователь вносит изменения в аргументы подпроцесса на таких элементах, активируется подсветка, указывающая на изменения. Эта подсветка исчезает после того, как произведено редактирование и назначение переменных.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/130

6. Улучшена функция поиска Ctrl+F, теперь результаты поиска включают как русскоязычные наименования активностей, так и их технические обозначения.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/165

7. Улучшена работа с определением селекторов на кнопках десктоп-приложений **TWR ITC**. Инструмент теперь осуществляет надежный поиск элементов в иерархии, также улучшено восстановление исходного форматирования текста
  
https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/3437

8. Улучшена работа элементов типа **Событие** (OCR, Рабочий стол, Файлы). Внесенные изменения позволяют корректно выполнять автоматизацию.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7797

9. Добавлена функциональность сниппетов **Snippets**  (короткие, часто используемые фрагменты кода), позволяющая удобно интегрировать их в существующие проекты без создания новых процессов. Сниппеты переносятся в рабочую область как активности, упрощая процесс разработки.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/406

10. Добавлена функция **Удаление писем**. Элемент используется для удаления почтовых сообщений по протоколу **IMAP**

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/968

11. Добавлена функция, позволяющая пользователям просматривать структуру проекта. Обновление структуры теперь можно включать или выключать из меню Настройки

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/17423

12. Оптимизирована работа с диаграммами. В блоке Decision добавлена функциональность, которая требует наличия условий хотя бы в двух или более ветках диаграммы. Если условия отсутствуют, система выведет сообщение, напоминая о необходимости их задать.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7423

## Исправленные ошибки (режим Pro)

1. Исправлены ошибки в работе контекстного меню элементов:
   * для элементов ошибочно отображалась команда **Извлечь элементы из try/catch**;
   * при выборе команды **Раскомментировать элементы** из последовательности могла пропасть область для добавления элементов или возникнуть ошибка «Ссылка на объект не указывает на экземпляр объекта»;
   * при повторном выборе команды **Раскомментировать элементы** или отмене действия возникала ошибка «Адресат вызова создал исключение». 

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/8515

2. Устранена причина, по которой при попытке открыть большие ltw-файлы Студия аварийно завершала работу.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/11248

3. Исправлена ошибка в новом редакторе шаблона поиска. Ранее, если пользователь выбирал элемент подменю (`F5`) и нажимал кнопку **Строить путь до выбранного элемента от корневого элемента**, то редактор шаблона закрывался, а селектор не был сформирован. Теперь при выборе **Строить путь до...** предпринимается попытка построить путь, а в случае, когда это невозможно, кнопка **Строить путь до..** переходит в неактивное состояние, что позволяет избежать закрытия редактора шаблона.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/15554

4. Исправлена проблема, при которой элементы переставали определяться визардом после использования функции "Строить путь до выбранного элемента...". Теперь визард обеспечивает более стабильное и точное взаимодействие с элементами

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/9122

5. Исправлена ошибка, из-за которой при открытии студии не отображалась история ранее открытых проектов. Теперь при запуске Студии без открытия проекта корректно отображается история проектов.
   
https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/4067

6. Внесены изменения в работе элемента **Mouse text click** Проблема с превышением времени ожидания из-за неисправности метода DesktopInst.GetText() была устранена путем внедрения проверки strict time-out и исправления указанного метода.
   
https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7442

7. Внесены изменения в работе элемента Mouse text click, ранее наблюдалось превышение времени ожидания из-за неисправности метода DesktopInst.GetText() и было устранено путем внедрения проверки strict time-out и исправления указанного метода.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/1085

8. Исправлена ошибка в браузерных селекторах, теперь подстановочный знак "*" корректно работает в поле **Text**. В редакторе шаблонов улучшена работа текстовых полей, добавлены вертикальная и горизонтальная полосы прокрутки для удобства работы с длинными текстами.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7696

9. Исправлена ошибка, при которой робот зависал в процессе отладки при переходе по шагам в подпроцесс с ошибкой и последующем возобновлении отладки. Теперь отладка корректно продолжается до конца, как при шаге в подпроцесс с ошибкой, так и при последующем возобновлении процесса отладки.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/13691

10. Внедрены изменения в систему **undo-redo**, улучшающие обработку действий и целостность элементов в диаграммах. Ранее в диаграммах наблюдались проблемы с некорректной отменой действий и разрывами связей между элементами.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/13780

11. Оптимизирована работа элемента **Прочитать таблицу**, обеспечивающая точное считывание сложных HTML-таблиц и корректное считывание данных при работе с мастером.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7409

12. Устранена ошибка при работе с функцией "Ввод текста", ранее  когда элемент определялся по индексу, опция очистки поля после ввода текста не функционировала должным образом.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/9285

13. Исправлена ошибка поиска выбранного элемента при некорректном значении индекса. Ранее при использовании некорректного индекса для выбора элемента система ошибочно выполняла его поиск и валидацию, что могло привести к его неверному выбору и нарушению работы.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/8540

14. Исправлена ошибка в функции **Keep last opened tabs**. Теперь вкладки процессов после перезапуска Студии восстанавливаются точно в том порядке, в котором они были открыты до закрытия/перезапуска.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/46

15. Исправлена ошибка долгой валидации после выбора десктопного элемента. Теперь дерево контролов строится только по запросу, ускоряя выбор элементов. Также устранено подвисание малой формы при переключении на вкладку **Структура**.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/17303

## Режим Citizen

1. Исправлена ошибка в работе элемента **Фильтр таблицы** (LTools.Data.Elements.DataTables.Citizen.WFCFilterDataTable) в Studio **Citizen**, возникавшая при смене условий фильтрации с **И** на **ИЛИ**. Теперь активность функционирует корректно, без прерывания работы из-за ошибок.
   
https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/11256

2. Исправлена ошибка перетаскивания элемента. Теперь элементы последовательности при перетаскивании перемещаются по рабочему пространству синхронно с курсором мыши.

https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7670



## Где найти
[Скачать дистрибутив Primo RPA Studio Enterprise](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FStudio%2FWindows).

[Скачать дистрибутив Primo RPA Robot](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FRobot%2FWindows):
* **Primo RPA Robot 1.24.4** — предназначен для установки на локальной рабочей станции. Выступает в роли цифрового ассистента пользователя. Дистрибутив поставляется в разрядности x64 и x86.
* **Primo RPA Robot Orchestrator 1.24.4** — предназначен для автоматической установки Оркестратором. Дистрибутив поставляется в разрядности x64 и x86.
