# Primo Studio 23.9
Раздел содержит описание изменений для версии приложения Primo Studio 23.9, выпущенной в сентябре 2023 года.

### Новые функции и улучшения

1. Добавлена проверка версии Студии при авторизации в Оркестраторе. Если версия меньше допустимой, то авторизация завершится ошибкой. Ограничение на минимально допустимую версию Студии, а также тип поведения при ошибке настраивается в конфигурационном файле Оркестратора.

1. В контейнере [**Приложение Excel**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_excel/el_excel_app) появилось свойство **«Открывать только на чтение»**. Оно работает только с драйвером Interop и определяет, нужно ли открывать файл в режиме «Только для чтения». По умолчанию свойство отключено. Функциональность помогает считывать данные из файла, который был заблокирован для редактирования.

   ![](<../../.gitbook/assets/excel-only-read.png>)   

1. Добавлен новый тип ресурса Оркестратора - **JObject**. Он хранит данные в формате JSON. Студия позволяет работать с ресурсом такого типа через элементы [**Получить значение**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_assets/el_orch_getvalue) и [**Установить значение**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_assets/el_orch_setvalue). Например, если в Оркестраторе был создан ресурс с типом JObject, то при помощи элемента **Получить значение** робот сможет получить данный ресурс и сохранить его в переменную свойства **Результат**. Студия автоматически распознает тип полученного ресурса.

1. В модели [**QueueItem**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_queues/datatypes) - элемент очереди Оркестратора - появилось свойство **RetryCount**. Оно содержит информацию о количестве повторов элемента в очереди. Извлеченный элемент может быть добавлен в очередь повторно в ответ на возникновение ошибки (статусы Error/Business Error). Допустимость повторов определяется настройкой очереди Оркестратора.

1. Улучшен инструмент публикации проекта в Оркестраторе из Студии. Теперь при публикации новой версии проекта рабочий файл будет сопоставляться с существующим проектом в Оркестраторе. При найденном совпадении Студия предложит его для выбора, указав на нужную запись в окне проектов. Это позволит избежать ситуации, когда новую версию проекта можно по ошибке загрузить в неподходящий проект.

   ![](<../../.gitbook/assets/export-project-to-orch.png>)

1. Стал поддерживаться Selenium WebDriver актуальной версии. Улучшение призвано повысить эффективность работы с шаблонами поиска для веб-приложений.

1. Улучшен импорт SAP-элементов из UIPath-проектов:
   * **Read Status Bar** > конвертируется в контейнер **Присоединиться к SAP** с вложенным элементом [**Строка состояния**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_sap/el_statusbar) (SAP). Контейнер добавляется только в том случае, если элемент импортируется без него. 
   * **Type into** > конвертируется в элемент [**Ввод текста**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_uiinteraction/el_inputtext) (Работа с UI) с заданными свойствами и режимом SIMULATE.
   * **Сall transaction** > конвертируется в контейнер **Присоединиться к SAP** с вложенным элементом [**Ввод текста**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_sap/el_sap_input) (SAP). Ранее не конвертировался. Контейнер добавляется только в том случае, когда импортируется элемент без него. 

1. В элементе [**Комментарий**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_dialogs/el_dialogs_comment) стал доступен ввод текста с переводом строки. 

   ![](<../../.gitbook/assets/comment-element-lines-much.png>)

1. В окне [Поиска](https://docs.primo-rpa.ru/primo-rpa/primo-studio/projects/search) (Ctrl+F) стало сохраняться последнее значение, введенное в поисковой строке.

   ![](<../../.gitbook/assets/recently-value-in-find-line.png>)

### Улучшения в Robot Runner

Клиентский робот (attended) теперь поддерживает работу с ресурсами Оркестратора. 

### Исправленные ошибки 
1. Оптимизировано время открытия проектов в Студии.
1. При попытке открыть другой проект терялись изменения в текущем файле. Студия открывала новый проект сразу, не спрашивая пользователя, нужно ли ему сохранить изменения в текущем. Это приводило к потере данных. С этой версии пользователю будет отображаться модальное окно с соответствующим вопросом.
1. Исправлена проверка синтаксиса в проектах, где удаляли зависимость. Некорректно работал индикатор ошибок: он отображался на элементах, не связанных с отсутствующей зависимостью.
1. Исправлена работа элементов из группы «События». Ранее, если в процессе последовательно использовалось несколько событий, то выполнение второго завершалось с ошибкой. Проблема устранена.
1. Исправлена ошибка в работе элемента [Чтение почты](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_outlook/el_outlook_readmail) (Outlook). При чтении папки, в которой находилось письмо с неподдерживаемым типом сообщения, возникала ошибка «Интерфейс не поддерживается». Теперь, в подобной ситуации, робот продолжит свою работу и перейдет к следующим письмам в папке. 
1. После отправки [письма с вложением по протоколу SMTP](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_mail/el_mail_smtp) робот не мог удалить файл вложения. Возникала ошибка доступа к файлу. Причина ошибки устранена.
1. Устранена утечка памяти при закрытии процесса. 
1. Улучшено поведение элемента [If-Else](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_ifelse) в режиме отладки. Если на панели элемента была включена точка останова, то требовалось дважды жать «Следующий шаг», чтобы возобновить процесс. Сейчас выполнение возобновляется с первого раза. 
1. Исправлена ошибка в работе элемента «Ссылка на процесс», которая наблюдалась с версии Студии 23.7.2. При выполнении элемента робот получал неверное значение параметра **Направление** (Direction) у аргумента подпроцесса. Корректная работа восстановлена.
1. Исправлена ошибка, возникавшая при использовании стиля главного меню «Лента» в упрощенном варианте. Ранее после запуска Студии наблюдалось изменение вида ленты. Сейчас все работает корректно.
1. Исправлено ошибочное отображение элементов из режима работы Citizen в режиме Pro.
1. В свойствах некоторых элементов при создании переменной горячими клавишами (Ctrl + K) неправильно определялся поддерживаемый тип данных. Ошибка исправлена.
1. Отсутствовала возможность скопировать корневой контейнер **Последовательность**. Ошибка исправлена, копирование стало доступным.


### Где найти
[Скачать дистрибутив Primo Studio Enterprise](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FStudio).

[Скачать дистрибутив Primo Robot](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FRobot):
* **Primo RPA Robot 1.23.9** - предназначен для установки на локальной рабочей станции. Выступает в роли цифрового ассистента пользователя. Дистрибутив поставляется в разрядности x64 и x86.
* **Primo RPA Robot Orchestrator 1.23.9** - предназначен для автоматической установки Оркестратором. Дистрибутив поставляется в разрядности x64 и x86.




