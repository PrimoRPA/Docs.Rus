# Primo Studio 23.9
Раздел содержит описание изменений для версии приложения Primo Studio 23.9, выпущенной в сентябре 2023 года.

### Новые функции и улучшения

1. Поддержка WebDriver обновлена до актуальной (какой?) версии. Улучшение призвано повысить эффективность работы с шаблонами поиска для веб-приложений.

1. 169 - Повтор при Exception-е в активности Retry.
https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/169
Вопрос: при ошибке не идет дальше, а всегда возвращается к первому элементу?

1. В контейнере [**Приложение Excel**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_excel/el_excel_app) появилось свойство **«Открывать только на чтение»**. Оно работает только с драйвером Interop и определяет, нужно ли открывать файл в режиме «Только для чтения». По умолчанию свойство отключено. Функциональность помогает считывать данные из файла, который был заблокирован для редактирования.

   ![](<../../.gitbook/assets/excel-only-read.png>)   

1. Добавлен новый тип ресурса Оркестратора - JObject. В значении этого ресурса можно хранить данные в формате JSON. Студия позволяет работать с ресурсом такого типа через элементы [**Получить значение**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_assets/el_orch_getvalue) и [**Установить значение**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_assets/el_orch_setvalue). 

1. В элементе [Комментарий](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_dialogs/el_dialogs_comment) стал доступен ввод текста с переводом строки. 

   ![](<../../.gitbook/assets/comment-element-lines-much.png>)

1. Улучшен инструмент публикации проекта в Оркестраторе через Студию. Теперь при публикации новой версии проекта рабочий файл будет сопоставляться с существующим проектом в Оркестраторе. При найденном совпадении Студия предложит его для выбора, указав на нужную запись в окне проектов. Это позволит избежать ситуации, когда новую версию проекта можно по ошибке загрузить в неподходящий проект.

   ![](<../../.gitbook/assets/export-project-to-orch.png>)

1. В окне [Поиска](https://docs.primo-rpa.ru/primo-rpa/primo-studio/projects/search) (Ctrl+F) стало сохраняться последнее значение, введенное в поисковой строке.

   ![](<../../.gitbook/assets/recently-value-in-find-line.png>)

### Улучшения в Robot Runner

* Клиентский робот (attended) стал поддерживать работу с ресурсами Оркестратора. 

### Исправленные ошибки 
1. Оптимизировано время открытия проектов в Студии.
1. При попытке открыть другой проект терялись изменения в текущем файле. Студия открывала новый проект сразу, не спрашивая пользователя, нужно ли ему сохранить изменения в текущем. Это приводило к потере данных. С этой версии пользователю будет отображаться модальное окно с соответствующим вопросом.
1. Исправлен импорт следующих SAP-элементов из UIPath-проектов:
   * **Type into** > конвертируется в элемент **Ввод текста** (LTools.UIInteraction.Elements.WFTypeText) с заданными свойствами и режимом SIMULATE.
   * **Сall transaction** > конвертируется в контейнер **Присоединиться к SAP** с вложенным элементом **Ввод текста (SAP)** - LTools.SAP.Elements.WFTypeText. Ранее не конвертировался.
1. Исправлена проверка синтаксиса в проектах, где удаляли зависимость. Некорректно работал индикатор ошибок: он отображался на элементах, не связанных с отсутствующей зависимостью.
1. Исправлена работа элементов из группы «События». Ранее, если в процессе последовательно использовалось несколько событий, то выполнение второго завершалось с ошибкой. Проблема устранена.
1. Исправлена ошибка в работе элемента [Чтение почты](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_outlook/el_outlook_readmail) (Outlook). При чтении папки, в которой находилось письмо с неподдерживаемым типом сообщения, возникала ошибка «Интерфейс не поддерживается». Теперь, в подобной ситуации, робот продолжит свою работу и перейдет к следующим письмам в папке. 
1. После отправки [письма с вложением по протоколу SMTP](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_mail/el_mail_smtp) робот не мог удалить файл вложения. Возникала ошибка доступа к файлу. Причина ошибки устранена.
1. Устранена утечка памяти при закрытии процесса. 
1. Улучшено поведение элемента [If-Else](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_ifelse) в режиме отладки. Если на панели элемента была включена точка останова, то требовалось дважды жать «Следующий шаг», чтобы возобновить процесс. Сейчас выполнение возобновляется с первого раза. 
1. Исправлена ошибка в работе элемента «Ссылка на процесс», которая наблюдалась с версии Студии 23.7.2. При выполнении элемента робот получал неверное значение параметра **Направление** (Direction) у аргумента подпроцесса. Корректная работа восстановлена.
1. Исправлена ошибка, возникавшая при использовании стиля главного меню «Лента» в упрощенном варианте. Ранее после запуска Студии наблюдалось изменение вида ленты. Сейчас все работает корректно.
1. Исправлено ошибочное отображение элементов из режима работы Citizen в режиме Pro.
1. В свойствах некоторых элементов при создании переменной горячими клавишами (Ctrl + K) неправильно определялся поддерживаемый тип данных. Ошибка исправлена.
1. Отсутствовала возможность скопировать корневой контейнер **Последовательность**. Ошибка исправлена, копирование стало доступным.





---------------------
1. 293 - При копировании элементов в диаграмме не сохранялся скриншот. Если ее нажать правой кнопкой мыши, скопировать и вставить в другое место – она копируется без скриншота и не работает. Иногда помогает ctrl+c, ctrl+v. Проблема проявляется не всегда.
Шаги для воспроизведения дефекта:
Внутри диаграммы, при использовании нескольких вложенных последовательностей и try-catch применяется активность клик по картинке.
https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/293

Странный коммент: "в 23.8.4. не воспроизводится". То есть уже было исправлено по факту?


4062 - ? поискать в демо (Конфигурируемый таймаут поиска, Dmitry Nazarenko)
https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/4062


### Где скачать 
Скачать Primo Studio Enterprise 23.9 можно по этой [ссылке](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FStudio).

Дистрибутив Primo Robot, работающий на компьютере пользователя, находится [здесь](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FRobot). Обратите внимание, что он не должен содержать слова Orchestrator в своем названии - эти дистрибутивы предназначены для Роботов Оркестратора.
