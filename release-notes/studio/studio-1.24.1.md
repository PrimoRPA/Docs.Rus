 # Primo Studio 1.24.1

Раздел содержит описание изменений для версии приложения Primo Studio 1.24.1, выпущенной в январе 2024-го года. Изменения касаются приложения, работающего на операционной системе Windows.

## Новые функции и улучшения (Enterprise)

Ниже описаны изменения для издания Primo RPA Studio Enterprise 1.24.1.


### Импорт RPA-проектов

1. Для элементов MS Excel при миграции стал добавляться контейнер **Приложение Excel**. В контейнере заполнены необходимые свойства, такие как путь к файлу, пароль, если имеется. 
1. В элементах MS Excel **Чтение диапазона** и **Запись диапазона** переменная типа DataTable стала переноситься в свойство **Переменная (таблица)**. Ранее она мигрировала в текстовую переменную. 
1. Улучшен импорт элемента [Try-Catch](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_trycatch). Если в импортируемом **Try-Catch** присутствует разделение на типы исключений в блоке **Cath**, то при миграции элемента, в блоке **Cath**, появится компонент [Switch](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_switch) с разделением на типы исключений. Это позволит обрабатывать каждое исключение отдельно.
1. Для элемента **Исключение** стал определяться тип ошибок в соответствии с типизацией в Primo RPA Studio. А именно:
   * SystemException (UiPath) > General (Primo);
   * BusinessRuleException (UiPath) > Business (Primo);
   * ApplicationException (UiPath) > Application (Primo).
1. У активности **Try-Catch** стала переноситься переменная исключения, если в блоке **Catch** присутствует ее обработка.
1. При импорте элемента **Присвоение** значения всех строковых переменных теперь берется в двойные кавычки.
1. При переносе диаграммы, в элементе **Принятие решения** (Flow Decision), теперь не пропадает условие, а в результирующих ветвях значение берется в кавычки, если это `String`.
1. Переменные стали импортироваться без группировки. 


### Элементы

1. У элементов [**Отправить сообщение**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_outlook/el_outlook_sendmail) (Outlook) и [**Отправить сообщение**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_mail/els_exchange/el_send) (Exchange) появилось опциональное свойство **От имени (отображаемое имя)**. Теперь пользователь может указать отображаемое имя отправителя письма, которое будет использоваться совместно со свойством **От имени (адрес)**.

   ![](<../../.gitbook/assets1/outlook-new-parameter.png>)
 
1. В группу *Приложение Word* добавлен элемент **Получение фигур**. С его помощью можно получить данные фигур из документа. Например: название, расположение и цвет заливки фигуры. Данный элемент может пригодиться при автоматизации обработки пользовательских форм.

   ![](<../../.gitbook/assets1/word-get-shapes.png>)


1. Для элементов SAP добавлено свойство **Строгий тайм-аут** .  (ПЕРЕСЛУШАТЬ ДЕМО - БЫЛО ЛИ ТАМ ПРО ТО, ЧТО ЭТО ДОБАВЛЕНО ЕЩЕ В ВЕРСИИ 23.11.5?)
1. Повышена стабильность работы [**Присутствия элемента**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_uiinteraction/el_exists) с браузером Chrome. ....[**Открыть браузер**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_browser/el_browser_open)

Изменения:
Поле "Состояние загрузки" - определяет статус загруженного док-та, которого необходимо ждать.
None - не ждать
Interactive -Страница уже загружена и DOM дерево построено, но дополнительные ресурсы, такие как изображения и iframe (en-US), все ещё загружаются.
Complete - полная загрузка
 поле "таймаут" - предельное время попытки загрузки страницы - по умолчанию 5 стандартных таймаутов(5*10= 50 сек) - на "Состояние загрузки" None не работает

 Сделал, но посредством URL. Соответственно, URL разные должны быть. https://disk.yandex.ru/d/WK5OxnyhtPpLlA
Нужно переустановить расширение!!!

ОР: Открытие новых вкладок и поведение первого элемента после открытия соответствует установленному параметру "Состояние загрузки"
 
https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_boards/board/t/Studio%20Team/Stories/?workitem=4141

   
### 







### Прочее

1. Появилась возможность закомментировать контейнер **Последовательность**, используя пункт контекстного меню. Контейнер входит в группы элементов *Диаграмма* и *Управление*.

1. Забивается место в папке `AppData/Local/Temp` пользователя. В итоге, за 3 дня роботы съедают таким образом 500Гб.
   Ожидается, что робот не будет копировать библиотеки в папку AppData/Local/Temp каждый раз при выполнении задачи. Предполагается, что робот будет использовать уже скопированные библиотеки, если они доступны, чтобы избежать повторного копирования и сохранить дисковое пространство.
   папка Primo.Studio в temp не очищается для проектов с зависимостями, что приводит к заполнению свободного места диска 
ОР и ФР:  При запуске проекта создается папка типа GUID с зависимостями, папка удаляется после выполнения проекта или после начала выполнения проекта или при следующем запуске






## Исправленные ошибки 

### Новый редактор шаблона поиска

1. Исправлена работа функции **Путь до элемента** в редакторе шаблона поиска. Теперь, если пользователь вносит корректировки в параметры шаблона, то путь до элемента в дереве шаблона динамически изменяется. 
1. Исправлены ошибки в работе нового шаблона с Java-приложениями при установленном плагине **Java**. Ранее заголовок окна приложения и тип рабочего стола определялись некорректно.
1. Исправлена ошибка, когда при смене текущего селектора удалялись родительские либо дочерние селекторы.
1. Исправлена ошибка, когда в ответ на попытку удалить один из селекторов (родительский или дочерний) Студия выводила ошибку и зависала. Ошибка воспроизводилась при работе с веб-браузером. 
1. Исправлены опечатки в названиях функций нового шаблона поиска. 


### Элементы
1. Восстановлена работоспособность элементов из группы **Браузер > События**, а именно:
   * Клик элемента;
   * Событие изменения аттрибута;
   * Событие кнопки браузера.
1. Устранена ошибка в работе событий, возникавшая при установке параллельного режима в контейнере **События** и присвоении переменных в параллельных потоках. Ошибка приводила к внеплановому завершению работы робота. 
1. Исправлена ошибка в работе элементов MS Excel в чистом коде (Pure code):
   * В элементе **Удаление колонок** метод `DeleteColumns` удалял строки. C этой версии метод удаляет столбцы.
   * В элементе **Удаление строк** метод `DeleteRows` удалял столбцы. C этой версии метод удаляет строки.
1. Исправлена ошибка в **Чтении диапазона** (Excel) с драйвером Interop и включенным параметром **Учитывать типы полей ячеек Excel**. Ранее, если первая ячейка диапазона была пустая, то чтение заканчивалось ошибкой.
