# Primo Studio 1.24.1

Раздел содержит описание изменений для версии приложения Primo Studio 1.24.1, выпущенной в январе 2024-го года. Изменения касаются приложения, работающего на операционной системе Windows.

## Новые функции и улучшения

**Новый редактор шаблона поиска**

1. Текст
2. 


### Импорт

Улучшен [импорт](https://docs.primo-rpa.ru/primo-rpa/primo-studio/tools/import) RPA-проектов: 
1. Для элемента **Исключение** стал определяться тип ошибок в соответствии с типизацией в Primo RPA Studio. А именно:
   * SystemException (UiPath) > General (Primo);
   * BusinessRuleException (UiPath) > Business (Primo);
   * ApplicationException (UiPath) > Application (Primo).
1. Улучшен импорт элемента [Try-Catch](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_trycatch). Если в импортируемом **Try-Catch**, в блоке **Cath**, присутствует разделение на типы исключений, то при миграции в блоке **Cath** появится компонент [Switch](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_switch) с разделением на типы исключений. Это позволит обрабатывать каждое исключение отдельно.
1. У активности **Try-Catch** стала переноситься переменная исключения, если в блоке **Catch** есть ее обработка.
1. При импорте элемента **Присвоение** значения всех строковых переменных теперь берется в двойные кавычки.
1. Для элементов MS Excel при миграции стал добавляться контейнер **Приложение Excel**. В контейнере заполнены необходимые свойства, такие как путь к файлу, пароль, если имеется. 
1. В элементах MS Excel **Чтение диапазона** и **Запись диапазона** переменная типа DataTable стала переноситься в свойство **Переменная (таблица)**. Ранее она мигрировала в текстовую переменную. 
1. При переносе диаграммы, в элементе **Принятие решения** (Flow Decision), теперь не пропадает условие, а в результирующих ветвях значение берется в кавычки, если это `String`.
1. Переменные стали импортироваться без группировки. 

### Элементы

1. У элементов [**Отправить сообщение**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_outlook/el_outlook_sendmail) (Outlook) и [**Отправить сообщение**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_mail/els_exchange/el_send) (Exchange) появилось опциональное свойство **От имени (отображаемое имя)**. Оно позволяет указать отображаемое имя отправителя письма. Пользователь, указывающий имя, должен обладать соответствующими правами. 

   ![](<../../.gitbook/assets1/>)
   
   УСТАНОВИТЬ СТУДИЮ НОВУЮ И СДЕЛАТЬ СКРИН.

   Прописать либо в ошибках, либо в самом свойстве: Для отправки "От имени" необходимо обладать соответствующими правами иначе возникает ошибка: "У вас нет прав для отправки сообщения вместо указанного пользователя. Ошибка: [0x80070005-0x0004dc-0x000524].
   В логе консоли это выглядит так: "Error: Отправить сообщение/cf63d3fd-495d-4cc7-b82b-acaea13d362c/1.1/LTools.Office.Elements.Outlook.WFSendMessage = Не удалось выполнить операцию. Интерфейс передачи сообщений возвратил неизвестную ошибку. Если это повторится, перезагрузите Outlook. Невозможно определить получателя".

  https://learn.microsoft.com/en-us/dotnet/api/system.net.mail.mailaddress.displayname?view=net-8.0&viewFallbackFrom=net-4.6.1

1. Добавлен элемент **Получение фигур** (МойОфис). ......... ???
   Word - элемент, получающий фигуры на документе (Офис). Нужен элемент, возвращающий массив графических примитивов, расположенных на документе. Образец документа во вложении.
   https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_boards/board/t/Studio%20Team/Stories/?workitem=9179

1. Добавлено свойство **Строгий тайм-аут** для элементов SAP.  (ПЕРЕСЛУШАТЬ ДЕМО - БЫЛО ЛИ ТАМ ПРО ТО, ЧТО ЭТО ДОБАВЛЕНО ЕЩЕ В ВЕРСИИ 23.11.5?)

   

### Прочее

1. Стало возможным закомментировать контейнер **Последовательность**, входящий в группы *Диаграмма* и *Управление*, используя пункт контекстного меню. 
   




## Исправленные ошибки 

#### Тема

1. текст
1. 
