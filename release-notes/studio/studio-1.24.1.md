 # Primo Studio 1.24.1

Раздел содержит описание изменений для версии приложения Primo Studio 1.24.1, выпущенной в январе 2024-го года. Изменения касаются приложения, работающего на операционной системе Windows.

## Изменения и улучшения (Enterprise)

Ниже описаны изменения для издания Primo RPA Studio Enterprise 1.24.1.


### Импорт RPA-проектов

1. Для элементов MS Excel при миграции стал добавляться контейнер **Приложение Excel**. В контейнере заполнены необходимые свойства, такие как путь к файлу, пароль, если имеется. 
1. В элементах MS Excel **Чтение диапазона** и **Запись диапазона** переменная типа DataTable стала переноситься в свойство **Переменная (таблица)**. Ранее она мигрировала в текстовую переменную. 
1. Улучшен импорт элемента [Try-Catch](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_trycatch). Если в импортируемом **Try-Catch** присутствует разделение на типы исключений в блоке **Cath**, то при миграции элемента, в блоке **Cath**, появится компонент [Switch](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_switch) с разделением на типы исключений. Это позволит обрабатывать каждое исключение отдельно.
1. Для элемента **Исключение** стал определяться тип ошибок в соответствии с типизацией в Primo RPA Studio. А именно:
   * SystemException (UiPath) > General (Primo);
   * BusinessRuleException (UiPath) > Business (Primo);
   * ApplicationException (UiPath) > Application (Primo).
1. У активности **Try-Catch** стала переноситься переменная исключения, если в блоке **Catch** присутствует ее обработка.
1. При импорте элемента **Присвоение** значения всех строковых переменных теперь берется в двойные кавычки.
1. При переносе диаграммы, в элементе **Принятие решения** (Flow Decision), теперь не пропадает условие, а в результирующих ветвях значение берется в кавычки, если это `String`.
1. Переменные стали импортироваться без группировки. 


### Элементы

1. У элементов [**Отправить сообщение**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_outlook/el_outlook_sendmail) (Outlook) и [**Отправить сообщение**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_mail/els_exchange/el_send) (Exchange) появилось опциональное свойство **От имени (отображаемое имя)**. Теперь пользователь может указать имя отправителя письма для ящика из свойства **От имени (адрес)**. Функциональность призвана улучшить отправку писем с общих почтовых ящиков.

   ![](<../../.gitbook/assets1/outlook-new-parameter.png>)
 
1. В группу элементов *Приложение Word* добавлен компонент **Получение фигур**. С его помощью можно узнать название, расположение и цвет заливки фигур в документе. Данные могут пригодиться при автоматизации обработки пользовательских форм.

   ![](<../../.gitbook/assets1/word-get-shapes.png>)


1. Для элементов SAP [**Эмуляция спецкнопки**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_sap/el_sap_hotkey) и [**Ввод текста**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_sap/el_sap_input) добавлено свойство **Строгий тайм-аут**. Настройка позволяет незамедлительно прерывать выполнение элемента по истечении таймаута. 
1. У элемента [**Открыть браузер**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_browser/el_browser_open) появилось свойство **Состояние загрузки**, определяющее ожидаемый статус загрузки веб-страницы. Теперь переход к *первому элементу* в контейнере будет осуществляться только при указанном состоянии загрузки. Если страница не успеет загрузиться в установленный таймаут, робот завершит работу с ошибкой. Возможные значения:
   * *None* - не ждать загрузки страницы. Значение используется для обратной совместимости и установлено по умолчанию. 
   * *Interactive* - система будет ждать загрузки страницы и построения DOM-дерева, но дополнительные ресурсы могут продолжать загружаться. Например: изображения, `<iframe>`.
   * *Complete* - ждать полной загрузки веб-страницы, указанной в контейнере.
1. Улучшена производительность элемента **Прочитать таблицу** (Браузер) при работе с таблицами в несколько тысяч строк. Изменение не затрагивает работу одноименного браузерного элемента из Поколения 1.
   
### Плагин Chat GPT
1. 10369	Плагин Chat GPT для Студии. 



### Робот
1. 8444	Неверное отображение версии Primo Robot Runner.
1. 8596	Не запускается robot.runner из папки Студии.


### Отладка
1. 3221	Пустой экран Excel после успешной отладки задачи.
1. 9085	Отладка не продолжается после отработки исключения в элементе "параллельные потоки".
1. 11245	Не запускается OnlyCode в отладчике v2.		


### Другое
1. Улучшен выбор тестовых данных для RPA-проектов. Теперь [при создании процесса](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process#kak-sozdat-process) возможно указать рабочий лист файла Excel, а также конкрентные строки и столбцы. Если не указывать значение, то по умолчанию будет выбран первый лист и все данные в таблице.

   ![](<../../.gitbook/assets1/test-case-in-process.png>)

1. Появилась возможность закомментировать контейнер **Последовательность**, используя пункт контекстного меню. Контейнер входит в группы элементов *Диаграмма* и *Управление*.

1. Забивается место в папке `AppData/Local/Temp` пользователя. В итоге, за 3 дня роботы съедают таким образом 500Гб.
   Ожидается, что робот не будет копировать библиотеки в папку AppData/Local/Temp каждый раз при выполнении задачи. Предполагается, что робот будет использовать уже скопированные библиотеки, если они доступны, чтобы избежать повторного копирования и сохранить дисковое пространство.
   папка Primo.Studio в temp не очищается для проектов с зависимостями, что приводит к заполнению свободного места диска 
ОР и ФР:  При запуске проекта создается папка типа GUID с зависимостями, папка удаляется после выполнения проекта или после начала выполнения проекта или при следующем запуске






## Исправленные ошибки 

### Новый редактор шаблона поиска

1. Исправлена работа функции **Путь до элемента** в редакторе шаблона поиска. Теперь, если пользователь вносит корректировки в параметры шаблона, то путь до элемента в дереве шаблона динамически изменяется. 
1. Исправлены ошибки в работе нового шаблона с Java-приложениями при установленном плагине **Java**. Ранее заголовок окна приложения и тип рабочего стола определялись некорректно.
1. Исправлена ошибка, когда при смене текущего селектора удалялись родительские либо дочерние селекторы.
1. Исправлена ошибка, когда в ответ на попытку удалить один из селекторов (родительский или дочерний) Студия выводила ошибку и зависала. Ошибка воспроизводилась при работе с веб-браузером. 
1. Исправлены опечатки в названиях функций нового шаблона поиска. 


### Элементы
1. Исправлена ошибка, из-за которой робот-отладчик не мог выйти из подпроцесса, если в элементе **Ссылка на процесс** не было включено кеширование. Ошибка воспроизводилась при наличии в подпроцессе элемента **Try-Catch**, в котором возникало исключение. С этой версии состояние кеширования подпроцесса не влияет на его работу.
1. Восстановлена работоспособность элементов из группы **Браузер > События**, а именно:
   * Клик элемента;
   * Событие изменения аттрибута;
   * Событие кнопки браузера.
1. Устранена ошибка в работе событий, возникавшая при установке параллельного режима в контейнере **События** и присвоении переменных в параллельных потоках. Ошибка приводила к внеплановому завершению работы робота. 
1. Исправлена ошибка в работе элементов MS Excel в чистом коде (Pure code):
   * В элементе **Удаление колонок** метод `DeleteColumns` удалял строки. C этой версии метод удаляет столбцы.
   * В элементе **Удаление строк** метод `DeleteRows` удалял столбцы. C этой версии метод удаляет строки.
1. Исправлена ошибка в **Чтении диапазона** (Excel) с драйвером Interop и включенным параметром **Учитывать типы полей ячеек Excel**. Ошибка возникала, если первая ячейка диапазона была пустой.


1. 7808	Некорректное поведение элементов "МойОфис" (Офис).	.
1. 9337	Активность "Read table" (не 1 поколения) не способна считать большие таблицы.
