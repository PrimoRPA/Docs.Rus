# Primo Studio 23.1

**ОБРАЩАЕМ ВАШЕ ВНИМАНИЕ!** **С 2023 года Primo RPA переходит на новую систему версионирования ПО.**

Переход призван облегчить:
* работу службы поддержки клиентов;
* навигацию по версиям ПО;
* понимание совместимости разных продуктов платформы. 

Версии приложений Primo RPA теперь именуются по семантическому принципу: **<год>.<месяц>.<номер изменения>.**  

Таким образом, примечания к выпуску Студии 23.1 описывают изменения для версии приложения, выпущенной в январе 2023 года. 


## Новые функции

1. В тестовом режиме доступно улучшенное ядро робота с ускоренной загрузкой процессов, более оптимальным управлением памятью и существенно улучшенной скоростью работы. Для его использования перейдите в настройки Отладчика (**Файл ➝ Настройки ➝ Общие ➝ Отладчик**) и [переключите версию ядра](https://docs.primo-rpa.ru/primo-rpa/primo-studio/settings#otladchik) в одноименном параметре на значение **V2**. 
2. Значительно улучшен механизм работы с селекторами в толстом клиенте 1С. Если вы замечали медленную работу с 1С, поставьте в редакторе [шаблона поиска](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/searchpatterns/apps-categories#rabochii-stol) свойство **Быстрый поиск**.
3. Добавлен новый тип автоматизации для доступа к UI приложений рабочего стола - **MSAA** (Microsoft Active Accessibility). Поскольку в большинстве случаев стандартный UI Automation по-прежнему работает лучше, обращение к MSAA будет полезным в ограниченном количестве случаев. Например, когда при поиске текстовых элементов программ требуется использовать свойство идентификации **Role**. Тип автоматизации возможно выбрать в свойствах контейнера [**Присоединиться к приложению**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_desktop/el_desktop_attach) или непосредственно [в редакторе шаблона поиска](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/searchpatterns/apps-categories#rabochii-stol), если элемент с шаблоном используется без контейнера. 
4. В циклы [**ForEach**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_logic/el_logic_foreach) и [**ForEach для DataTable**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_logic/el_logic_foreachrowdatatable) добавлена функция кеширования массива для улучшения производительности на больших объемах данных. Если кеширование включено, список для итерации рассчитывается только при первом проходе цикла.
5. У элемента [**Получить текст (UI)**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_uiinteraction/el_gettext) появилось свойство **Режим**, которое может принимать значения DEFAULT/NATIVE/NATIVE_FULL. Если в режиме по умолчанию (DEFAULT) возникла проблема с чтением текста, рекомендуется переключить режим на другой.
6. У элемента [**Приложение Excel**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/prilozhenie-excel/el_excel_app) появились свойства:
   * **Присоединяться** - позволяет подключиться к открытому вручную файлу Excel.
   * **Загружать AddIn-ы** - загружает установленные дополнения. Свойство работает только с драйвером Interop и служит для улучшения совместимости с некоторыми сценариями использования плагинов. Например, при включенном параметре **Присоединяться**.
7. Для элементов [группы **Оркестратор**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/orkestrator) добавлено свойство **Таймаут**, в котором возможно задать допустимое время на выполнение операции. Механизм таймаутов призван решить проблему с возможным зависанием Робота при ненадежном взаимодействии с Оркестратором: проблемы с подключением, медленная скорость Оркестратора. Если по истечении таймаута операция не выполнилась, Робот закончит работу с ошибкой.
8. В элементе [**Получить из очереди по фильтру**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/orkestrator/els_queues/peekqueuefilter) добавлена фильтрация по значению элемента очереди. Для ее использования необходимо ввести регулярное выражению в свойстве **Фильтр по значению**. 
9. Добавлена возможность изменять имя переменной для всего процесса, в котором она используется. Для этого на панели **Переменные** добавлена кнопка [**Переименовать переменную**](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/variables#redaktirovanie-peremennoi). 
10. Добавлена [горячая клавиша](https://docs.primo-rpa.ru/primo-rpa/primo-studio/hotkeys) для запуска выбранного процесса - `F5`.
11. Улучшена работа [окна общего поиска](https://docs.primo-rpa.ru/primo-rpa/primo-studio/projects/search):
    * Окно перестало перекрывать другие приложения.  
    * Поиск стало возможным запустить по нажатию клавиши `Enter`. Введите в поле запроса значение и нажмите `Enter` - отобразятся результаты поиска, аналогично использованию кнопки **Искать**. 
12. Увеличена скорость механизма [отмены/повтора действий](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/sequence#rabota-s-izmeneniyami), что особенно важно при работе с большими проектами. 
13. Улучшен дизайн окна приветствия Студии. Переструктурированы блоки **Начало работы** и **История**, убран логотип для более лаконичного визуального представления.


## Исправленные ошибки

1. Исправлена ошибка сохранения процесса при использовании команд **Отменить/Повторить** последние действия. В новой версии сохранение всех изменений проекта работает корректно.
1. В работе элемента [**Уничтожить процесс**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_desktop/el_desktop_kill) исправлены ошибки:
   * Элемент не закрывал процесс, если имя процесса было указано с расширением (например, "Excel.exe"). Теперь процесс закрывается, вне зависимости от того, как указано его имя: с раширением или без.
   * Элемент не закрывал процессы без окон (например, modern-приложения в Windows). 
   * Вместо закрытия процесса в некоторых случаях появлялся диалог подтверждения. 
   * Элемент закрывал только один экземпляр процесса пользователя из нескольких, если был включен параметр **Текущий пользователь**. Теперь все процессы текущего пользователя закрываются. 
1. Исправлена логика элемента [**Открыть браузер**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_browser/el_browser_open), которая приводила к ошибкам: 
   * Обновление предыдущей страницы при открытии новой. Обновление предыдущей вкладки влекло за собой ошибочное изменение ее адреса на URL новой страницы. Теперь открытие новой вкладки происходит без обновления предыдущей (при ее наличии).
   * Ошибка запуска процесса плагина. 
1. В элементе [**Фильтр таблицы**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_coll/el_coll_filtertable) исправлены ошибки:
   * Отсутствовала возможность фильтрации по пустому полю. Раньше, если в фильтре в поле **Значение** было указано null или "", то запрос выполнялся с ошибкой. 
   * Если фильтрация проводилась по условию, которое не удовлетворяет ни одному значению, в ответе не возвращалась структура таблицы. С новой версии структура таблицы возвращается.
1. В шаблоне поиска для приложений рабочего стола исправлены ошибки:
   * В работе параметра **Быстрый поиск**. Не поддерживался быстрый поиск по свойству идентификации **Text**, что накладывало ограничения при идентификации элементов управления, например, в подменю программ. В новой версии добавлена поддержка быстрого поиска для **Text**, а также для свойств **IsControlElement, IsContentElement, IsRequiredForForm, ItemType**. 
   * В редакторе шаблона некорректно заполнялось поле **Заголовок** при использовании элемента Студии вне контейнера (stand-alone). Ошибка воспроизводилась при автоматическом добавлении компонента в шаблон и последующем открытии редактора - в этом случае поле **Заголовок** отображало неверное название приложения рабочего стола (например, **Рабочий стол1**). Ошибка исправлена.
1. Исправлена нестабильность в работе элемента [**Якорь**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_uiinteraction/el_anchor). В некоторых случаях могли игнорироваться указанные пользователем настройки расположения элемента относительно якоря. В новой версии проблема устранена.
1. В элементе [**Клик мышью**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_uiinteraction/el_click) исправлена работа корректировки клика по координатам относительно значения в свойстве **Позиция**. Раньше, вне зависимости от указанного значения в параметре **Позиция**, корректировка всегда считалась по Top Left. Теперь корректировка считается в соответствии с указанным пользователем значением.  
1. Исправлена работа элемента [**Запрос WEB-сервиса**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_network/el_webrequest) в диаграммах. В некоторых случаях выполнение диаграммы могло приостанавливаться на данном элементе. В новой версии выполнение происходит корректно.


