# Primo Studio 1.1.31

## Новые функции

1. Для работы с приложениями рабочего стола добавлен новый тип автоматизации - **MSAA** (Microsoft Active Accessibility). Обращение к нему полезно в ограниченном количество случаев: например, когда при поиске текстовых элементов необходимо использовать свойство идентификации **Role**. Тип автоматизации возможно выбрать в свойствах элемента [**Присоединиться к приложению**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_desktop/el_desktop_attach) или в шаблоне поиска для [категории приложений **Рабочий стол**](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/searchpatterns/apps-categories#rabochii-stol). 
1. В шаблоне поиска для [приложений **Рабочего стола**](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/searchpatterns/apps-categories#rabochii-stol) улучшена работа чекбокса **Быстрый поиск** при взаимодействии с 1С. 
1.  В циклы [**ForEach**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_logic/el_logic_foreach) и [**ForEach для DataTable**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_logic/el_logic_foreachrowdatatable) добавлена функция кеширования массива для улучшения производительности. Если кеширование включено, список для итерации рассчитывается только при первом проходе цикла.
1. У элемента [**Получить текст (UI)**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_uiinteraction/el_gettext) появилось свойство **Режим**, которое может принимать значения DEFAULT/NATIVE/NATIVE_FULL. Если в режиме по умолчанию (DEFAULT) возникла проблема с чтением текста, рекомендуется переключить режим на другой.
1. У элемента [**Приложение Excel**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/prilozhenie-excel/el_excel_app) появились свойства:
   * **Присоединяться** - позволяет подключиться к открытому вручную файлу Excel.
   * **Загружать AddIn-ы** - загружает установленные дополнения. Свойство работает только с драйвером Interop и служит для улучшения совместимости с некоторыми сценариями использования плагинов. Например, при включенном параметре **Присоединяться**.
1. Для всех элементов [группы **Оркестратор**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/orkestrator) добавлено свойство **Таймаут**, в котором возможно задать допустимое время на выполнение операции. Механизм таймаутов призван решить проблему с возможным зависанием Робота при ненадежном взаимодействии с Оркестратором: проблемы с подключением, медленная скорость Оркестратора. Если по истечении таймаута операция не выполнилась, Робот закончит работу с ошибкой.
1. 



## Исправленные ошибки

1. В работе элемента [**Уничтожить процесс**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_desktop/el_desktop_kill) исправлены ошибки:
   * Элемент не закрывал процесс, если имя процесса было указано с расширением (например, "Excel.exe"). Теперь процесс закрывается, вне зависимости от того, как указано его имя: с раширением или без.
   * Элемент не закрывал процессы без окон (например, modern-приложения в Windows). Эти процессы стали уничтожаться.
1. В работе элемента [**Открыть браузер**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_browser/el_browser_open) исправлена ошибка обновления предыдущей страницы при запуске новой. Обновление предыдущей страницы влекло за собой ошибочное изменение ее адреса на URL новой страницы. Теперь открытие новой вкладки происходит без обновления предыдущей, если она имеется.
1. В элементе [**Фильтр таблицы**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_coll/el_coll_filtertable) исправлены ошибки:
   * Отсутствовала возможность фильтрации по пустому полю. Раньше, если в фильтре в поле **Значение** было указано null или "", то запрос выполнялся с ошибкой. 
   * Если фильтрация проводилась по условию, которое не удовлетворяет ни одному значению, не возвращалась структура таблицы (заголовки и поля). С новой версии структура таблицы возвращается.
1. В шаблоне поиска исправлена ошибка в работе параметра **Быстрый поиск**. Не поддерживался быстрый поиск по свойству идентификации **Text**, что мешало находить элементы управления, например, в подменю программ. В новой версии добавлена поддержка быстрого поиска для **Text**, а также для свойств **IsControlElement, IsContentElement, IsRequiredForForm, ItemType**.
1. Исправлена нестабильность в работе элемента **Якорь**. Ранее, в некоторых случаях, могли игнорироваться указанные пользователем настройки расположения элемента относительно якоря. В новой версии проблема устранена.
1.  


**Фильтр таблицы**. Сейчас до сих пор минус - фильтр по текстовым значениям. Если по дате фильтр, нужно в кавычки включать. Если тип колонки инт и мы указываем цифру... значения в фильтре заключать в кавычки. все, даже даты. это рекомендация. У Димы поспрашивать.
