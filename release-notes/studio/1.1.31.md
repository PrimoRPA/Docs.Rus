# Primo Studio 1.1.31

## Новые функции

1. Для работы с приложениями рабочего стола добавлен новый тип автоматизации - **MSAA** (Microsoft Active Accessibility). Обращение к нему полезно в ограниченном количество случаев: например, когда при поиске текстовых элементов программ необходимо использовать свойство идентификации **Role**. Тип автоматизации возможно выбрать в свойствах контейнера [**Присоединиться к приложению**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_desktop/el_desktop_attach) или непосредственно в редакторе шаблона поиска для [категории приложений **Рабочий стол**](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/searchpatterns/apps-categories#rabochii-stol), если элемент с шаблоном используется без контейнера. 
1.  В циклы [**ForEach**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_logic/el_logic_foreach) и [**ForEach для DataTable**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_logic/el_logic_foreachrowdatatable) добавлена функция кеширования массива для улучшения производительности. Если кеширование включено, список для итерации рассчитывается только при первом проходе цикла.
1. У элемента [**Получить текст (UI)**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_uiinteraction/el_gettext) появилось свойство **Режим**, которое может принимать значения DEFAULT/NATIVE/NATIVE_FULL. Если в режиме по умолчанию (DEFAULT) возникла проблема с чтением текста, рекомендуется переключить режим на другой.
1. У элемента [**Приложение Excel**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/prilozhenie-excel/el_excel_app) появились свойства:
   * **Присоединяться** - позволяет подключиться к открытому вручную файлу Excel.
   * **Загружать AddIn-ы** - загружает установленные дополнения. Свойство работает только с драйвером Interop и служит для улучшения совместимости с некоторыми сценариями использования плагинов. Например, при включенном параметре **Присоединяться**.
1. Для элементов [группы **Оркестратор**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/orkestrator) добавлено свойство **Таймаут**, в котором возможно задать допустимое время на выполнение операции. Механизм таймаутов призван решить проблему с возможным зависанием Робота при ненадежном взаимодействии с Оркестратором: проблемы с подключением, медленная скорость Оркестратора. Если по истечении таймаута операция не выполнилась, Робот закончит работу с ошибкой.
1. В элементе [**Получить из очереди по фильтру**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/orkestrator/els_queues/peekqueuefilter) добавлена фильтрация по значению элемента очереди. Для ее использования необходимо ввести регулярное выражению в свойстве **Фильтр по значению**. 
1. Добавлена возможность изменять имя переменной для всего процесса, в котором она используется. Для этого на панели **Переменные** добавлена кнопка [**Переименовать переменную**](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/variables). 
1. Добавлена [горячая клавиша](https://docs.primo-rpa.ru/primo-rpa/primo-studio/hotkeys) для запуска выбранного процесса - `F5`.
1. Улучшена работа окна [общего поиска](https://docs.primo-rpa.ru/primo-rpa/primo-studio/projects/search):
   * Окно перестало перекрывать другие приложения.  
   * Поиск стало возможным запустить по нажатию клавиши `Enter`. Введите в поле запроса значение и нажмите `Enter` - отобразятся результаты поиска, аналогично использованию кнопки **Искать**. 
1. Увеличена скорость механизма отмены/повтора действий, что особенно важно при работе с большими проектами. 
1. В шаблоне поиска для улучшена работа чекбокса **Быстрый поиск** при взаимодействии с 1С. 
1. Улучшен дизайн окна приветствия Студии. Переструктурированы блоки **Начало работы** и **История**, убран логотип для более лаконичного визуального представления.


## Исправленные ошибки

1. В работе элемента [**Уничтожить процесс**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_desktop/el_desktop_kill) исправлены ошибки:
   * Элемент не закрывал процесс, если имя процесса было указано с расширением (например, "Excel.exe"). Теперь процесс закрывается, вне зависимости от того, как указано его имя: с раширением или без.
   * Элемент не закрывал процессы без окон (например, modern-приложения в Windows). 
   * Вместо закрытия процесса в некоторых случаях появлялся диалог подтверждения. 
   * Элемент закрывал только один экземпляр процесса пользователя из нескольких, если был включен параметр **Текущий пользователь**. Теперь все процессы текущего пользователя закрываются. 
1. Исправлена логика элемента [**Открыть браузер**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_browser/el_browser_open), которая приводила к ошибкам: 
   * Обновление предыдущей страницы при открытии новой. Обновление предыдущей вкладки влекло за собой ошибочное изменение ее адреса на URL новой страницы. Теперь открытие новой вкладки происходит без обновления предыдущей, если она имеется.
   * Запуск процесса плагина мог завершиться ошибкой, в результате чего не отрабатывали ожидаемым образом элементы внутри контейнера **Открыть браузер**.
1. В элементе [**Фильтр таблицы**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_coll/el_coll_filtertable) исправлены ошибки:
   * Отсутствовала возможность фильтрации по пустому полю. Раньше, если в фильтре в поле **Значение** было указано null или "", то запрос выполнялся с ошибкой. 
   * Если фильтрация проводилась по условию, которое не удовлетворяет ни одному значению, в ответе не возвращалась структура таблицы (заголовки и поля). С новой версии структура таблицы возвращается.
1. В шаблоне поиска для приложений рабочего стола исправлены ошибки:
   * В работе параметра **Быстрый поиск**. Не поддерживался быстрый поиск по свойству идентификации **Text**, что накладывало ограничения при идентификации элементов управления, например, в подменю программ. В новой версии добавлена поддержка быстрого поиска для **Text**, а также для свойств **IsControlElement, IsContentElement, IsRequiredForForm, ItemType**. 
   * В редакторе шаблона некорректно заполнялось поле **Заголовок** при использовании элемента Студии вне контейнера (stand-alone). Ошибка воспроизводилась при автоматическом добавлении компонента в шаблон и последующем открытии редактора - в этом случае поле **Заголовок** отображало неверное название приложения рабочего стола (например, "Рабочий стол1"). Ошибка исправлена.
1. Исправлена нестабильность в работе элемента [**Якорь**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_uiinteraction/el_anchor). В некоторых случаях могли игнорироваться указанные пользователем настройки расположения элемента относительно якоря. В новой версии проблема устранена.
1. В элементе [**Клик мышью**](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_uiinteraction/el_click) исправлена работа корректировки клика по координатам относительно значения в свойстве **Позиция**. Раньше, вне зависимости от указанного значения в параметре **Позиция**, корректировка всегда считалась по Top Left. Теперь корректировка считается от указанного пользователем значения. 
1. Исправлена ошибка сохранения процесса из-за **Отменить/Повторить**. при отладке есть возможность удалить активности (и даже сохранить) проект. А если выполнение доходит до места удаленных элементов, то они будут выполнены.
поправить кейс удаления при дебаге, чтобы удаленные сущности не выполнялись.
(у Димы можно спросить) Баг Undo/Redo: раньше делали большие изменения, сохраняли, изменений не было. клиенты назвали это "проблемой кеширования" - ГПН. Древний баг. 
1. Исправлена работа элемента [Запрос WEB-сервиса](https://docs.primo-rpa.ru/primo-rpa/g_elements/osnovnye-elementy/els_network/el_webrequest) в диаграммах. В некоторых случаях выполнение диаграммы могло приостанавливаться на данном элементе. 
