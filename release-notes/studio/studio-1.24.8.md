# Primo RPA Studio 1.24.8

История изменений в **Primo RPA Studio Windows** за август 2024-го года. 


## Обновления и улучшения (режим Pro)

1. Улучшен процесс импорта данных из DataTable в Базу Данных путем объединения всех операций вставки (Insert)  в одну транзакцию. Тем самым удалось значительно увеличить скорость загрузки больших таблиц, примерно в 2 раза.

1. Добавлено новое свойство `Точное совпадение колонок` у элемента **Вставка данных (WFInsert)**
   * При включенном свойстве импортируются все колонки из DataTable, и если в таблице есть колонки, которых нет в БД, произойдет ошибка. 
   * При выключенном свойстве импортируются только те колонки, которые совпадают по именам с колонками в БД, что позволяет избежать ошибок.

1. Добавлено новое свойство `Сохранить изменения` в элементы **Приложение Excel** и **Приложение Word**. По умолчанию чекбокс неактивен, что позволяет избежать случайного сохранения изменений. При активации чекбокса внесенные изменения в документы будут сохранены автоматически.
 
1. Улучшено отображение шаблонов в интерфейсе Студии: теперь шаблоны отображаются на языке, выбранном в настройках интерфейса (русском или английском).

1. Увеличено время ожидания (Timeout) для всех элементов, относящихся к разделу Оркестратор (очереди, процесс, ресурсы), до 30 секунд по умолчанию. Это поможет предотвратить ошибки из-за недостаточного времени выполнения.

1. Добавлены новые функции у элемента **Чтение таблицы**:
   -  Добавлен новый алгоритм `Table Move` в свойствах, позволяющий полностью считывать виртуальные таблицы.
   -  Новое свойство `Количество колонок`, которое задает количество столбцов для более точного чтения и разделения данных.
   -  Новая функция `Обнаружить заголовки`: при ее активации формируются заголовки из повторяющихся данных. Если все ячейки столбца содержат одинаковое значение, например, дату 15.07.2024, то это значение объединяется с названием столбца, образуя единый заголовок.
 В результате заголовок столбца примет вид: 15.07.2024 Дата.

1. Добавлены новые активности для управления вкладками браузера: 
   -  [**Активировать вкладку (ActivateTab)**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_browser/el_activate_tab) (активация вкладки по индексу, идентификатору, заголовку и/или URL), 
   -  [**Активная вкладка (CurrentTab)**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_browser/el_current_tab) (получение информации о текущей вкладке) 
   -  [**Открыть вкладку (OpenTab)**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_browser/el_open_tab) (открытие новой вкладки по URL или дублирование текущей). Данный элемент теперь создает новую вкладку, если окно браузера уже открыто, вместо создания нового окна. В дальнейшем планируется разделение действий `Открыть новое окно браузера` и `Создать новую вкладку браузера` для более предсказуемого поведения компонентов.
   -  [**Закрыть вкладку брузера (Close Tab)**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_browser/el_browser_tab_close), позволяющий закрывать вкладки в браузерах (IE, Chrome, Firefox) по индексу, заголовку или переменной, полученной с помощью элементов *Open Browser (Открыть браузер), **Attach Browser (Присоединиться к браузеру), **Open Application (Открыть приложение), **Attach Application (Присоединиться к приложению)*. При использовании браузера Firefox с Манифестом V3 необходимо убедиться, что присутствуют нужные расширения. Актуальная версия расширения для браузера в версии Студии 1.24.8: 1.68/3.68

1. Добавлена возможность работы с вкладками браузера по индексу. 
Для использования данной функции может потребоваться обновление расширения браузера до версии 1.68/3.68.
   
1. Добавлено отображение количества аргументов у элемента **Ссылка на процесс (Process link)** с добавленной функцией подсветки. Теперь количество аргументов  отображается белым числом на синем фоне. Если были внесены изменения, такие как добавление или удаление аргументов, либо незаполнение всех полей, индикатор подсвечивается красным цветом, сигнализируя о необходимости сохранить изменения или завершить настройки перед продолжением работы.

1. Улучшен [редактор шаблонов OCR](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/tools/ocr-template-editor):
   -  Добавлено новое свойство `Язык шаблона`: Теперь можно задавать и сохранять язык распознавания текста в OCR-шаблонах, с автоматической установкой при загрузке шаблона.
   -  Добавлено свойство `Количество операций`: Определяет допустимое расстояние Левенштейна для текстовых блоков.
   -  Ограничения на использование регулярных выражений и количества операций: Свойства `Регулярное выражение (Replace)`, `Регулярное выражение (Match)` и `Количество операций > 0` теперь не могут использоваться одновременно.
   -  Улучшена работа с существующими шаблонами: при загрузке старых шаблонов необходимо вручную указать язык, чтобы избежать проблем с якорями при последующем использовании.

1. Улучшена функция проверки синтаксиса — добавлена возможность переключения между двумя подходами к валидации: новым алгоритмом на базе библиотек Actipro и алгоритмом, использующим библиотеки Microsoft CodeAnalysis.

1. Добавлено свойство `Активировать вкладку` в редактор шаблона браузерного селектора. При установленной галке робот автоматически переключается на вкладку в браузере, соответствующую заданным параметрам (URL, Заголовок, Индекс)  и производит необходимое действие (например, клик или ввод текста).

1. Добавлены актуальные версии WebDriver для браузеров Chrome, Yandex, Firefox (Gecko), Edge и Opera. Обновлены пути в WDBrowser для обеспечения совместимости с новыми именами файлов. Важно: версия WebDriver должна точно соответствовать версии вашего браузера. Использование более новой версии WebDriver с устаревшим браузером может привести к некорректной работе.

1. Добавлены новые свойства в элементы взаимодействия  с  Apache Kafka:
   -  [**Отправить сообщение Kafka**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_mq/el_mq_kafka/el_mq_kafka_send): добавлены свойства для настройки SSL и механизмов аутентификации, включая поддержку SCRAM-SHA-256, SCRAM-SHA-512, и OAuth Bearer, что упрощают интеграцию с защищенными средами.
   -  [**Получить сообщения Kafka**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_mq/el_mq_kafka/el_mq_kafka_receive): добавлены свойства, которые поддерживают расширенные механизмы аутентификации и шифрования, обеспечивая более безопасное получение сообщений из очередей Kafka. Также появилась возможность ожидания новых сообщений с улучшенным контролем через настройку таймаута.


## Исправленные ошибки 

1. Исправлена ошибка, из-за которой при отладке процесса с типом *Диаграмма* не происходил переход внутрь элементов, несмотря на активированную опцию В глубину.

1. Исправлена ошибка, возникавшая при создании библиотеки, если в проекте присутствовали переменные типа DataTable. Теперь процесс создания библиотеки выполняется корректно и без ошибок.

1. Исправлена ошибка System.OutOfMemoryException, возникающая при поиске с галочкой *Искать в закрытых* в Студии x86. Теперь поиск в закрытых ltw проектах осуществляется без возникновения ошибки.

1. Исправлена ошибка в чистом коде при использовании оператора else в отладчике чистого кода v2. Теперь, при выполнении блока if, блок else корректно пропускается, и отладка работает без ошибок.

1. Исправлено нарушение выполнения последовательности контейнеров внутри диаграммы Роботом из Оркестратора. Ранее в версии ядра v1 некорректно пропускались элементы.

1. Исправлено некорректное поведение в режиме Отладки (Debug) при установленной галочке `Продолжить при ошибке` в элементе **Ссылка на процесс**. Теперь при возникновении исключения внутри активности **TryCatch**, выполняются действия внутри блока **Catch**, как и должно быть.

1. Исправлена ошибка, при которой индикаторы (колбы) в элементе **Множественное присвоение** некорректно отображались и изменяли своё положение при добавлении новых строк. Теперь индикаторы корректно устанавливаются на все строки и остаются на месте при внесении изменений.

1. Исправлена ошибка, при которой процесс зависал после возникновения исключения во время выполнения. Теперь процесс корректно завершается после обработки исключения.

1. Исправлена ошибка работы старого шаблона поиска. Ранее возникала ошибка, при которой мастер чтения таблиц не мог получить данные из браузера.

1. Исправлена ошибка `Variable not found` в элементе **ForEach**, если в подпроцессе другой ForEach завершался с исключением. Теперь процесс корректно завершается без возникновения этой ошибки.

1. Устранена ошибка в работе элемента **SAP Table**, при которой данные из таблиц SAP могли некорректно считываться и сдвигаться в другие столбцы при экспорте в Excel. Теперь данные корректно считываются и записываются в нужные столбцы.

1. Устранена ошибка, которая возникала при запуске рекурсивного процесса с включенной опцией `Кэшировать`. Теперь запуск подпроцесса с активированной галкой `Кэшировать`, даже если процесс уже запущен (будь то при рекурсивном вызове или в параллельном потоке), не приводит к зависанию, и процессы корректно завершаются.

1. Исправлена ошибка, вызывавшая зацикливание при отладке в параллельных потоках, если причиной зависания был элемент, являющийся ветвью.

1. Исправлена ошибка, связанная с неполным заполнением объекта `Exception` в параллельных потоках. Теперь переменная исключения содержит массив исключений при запуске и отладке проекта.

## Улучшения Robot Runner

Добавлено интерактивное окно уведомления в **Primo RPA Robot Runner**. При запуске задачи с помощью Robot Runner теперь появляется интерактивное окно уведомления, где пользователи могут остановить процесс, используя соответствующую кнопку `Стоп`.

## Исправленные ошибки

Исправлена ошибка, при которой пользовательские настройки расписания в Robot Runner не учитывались. Теперь робот выполняется строго по заданному расписанию.

## Где найти

[**Скачать Primo RPA Studio**](https://disk.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FRelease%2FStudio)


[**Скачать Primo RPA Robot**](https://disk.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FRelease%2FRobot). 


Если у вас возникнут сложности с установкой или использованием данной версии, пожалуйста, обращайтесь к вашему менеджеру или в [наш чат поддержки в Telegram](https://t.me/primo_RPA_chat).

