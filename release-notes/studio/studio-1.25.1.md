#  Primo RPA Studio Windows  1.25.1

Данный документ описывает улучшения, изменения и исправления ошибок, внесенные в релиз **Primo RPA Studio** за январь 2025-го года.


## Обновления и улучшения (режим Pro)

1. Добавлена поддержка регулярных выражений **RegEx** в селекторах. 
1. Добавлена новая настройка **Открывать вкладки при отладке (Open closed tabs with breakpoints)** в англоязычной версии, которая позволяет автоматически открывать закрытые вкладки *.ltw-воркфлоу* с установленными точками останова во время отладки. Для включения настройки в Primo RPA Studio перейдите в меню **Файл** → **Настройки** → **Общие** → **Отладчик**. Установить галочку напротив опции **«Открывать закрытые вкладки с точками останова»**.
1. Добавлена возможность отображения часто используемых свойств напрямую на элементе. Введённые данные в параметрах активности автоматически синхронизируются с соответствующими свойствами элемента в правой части окна. По умолчанию функция отключена. 
 	- Для включения перейдите в Студию в раздел **Файл → Настройки → Общие → Элементы**, выберите версию `v2` и для процессов с типом "Диаграмма" установите галочку `Отображать дизайн элементов диаграммы`.

   В этом же окне встроен **редактор синтаксиса** (IntelliSense), который поддерживает автозаполнение методов и программных выражений.
   	- Для активации редактора синтаксиса перейдите в Студию в раздел **Файл → Настройки** и установите галочку в параметре **Использовать строчный редактор**.

1. Добавлен новый элемент **[Вход в систему (Login)](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_browser/el_login)**, позволяющий автоматизировать процесс авторизации на веб-ресурсах. Поддерживается работа в Chrome, Edge, Yandex, Firefox и через WebDriver.
1. В элементе **Фильтр диапазона (Filter Range)** реализована поддержка условий фильтрации ("равно", "не равно", "больше чем", "меньше чем") без удаления строк.
1. В новом редакторе шаблона реализован переключатель между типами селекторов: CSS и XPath с автозаполнением полей при выборе элемента.
1. Улучшена функция **Мастер захвата таблиц (Wizard)** в элементах **Прочитать Таблицу** в папке Браузер и **Чтение таблицы** в папке Рабочий стол. Мастер автоматически извлекает данные из таблиц на веб-страницах и предлагает удобный интерфейс для настройки параметров и предварительного просмотра данных. Функция включена по умолчанию.
1. В активностях **1С «Выполнить запрос»** и **«Выполнить код»** добавлено свойство **Не отключаться**, ускоряющее выполнение процессов. По умолчанию свойство отключено.
1. В редакторе шаблона добавлена возможность автоматического построения дерева селекторов в режиме «Браузер» на основе HTML-разметки, аналогично функциональности режима «Рабочий стол».
1. Добавлено свойство **Строгий поиск** в редакторе шаблонов, которое исключает пропуск слоев дерева элементов. По умолчанию свойство отключено.
1. Добавлено свойство **Игнорировать спецполя (Ignore special fields)** в элемент **Получить из очереди по фильтру (PeekQueueByFilter)** для процессов **Только код (Pure Code)**. Свойство позволяет получать элементы очереди с игнорированием специальных полей. По умолчанию свойство отключено.
1. Реализована возможность работы с веб-элементами на страницах, открытых в браузере Microsoft Edge в режиме эмуляции Internet Explorer (IE). Теперь можно выбирать и редактировать элементы как в режиме "Браузер", так и в режиме "Рабочий стол".
1. Добавлена возможность настройки задержки захвата элементов в разделе **Настройки → Общие → Пауза захвата**. Пользователи могут вручную установить значение задержки в секундах для более точного управления процессом поиска элементов.
1. Улучшен поиск в окне настроек Студии. Теперь поиск осуществляется по тексту самих настроек и подсказок к ним.
1. Обновлена тема Primo RPA Studio, добавлен новый дизайн окон программы.
1. Добавлена подсветка ошибок при использовании аргумента, удалённого из панели, в элементах «Присвоение», «Множественное присвоение», «Запись в журнал» и циклов, таких как «For Each» и «For Each для DataTable».
1. Обновлены скрипты для **[автоустановки](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/settings/autoinstall-browser-extension)** расширения **Primo RPA Extension**, используемого для взаимодействия с браузерными элементами в **Primo RPA Studio**. Процесс установки стал проще:  
	- Больше не требуется вручную проверять и исправлять версию расширения в скриптах — проверка выполняется автоматически.  
	- Нет необходимости запускать инсталлятор в каждом профиле пользователя.  
	- Добавлена поддержка установки расширения на базе манифеста **V3** для браузеров Chrome, Edge и Yandex.  
	- При наличии доступа к Интернету служба Google Update не изменяет установленную версию расширения, заданную скриптами, даже при автоматических обновлениях браузера.

1. Добавлена поддержка активности **Выполнить JS (ExecuteJS)** для расширений с Manifest V3.
1. Добавлена поддержка взаимодействия Primo RPA Studio с Java, начиная с версии JRE 7 Update 6 (7u6). Для работы с Java-элементами требуется включение Java Access Bridge. Это технология, обеспечивающая взаимодействие приложений на Java с инструментами вспомогательных технологий (assistive technologies), такими как программы для чтения экрана (screen readers) и системы автоматизации пользовательского интерфейса. Подробнее о Java Access Bridge можно узнать в [**официальной документации Oracle**](https://docs.oracle.com/javase/8/docs/technotes/guides/access/index.html).

## Исправленные ошибки 

1. Устранена ошибка при работе активности **Присоединиться к БД (ConnectDatabase)**, из-за которой подключение к базе данных PostgreSQL не выполнялось.
1. Исправлена ошибка в элементе **Добавить в очередь (Add to queue)**, из-за которой возникала ошибка при использовании переменной типа `Int32` в поле "Приоритет". Теперь поле корректно принимает переменные данного типа, и процесс выполняется без сбоев.
1. Исправлена ошибка в элементе **"Удалить из очереди"**, которая появлялась при удалении элементов со статусом **"Success"** из очереди с включённым свойством **"Физическое удаление"**. Теперь удаление таких элементов выполняется корректно.
1. Исправлена ошибка, при которой после удаления переменной и отмены изменений отображалась некорректная ошибка синтаксиса. Теперь переменная корректно восстанавливается.
1. Исправлена ошибка зависания робота при скрытии панели "Свойства" во время отладки. 
1. Исправлена ошибка, из-за которой при возобновлении отладки после нажатия кнопки **Пауза** происходил пропуск выполнения элементов. 
1. Исправлена при выполнении операций **Undo/Redo** после переноса корневых элементов в новую последовательность. Теперь появляется предупреждение о необратимости действия, что исключает возникновение логических конфликтов.
1. Исправлена проблема с чтением таблиц в браузере Internet Explorer. Проект корректно выполняется как с правами администратора, так и без них.
1. Исправлена ошибка, из-за которой сообщения (debug, info, error, network, test) продолжали отображаться в консоли, даже если все чекбоксы для типов сообщений были отключены.
1. Исправлена ошибка элемента **Запись в журнал (AddToLog)**, при которой в лог добавлялся дополнительный текст. Теперь лог содержит только указанный в элементе текст.
1. Обновлены библиотеки NuGet  до версии 5.11.6, что позволило устранить выявленные критические уязвимости.
1. Исправлена ошибка валидации в режиме Actipro, из-за которой невозможно было задать значение `null` по умолчанию для переменных типа `Nullable<T>` (например, `Nullable<Int32>` или `Int32?`). Теперь переменные создаются корректно с указанным значением `null`.
1. Исправлена ошибка в элементе **SAP Функция BAPI**, из-за которой параметры из входного поля `Options` не использовались, что приводило к выполнению без параметров. Теперь параметры корректно учитываются.
1. Исправлена ошибка в активности "Присутствие элемента", из-за которой в поле "Элементы" добавлялся только первый найденный элемент при снятой галочке "Быстрый поиск".
1. Исправлена ошибка, приводившая к продолжительному зацикливанию в активности **ForEach** при обработке некорректных значений массива в режиме отладки, из-за чего исключение не обрабатывалось в блоке **Catch**.
1. Устранена ошибка в работе **Desktop Anywhere (Primo Remote Agent)**, из-за которой элементы папки "Поколения 1" не работали корректно при выборке контролов.
1. Устранена ошибка, из-за которой элементы последовательности зависали при их перетаскивании в панель "Проект" или "Фрагменты кода".
1. Исправлена ошибка, из-за которой робот зависал при возникновении ошибки в процессе типа "Только код" в режиме Debug. Теперь робот корректно завершает выполнение или останавливается в блоке **try-catch** без зависания. При остановке в режиме Debug кнопка "Повторить шаг" стала недоступной, что предотвращает некорректное поведение.
1. Исправлена некорректная работа элемента **Переместить файл** в ситуациях, когда исходный файл недоступен. Если свойство "Перезаписать" активировано, а файл-источник отсутствует, целевой файл больше не удаляется.
1. Исправлена ошибка заполнения полей корректировки по **X/Y** в десктопной версии для элементов "Клик мышью" и "Перетаскивание".
1. Исправлено задвоение правил в анализаторе Primo RPA Studio. Теперь правила отображаются корректно, без дублирования.

## Обновления и улучшения (режим Citizen)

1. Добавлены логи выполнения каждого элемента в консоли. 


## Новые активности (в NuGet-пакетах)

1. **Primo.Office.P7**  
   NuGet-пакет для работы с российским офисным пакетом P7-Офис. Пакет предназначен для автоматизации работы с офисными документами. Устанавливается отдельно.  
   Подробнее о возможностях пакета и установке [здесь](https://docs.primo-rpa.ru/primo-rpa/release-notes/packages/windows/primo-office-p7).

2. **Primo.AI.Server**  
   NuGet-пакет для автоматизации взаимодействия с сервером интеллектуального распознавания данных Primo AI Server. Пакет включает активности для работы с модулями NLP и умного OCR. Устанавливается отдельно.  
   Инструкции по установке и описанию пакета доступны [здесь](https://docs.primo-rpa.ru/primo-rpa/release-notes/packages/windows/primo-ai-server/1.0.10).

3. **Primo.ART**  
   NuGet-пакет для мониторинга выполнения процессов. Пакет включает активности «Транзакция» и «Шаг» для управления шагами процессов и регистрации результатов. Устанавливается отдельно.  
   Узнать больше о пакете и способах установки можно [здесь](https://docs.primo-rpa.ru/primo-rpa/release-notes/packages/windows/primo.art/1.0.3).  
   Подробнее о продукте Primo ART — на [сайте](https://primo-art.ru/).

4. **Primo.Sap.Data.Hana**  
   NuGet-пакет для автоматизации взаимодействия с базой данных SAP HANA. Пакет поддерживает работу с большими наборами данных через DataTable и обеспечивает высокую скорость загрузки данных благодаря механизму `bulk insert`. Устанавливается отдельно.  
   Узнать больше о пакете и способах установки можно [здесь](https://docs.primo-rpa.ru/primo-rpa/release-notes/packages/windows/primo_sap_data_hana/1.0.0).


## Где найти

Загрузить дистрибутивы новой версии можно по следующим ссылкам:

[**Скачать Primo RPA Studio**](https://disk.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FRelease%2FStudio)

[**Скачать Primo RPA Robot**](https://disk.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FRelease%2FRobot). 


Если у вас возникнут сложности с установкой или использованием данной версии, пожалуйста, обращайтесь к вашему менеджеру или в [наш чат поддержки в Telegram](https://t.me/primo_RPA_chat).
