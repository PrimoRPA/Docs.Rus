 # Primo Studio 23.11
Раздел содержит описание изменений для версии приложения Primo Studio 23.11, выпущенной в ноябре 2023 года.

### Новые функции и улучшения

1. Реализован **LTools.Office.SDK** - набор инструментов и компонентов, предоставляющих доступ к функциональности таких приложений Microsoft Office, как Excel, Word, Outlook и Exchange. Описание работы с **LTools.Office.SDK** смотрите [здесь](https://github.com/PrimoRPA/Docs.Rus/blob/652-%D0%BF%D0%B5%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%D1%83-sdk/developers/sdk/LTools.Office.SDK/getting-started.md).

1. Добавлена возможность переключения между старым и новым редактором шаблона поиска. По умолчанию в Студии используется обновленный редактор. Чтобы изменить значение:
   * Перейдите в раздел **Файл > Настройки > Общие > Элементы** и установите чекбокс **Использовать старый редактор шаблона поиска по умолчанию**. 

     ![](<../../.gitbook/assets1/use-old-default-pattern-editor-studio.png>)
   
   * Для единичных случаев используйте команду контекстного меню **Открыть старый/новый редактор шаблона** (значение зависит от редактора по умолчанию). Команда добавлена для всех элементов, содержащих свойство **Шаблон поиска**. Эта функция не меняет редактор по умолчанию и не приводит к очищению ранее заполненных свойств шаблона.

1. Для [процессов](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process) RPA-проекта добавлено поле **Описание**. Оно доступно в форме создания/редактирования процесса и не является обязательным для заполнения.

   ![](<../../.gitbook/assets1/description-field-in-proccess-form-studio.png>)  

1. В контекстное меню элементов добавлены команды:
   * **Перенести элемент в try/catch** - позволяет переместить выделенный элемент в контейнер **Try-Catch**. Поддерживается множественный перенос элементов.
   * **Извлечь элемент из try/catch** - извлекает элемент или элементы из **Try-Cath**.

   ![](<../../.gitbook/assets1/move-element-to-try-catch.png>)

1. Улучшена работа с вложениями при чтении сообщений из MS Exchange. Теперь вложения в виде писем стали сохраняться в свойство Attachments объекта OMailMessage. Их можно обрабатывать как файлы, сохраняя на диск для дальнейшего использования (формат \*.eml).
1. Для элемента [**Чтение почты (Outlook)**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_outlook/el_outlook_readmail) добавлена возможность сортировки писем. За это отвечают новые свойства:
   * **Сортировать** - определяет, нужно ли сортировать письма по какому-либо полю. По умолчанию сортировка не используется.
   * **Направление** - определяет направление сортировки. По умолчанию задана сортировка по возрастанию (Ascending), которую возможно изменить на сортировку по убыванию (Descending).

   ![](<../../.gitbook/assets1/outlook-read-mail-sorting-parameters.png>)

1. Улучшена работа цикла [**Повтор попыток**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_retry) (Retry) для более гибкого управления процессом. Если для цикла включено свойство **Продолжить при ошибке**, то при возникновении исключения в одном из элементов цикла выполнение итерации начнется заново.
1. Улучшен процесс добавления новой переменной на панели **Переменные**. Теперь, при создании переменной, ей по умолчанию присваивается тип данных String. Если требуется использовать другой тип данных, можно изменить его в соответствующем поле. 
1. Для импортированных проектов улучшена функция проверки синтаксиса кода в значениях переменных и аргументов. Теперь, если у переменных и аргументов было заполнено значение по умолчанию, то система выполнит их проверку и подсветит возможные ошибки. Для этого в [настройках](https://docs.primo-rpa.ru/primo-rpa/primo-studio/settings#otladchik) Студии обязательно должен быть включен параметр **Проверять синтаксис**.
1. В Robot Runner добавлена информация о версии Runner'a, которую можно найти в разделе меню **Файл > О программе**. 


### Исправленные ошибки 

#### Шаблон поиска (селектор)

1. Устранена проблема, при которой наличие спецсимволов (например, `\`) в селекторах приводило к их некорректной работе. В рамках исправления была добавлена поддержка экранирования спецсимволов, включая спецсимволы в заголовках окон. 
1. Исправлена ошибка, исключавшая ввод текстовых значений в поле Index в редакторе шаблона поиска. Теперь ввод текста производится корректно, ограничение на количество символов отсутствует. 
1. Исправлена ошибка, при которой параметры CssSelector и Index не сохранялись при редактировании. 
1. Исправлена нестабильная работа инструмента **Выбрать элемент** ![](<../../.gitbook/assets/image (553).png>) в браузерах: он срабатывал не с первого раза. 
1. Исправлены ошибки в работе редактора шаблонов с Internet Explorer (IE):
   * не работала валидация шаблона для IE;
   * не определялись свойства селектора, если элемент **Клик мышью** был помещен в контейнер браузера IE;
   * некорректно определялся тип браузера, если из текущего шаблона попытаться перевыбрать элемент в другом браузере.
  
#### Расширение браузера

1. Исправлена проблема, связанная с работой расширения браузера после переустановки или обновления Студии. 

#### Отладка и панель «Вывод»

1. Исправлена ошибка, когда режим отладки не прекращался при закрытии RPA-проекта через меню **Файл > Закрыть проект**.
1. Исправлена ошибка, которая не позволяла изменить текущие значения переменных в панели **Вывод** во время приостановки отладки на исключении. 
1. Исправлена ошибка с неработающим предпросмотром значений словаря (Dictionary) в панели **Вывод**, если один из элементов пустой (null).
1. Внесены исправления в работу отладки. Теперь, если включена настройка **Приостанавливать отладку на исключении** и возникло исключение в элементе **IF-Else**, то функция **Повтор шага** не прекращает процесс, а возобновляет его с места, где произошло исключение.
1. Исправлена ошибка, когда при отключении в настройках отладчика параметра **Показывать консоль робота** эта консоль все равно отображалась, хоть и без записи логов.


#### Зависимости

1. Исправлена некорректная установка зависимости из NuGet. Ранее, при выборе не последней версии зависимости и ее установке, в окне **Управление зависимостями**, на вкладке **Студия**, отображалась последняя версия. После исправления этой ошибки отображается выбранная версия зависимости. 
1. Исправлена ошибка, при которой невозможно было обновить версию установленной зависимости из окна **Управление зависимостями**. 


#### Работа элементов

1. Исправлена ошибка в элементе **Отправить сообщение** (Outlook): ранее не сохранялся текст основного письма при ответе на него.
1. Исправлена ошибка, из-за которой переменные и их значения не сохранялись в элементе **Множественное присвоение** при сохранении процесса и его последующем открытии. 
1. Внесены исправления для элемента **Завершить приложение**. Теперь он корректно работает как при присоединении по заголовку окна, так и при присоединении по имени процесса. 
1. Исправлены следующие ошибки в работе элемента **Try-Catch**:
   * при отладке и включенной настройке **Останавливать отладку на исключении** процесс не приостанавливался на элементе **Исключение** в блоке Try;
   * не всегда выполнялся блок Finally;
   * при выполнении элемента **Выход из процесса** в Try-Catch вместо выхода из процесса происходило бесконечное цикличное выполнение блока Finally;
   * в консоли отображалась ошибка «Завершение последовательности из-за исключения» почти после каждого исключения в блоках Try-Catch.
1. Исправлена проблема с обновлением скриншота в окне элемента **Клик мышью**, когда выбор элемента производился через редактор шаблона поиска. 
1. Исправлена проблема, связанная с зависанием на элементе **Извлечь архив**. Ошибка выявлялась на некоторых итерациях этого элемента, в то время как на других итерациях разархивирование происходило за считанные секунды.
1. Исправлена ошибка в работе элемента **Параллельные потоки**: ранее, при возникновении исключений внутри веток, происходило дублирование действий и логов в консоли. 
1. Исправлена ошибка в работе элемента **Раскладка**: не выполнялась смена языка при выборе горячей клавиши `Alt Shift`.
1. Устранено зависание процесса при выполнении элемента **Ссылка на процесс** в версии Студии 23.9.501.
1. Устранена проблема, когда не работали элементы **Получить письма (IMAP)** и **Переместить в папку (IMAP)** с указанным портом 143 и снятой галочке в свойстве `SSL`. 

#### Другие исправления

1. Исправлена ошибка, приводившая к потере изменений в текущем проекте при создании нового проекта.
1. Исправлена нестабильная работа поиска в панели **Элементы**.
1. Исправлена логика перехода к найденному элементу из окна поиска (Ctrl+F) в Студии. Ранее переход осуществлялся без автоматического позиционирования на найденном элементе, в результате чего пользователю приходилось использовать прокрутку рабочей области, чтобы его увидеть. Теперь позиционирование работает, за исключением случаев, когда элементы находятся в свернутых контейнерах. 
1. Исправлено неправильное поведение при копировании и перетаскивании элементов, которое зависело от порядка нажатия клавиши `Ctrl`. Теперь копирование и перетаскивание работают корректно, независимо от последовательности нажатия `Ctrl`. 
1. В процессе с типом **Последовательность** исправлена ошибка, когда при перемещении нескольких элементов комбинацией `Ctrl` + левая кнопка мыши переносился только один элемент. 
1. В последовательностях исправлена ошибка, когда при попытке перетащить элементы мышкой (drag-and-drop), они не переносились.
1. Исправлена ошибка «Ссылка на объект не указывает на экземпляр объекта», которая возникала при использовании функции **Закомментировать** для элементов, находящихся в разных контейнерах. 
1. Исправлена ошибка, которая возникала при использовании функции **Раскомментировать** для элементов, не находящихся в комментарии. Данная функция в контекстном меню отображалась для них ошибочно.
1. Устранено зависание процесса с типом **Только код** (Pure code), если в нем была установлена точка остановки.
1. Устранена проблема, когда не удавалось запустить процессы с типом **Только код** (Pure code), если в настройках Студии для отладчика чистого кода была выбрана версия ядра `v2`.


## Где найти
[Скачать дистрибутив Primo RPA Studio Enterprise](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FStudio).

[Скачать дистрибутив Primo RPA Robot](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FRobot):
* **Primo RPA Robot 1.23.11** - предназначен для установки на локальной рабочей станции. Выступает в роли цифрового ассистента пользователя. Дистрибутив поставляется в разрядности x64 и x86.
* **Primo RPA Robot Orchestrator 1.23.11** - предназначен для автоматической установки Оркестратором. Дистрибутив поставляется в разрядности x64 и x86.
