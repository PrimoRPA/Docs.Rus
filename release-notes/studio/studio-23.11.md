# Primo Studio 23.11
Раздел содержит описание изменений для версии приложения Primo Studio 23.11, выпущенной в ноябре 2023 года.

### Новые функции и улучшения

1. В контекстное меню элементов добавлены команды:
   * **Перенести элемент в try/catch** - позволяет переместить выделенный элемент в контейнер **Try-Catch**. Поддерживается множественный перенос.
   * **Извлечь элемент из try/catch** - извлекает элемент или элементы из **Try-Cath**.

   ![](<../../.gitbook/assets1/move-element-to-try-catch.png>)

1. Для процессов добавлено поле **Описание**. Оно доступно в форме создания/редактирования процесса и не является обязательным для заполнения.

   ![](<../../.gitbook/assets1/description-field-in-proccess-form-studio.png>)  

1. Улучшена работа с вложениями при чтении сообщений из MS Exchange. Теперь вложения в виде писем стали сохраняться в свойство Attachments объекта OMailMessage. Их можно обрабатывать как файлы, сохраняя на диск для дальнейшего использования (в формате \*.eml).
1. Для элемента [**Чтение почты (Outlook)**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_outlook/el_outlook_readmail) добавлена возможность сортировки писем как по возрастанию, так и по убыванию (только даты??? или все-таки выбранного поля письма? проверить). За это отвечают новые свойства **Сортировать** и **Направление**.

   ![](<../../.gitbook/assets1/outlook-read-mail-sorting-parameters.png>)

1. Улучшена работа цикла [**Повтор попыток**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_retry) (Retry) для более гибкого управления процессом. Если для цикла включено свойство **Продолжить при ошибке**, то при возникновении исключения в одном из его элементов, выполнение итерации начнется заново.
1. Улучшен процесс добавления новой переменной на панели **Переменные**. Теперь, при создании переменной, ей по умолчанию присваивается тип данных String. Если требуется использовать другой тип данных, можно изменить его в соответствующем поле. 
1. Для импортированных проектов улучшена функция проверки синтаксиса кода в значениях переменных и аргументов. Теперь, если у переменных и аргументов было заполнено значение по умолчанию, то система выполнит их проверку и подсветит возможные ошибки. В [настройках](https://docs.primo-rpa.ru/primo-rpa/primo-studio/settings#otladchik) Студии обязательно должен быть включен параметр **Проверять синтаксис**.
1. В Robot Runner добавлена информация о версии Runner'a, которую можно найти в разделе меню **Файл > О программе**. 


### Исправленные ошибки 

**Работа селекторов:**

1. Устранена проблема, при которой наличие бэкслеша в селекторах приводило к их некорректной работе. Теперь функция **Отобразить компонент** работает правильно, даже если в заголовке (title) присутствуют заэкранированные символы. https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7578/?workitem=3238
1. Исправлена проблема с вводом текста в поле Index в селекторе. Теперь ввод допустимых значений в поле Index корректно работает, без ограничения на количество вводимых символов. В названии переменной можно использовать цифры, символ подчеркивания и латиницу в обоих регистрах. https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7738
1. Исправлена ошибка, при которой параметры CssSelector и Index не сохранялись при редактировании. Теперь поиск элемента работает только с корректными значениями, иначе выводится сообщение «Элемент не найден». https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/7682
1. Внесены изменения в работу выбора окон с заголовками, содержащими специальные символы, такие как `""`. Теперь при использовании селектора автоматически происходит экранирование этих символов, что предотвращает появление ошибки Bad JSON escape sequence. https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/3257
1. Проблема назначения браузерных селекторов https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/3222

**Работа браузера:**

1. Исправлена проблема, связанная с работой расширения браузера после переустановки или обновления Студии. Теперь расширение будет работать корректно во всех профилях, где оно было установлено, и не будет зависеть от обновлений или переустановки Студии. https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/739

**Работа с переменными и отладкой:**

1. Внесены исправления в работу отладки. Теперь при включенной настройке **Приостанавливать отладку на исключении** и возникновении исключения в элементе **IF-Else** функция **Повтор шага** не прекращает процесс, а возобновляет его с места, где произошло исключение.
1. Исправлена ошибка, когда режим отладки не прекращался при закрытии RPA-проекта через меню **Файл > Закрыть проект**.
1. Исправлена ошибка, которая не позволяла изменить текущие значения переменных в панели **Вывод** во время приостановки отладки на исключении. 
1. Исправлена ошибка с неработающим предпросмотром значений словаря в панели **Вывод**, если один из элементов пустой. Теперь форма предпросмотра корректно открывается и отображает значения переменной словаря при отладке процесса. https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/1086
1. Исправлена ошибка, из-за которой переменные и их значения не сохранялись в элементе **Множественное присвоение** при чтении/сохранении процесса. Теперь при сохранении и последующем открытии процесса все внесенные данные корректно отображаются. 

**Другие исправления:**

1. Исправлены расписания в раннере. (?) Назаренко
1. В Outlook не сохранялся текст основного письма при ответе на него. Ошибка исправлена. 
1. Исправлено неправильное поведение при копировании и перетаскивании элементов, которое зависело от порядка нажатия клавиши `Ctrl`. Теперь копирование и перетаскивание работают корректно, независимо от последовательности нажатия `Ctrl`. 
1. Исправлена логика перехода к найденному элементу при использовании функции поиска (Ctrl+F) в Студии. Ранее переход по найденному элементу из списка результатов осуществлялся без автоматического позиционирования на этом элементе, в результате чего пользователю приходилось использовать прокрутку рабочей области. Теперь переход к соответствующему элементу в рабочей области осуществляется, за исключением случаев, когда элементы находятся в свернутых контейнерах. 
1. Исправлена ошибка, связанная с некорректной установкой зависимости из NuGet. Ранее, при выборе не последней версии зависимости и ее установке, в окне **Управление зависимостями** отображалась последняя версия, а не выбранная. После исправления этой ошибки в окне **Управление зависимостями** на вкладке **Студия** отображается выбранная версия зависимости. 
1. Исправлена ошибка, при которой нельзя было установить зависимость на предыдущую версию из окна **Управление зависимостями**. Теперь можно устанавливать и обновлять на предыдущие версии зависимости. https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_boards/board/t/Studio%20Team/Stories/?workitem=3233
1. Исправлена ошибка, приводившая к потере изменений при создании нового проекта. Ранее, при создании нового проекта, не сохранялись изменения в предыдущем проекте, а также не появлялось окно с вопросом о сохранении данных. Теперь данное окно появляется.
1. Внесены исправления для элемента **Завершить приложение**. Теперь он корректно работает как при присоединении по заголовку окна, так и при присоединении по имени процесса. 
1. Исправлена ошибка «Ссылка на объект не указывает на экземпляр объекта», которая возникала при использовании функции **Закомментировать** для элементов, находящихся в разных контейнерах в Студии версии 23.8.4 (Enterprise). Теперь комментирование происходит корректно, и элементы правильно помещаются в соответствующий контейнер. https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_boards/board/t/Studio%20Team/Stories/?workitem=4193
1. Исправлена ситуация, связанная с перемещением нескольких элементов последовательности при использовании комбинации клавиши `Ctrl` и мыши. Теперь пользователи могут легко перемещать несколько элементов, удерживая `Ctrl`. https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/3262
1. Исправлена ошибка, возникавшая при выполнении элемента **Выход из процесса** в контейнере **Try-Catch**. Ранее, при наличии этого элемента внутри **Try-Catch**, процесс не завершался корректно, и вместо выхода из процесса происходило бесконечное цикличное выполнение блока Finally. Теперь процесс завершается корректно по достижении элемента **Выход из процесса**, без выполнения блока Finally.
1. Исправлена проблема с обновлением скриншота в окне элемента **Клик мышью**, когда выбор элемента производился через редактор шаблона поиска. Теперь скриншот корректно обновляется при выборе нового элемента в редакторе.
https://azure-dos.s1.primo1.orch/PrimoCollection/Studio/_workitems/edit/3205
1. Исправлена проблема, связанная с зависанием на элементе **Извлечь архив**. Оно проявлялось на некоторых итерациях этого элемента, в то время как на других итерациях разархивирование происходило за считанные секунды.
1. Исправлена ошибка в работе элемента **Параллельные потоки**: ранее, при возникновении исключений внутри веток, происходило дублирование действий и логов в консоли. 
1. Исправлена ошибка в работе элемента **Раскладка**: не выполнялась смена языка при выборе горячей клавиши `Alt Shift`.

## Где найти
[Скачать дистрибутив Primo RPA Studio Enterprise](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FStudio).

[Скачать дистрибутив Primo RPA Robot](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FRobot):
* **Primo RPA Robot 1.23.11** - предназначен для установки на локальной рабочей станции. Выступает в роли цифрового ассистента пользователя. Дистрибутив поставляется в разрядности x64 и x86.
* **Primo RPA Robot Orchestrator 1.23.11** - предназначен для автоматической установки Оркестратором. Дистрибутив поставляется в разрядности x64 и x86.
