#  Primo RPA Studio Windows  1.25.3

Данный документ описывает изменения, улучшения и исправления ошибок, внесенные в релиз **Primo RPA Studio** за март 2025 года.
Дата релиза: 14.03.2025

## Новые возможности и улучшения (режим Pro)


1.  Создана новая версия **Try-Catch (WFTryMultiCatch)** для Sequence:  
   - Добавлена возможность выбора типа ошибки в блоке *Catch*.  
   - Добавлена кнопка *"Добавить Catch"* для создания нескольких обработчиков ошибок.  
   - Старая версия Try-Catch (WFTryCatch) осталась без изменений и перенесена в **Поколение 1**.

 ![](<../../.gitbook/assets1/list_catch_new.png>)


2. Добавлен новый элемент перехвата ошибок **Try-Catch** в диаграмме. Он позволяет задавать разные пути обработки ошибок в процессе. Если создаются дублирующие переходы, система выдает ошибку.

 ![](<../../.gitbook/assets1/diagramm_catch.jpg>)

3. Оптимизирована работа активностей **Установить ресурс** и **Получить ресурс**. Теперь если один робот блокирует ресурс, а другой пытается его получить, возникает ошибка `Conflict`, и запрос к первой версии сервиса не выполняется.

4. Добавлены кнопки выбора для автоматического определения параметров в активностях. Ранее пользователю приходилось вручную указывать параметры, такие как тип браузера, URL, заголовок вкладки, имя процесса и другие. Теперь этот процесс автоматизирован:  
   - *"Открыть браузер"* – кнопка *"Выбрать браузер"* сама определяет и вписывает тип браузера, а также подставляет *URL*.  
   - *"Присоединиться к браузеру"* – кнопка *"Выбрать браузер"* сама заполняет *заголовок открытой вкладки* и *URL*.  
   - *"Активировать вкладку браузера"* – теперь кнопка *"Выбрать вкладку"* сама заполняет *заголовок вкладки и URL*.  
   - *"Вход в систему"* – добавлена кнопка *"Выбрать вкладку"*.  
   - *"Уничтожить процесс"* – добавлена кнопка *"Выбрать процесс", которая сама определяет и вписывает **имя процесса и заголовок приложения*.  
   - *"Присоединиться к приложению"* – теперь кнопка *"Выбрать приложение"* сама определяет и заполняет *имя процесса и заголовок приложения*. 

5. Добавлена поддержка использования переменных и простых выражений в поле выбора Index в большом редакторе шаблона.
   - Теперь можно использовать выражения, например: {variable}, {variable[0]} {variable.ToString()}, {DateTime.Now.Day}; ..." 
   - Добавлена кнопка **"Валидация настроек шаблона"** для проверки работы выражений.  

 ![](<../../.gitbook/assets1/templ_edit_variable.jpg>)



6. В Редакторе шаблона добавлена возможность кликать по текущей активной вкладке браузера. Теперь при установленном флажке "Активировать вкладку", если несколько страниц соответствуют заголовку/url, одна из них уже активна, а **Индекс вкладки** не задан, клик выполняется по активной текущей вкладке, а не по первой найденной.

7. Улучшен функционал элемента **To Do** и **Комментарий**:  
- Добавлена возможность комментирования прямо в рабочей области.  
- Реализована поддержка переноса строк в комментариях.  
- Для элемента **To Do** добавлен переключатель статуса *Выполнено / Не выполнено*.  
- Во вкладке **To Do** теперь отображается общий статус и количество выполненных шагов. 

![](<../../.gitbook/assets1/Todo_new_element.png>)

8. Добавлена подсветка ошибок при использовании аргумента, удалённого из панели, для активностей *«Присвоение», «Множественное присвоение», «Запись в журнал»* и циклов *«For Each» и «For Each для DataTable»*.

9. Улучшено контекстное меню: 
   - При нажатии *правой кнопкой мыши* на активности теперь доступны *"Удалить элемент"* и *"Вставить"*.  
   - Раздел *Буфер обмена* с кнопками удалён из главной панели.
   
![](<../../.gitbook/assets1/buffer_copy_delete.png.jpeg>)

10. В малом редакторе шаблона добавлена кнопка **Строгий поиск**. Теперь при построении дерева через пикер можно включить режим строгого поиска, аналогично основному редактору шаблона. Этот режим учитывается при валидации и построении индексов. Доступнов в режиме *Рабочий стол*.

![](<../../.gitbook/assets1/strict_search_editor.png>)

11. Обновлён дизайн кнопок **RegEx** (регулярных выражений).  
   - Улучшено *описание всплывающей подсказки*.  

![](<../../.gitbook/assets1/regex_new_win.jpg>)



## Исправленные ошибки в Primo RPA Studio


1. Исправлена ошибка, возникавшая при вызове процесса через *"Ссылка на процесс"*, если в нём присутствовал элемент **Исключение (Throw)**.
1. Исправлена ошибка, из-за которой процесс зависал при отладке, если в кастомной библиотеке присутствовал элемент **Throw**. Теперь выполнение корректно переходит в блок **Catch**, и процесс не зависает.
1. Исправлена ошибка, из-за которой робот зависал при возникновении исключения в подпроцессе, вызванном из процесса Чистого кода. Теперь процесс и отладка завершаются корректно, без зависаний.
1. Исправлена ошибка *NullReferenceException* при открытии процесса, если в блоке **Try/Catch** содержится отсутствующая активность *WFMissing*. Теперь процесс корректно загружается.
1. Исправлена работа функции **В глубину** в диаграммах. Теперь при её *выключении* отладка выполняется на текущем уровне, без проваливания вглубь подпроцессов.
1. Исправлена ошибка валидации активности **Выполнить скрипт VB**, из-за которой появлялось предупреждение *Вызывающий поток не может получить доступ к данному объекту...*. Теперь при указании пути к файлу предупреждение от валидатора отсутствует. 
1. Исправлена ошибка, из-за которой в браузерном редакторе шаблона нельзя было создать новый родительский селектор для самого верхнего уровня.
1. Исправлена ошибка, из-за которой в большом редакторе шаблона не обновлялся отредактированный слой при добавлении или удалении нестандартного параметра селектора. Теперь внесённые изменения сразу отображаются в окне "путь до элемента".
1. Исправлена ошибка, из-за которой активность **Записать формулу в ячейку** не работала с драйвером *Interop*. Теперь запись формулы в диапазон ячеек выполняется корректно.
1. Исправлена ошибка некорректной передачи исключений в отладке диаграммы — теперь корректно отображаются повторные исключения.
Исправлена ошибка, из-за которой записи в консоли дублировались при повторном нажатии кнопок *Запустить процесс* или *Отладить процесс*. 
1. Исправлена ошибка при раскомментировании нескольких активностей — теперь при выборе нескольких элементов и нажатии **Раскомментировать** все выбранные активности корректно раскомментируются.
1. Исправлены ошибки валидации *Actipro*, из-за которых валидация синтаксиса могла показывать несуществующие ошибки.




## Исправленные ошибки в Primo RPA Robot

1. Исправлена ошибка, из-за которой установленные отдельно робот-раннеры (x64 и x32) не открывались. Теперь раннеры запускаются корректно, и проекты выполняются без ошибок.
2. Исправлена ошибка, из-за которой Robot Runner 1.25.1.2 не запускал проекты Citizen. Теперь проекты корректно запускаются через раннер.




## Где найти


[*Скачать новую версию Primo RPA Studio*](https://disk.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FRelease%2FStudio)

[*Скачать новую версию Primo RPA Robot*](https://disk.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FRelease%2FRobot). 


Если у вас возникнут сложности с установкой или использованием данной версии, пожалуйста, обращайтесь к вашему менеджеру или в [наш чат поддержки в Telegram](https://t.me/primo_RPA_chat).
