# Primo Studio 1.24.6

История изменений в Primo Studio для Windows за июнь 2024-го года. 

Информацию по обновленным релизам версии 1.24.6 можно найти в статьях:

* [Студия 1.24.6.13](https://docs.primo-rpa.ru/primo-rpa/release-notes/studio/studio-1.24.6/studio-1.24.6.13)
* [Студия 1.24.6.17](https://docs.primo-rpa.ru/primo-rpa/release-notes/studio/studio-1.24.6/studio-1.24.6.17)
* [Студия 1.24.6.18](https://docs.primo-rpa.ru/primo-rpa/release-notes/studio/studio-1.24.6/studio-1.24.6.18)
* [Студия 1.24.6.22](https://docs.primo-rpa.ru/primo-rpa/release-notes/studio/studio-1.24.6/studio-1.24.6.22)


## Обновления и улучшения (режим Pro)

1. Для расширения Primo RPA Extension добавлена совместимость с [Манифестом V3](https://developer.chrome.com/docs/extensions/develop/migrate/what-is-mv3?hl=ru), новым стандартом от Google. Использование Manifest V3 поможет избежать проблем с совместимостью в будущих версиях браузеров на платформе Chromium (Chrome, Yandex, Edge). Поскольку расширение на базе Манифеста V3 является новым, рекомендуется сначала проверить работоспособность решения в Студии или тестовом контуре, и только затем использовать в продуктивной среде.

2. Добавлен элемент [**Установить пароль** (SetPassword)](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_excel/el_excel_setpassword) для установки пароля на Excel файлы.
3. Обновлено расширение Primo RPA Extension. Новая версия расширения поддерживает взаимодействие с веб-клиентом 1С, включая возможность выбирать шаблон поиска с помощью xPath. Улучшение распространяется на обе версии Манифеста.
4. Добавлен элемент [**Заблокировать ресурс** (Lock asset)](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_orch/els_assets/lock_asset).
5. Оптимизирована функциональность элемента **Запись в журнал**: ранее при работе в параллельных потоках наблюдались проблемы с выводом сообщений в консоль, включая их дублирование и некорректное отображение.
6. Добавлена кнопка **Приостановить отладку**. Ранее эта функция была доступна только для процессов с типом **Последовательность**, теперь она позволяет приостановить отладку и для процессов с типом **Диаграмма** и **Чистый код**.
7. Обновлен пакет Primo.Office.Pdf до версии 1.1.0: 
   - Добавлен элемент [**Получить форму XFA**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_extra/els_pdf/el_getxfaform). 
   - В элементе [**Чтение таблицы**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_extra/els_pdf/el_gettable) добавлено свойство `Ядро`, в котором можно выбрать компонент для обработки pdf-документа. 
8. Улучшена работа Студии при использовании `Selenium WebDriver`: теперь корректно поддерживается присоединение к браузеру через переменную instance.
9. Добавлен новый шаблон проекта **Mail process**, который позволяет использовать электронную почту как очередь. Шаблон доступен в Primo RPA Studio на английском и русском языках.
10. Улучшена работа окна **Редактор шаблона поиска**:
   * Улучшено автоматическое отображение иерархии шаблона поиска при его открытии. Только для составных селекторов.
   * Удаление выделенного элемента иерархии с помощью клавиши `DEL`.
   * После выполнения команды меню `Поменять текущий селектор на выбранный` в иерархии (дереве) шаблона поиска изменяется только текущий элемент селектора, без перестроения дерева.
   * После успешного поиска элемента выделение в дереве контролов (UI-инспекторе) перемещается на выделенный элемент. Реализовано только для десктопных селекторов.
11. Расширены функции поиска в проекте — теперь возможно [заменить](https://docs.primo-rpa.ru/primo-rpa/primo-studio/projects/search) найденное значение на значение, указанное пользователем. Функция замены призвана сократить время, требуемое для внесения изменений в RPA-проект. По умолчанию замена недоступна — чтобы активировать функцию, включите в [настройках](https://docs.primo-rpa.ru/primo-rpa/primo-studio/settings#obshie) Студии параметр **Найти и заменить**.
12. При запуске Robot Runner'a стал отображаться экран загрузки, сигнализирующий пользователю о том, что процесс осуществляется корректно, и нет необходимости повторно запускать приложение.
13. Улучшена работа элемента **C# Script**:
    - Восстановлены кнопки вызова окна редактирования в элементах WFJSScript, WFPythonScript и WFPSScript.
    - Добавлена проверка на наличие оператора `return` при включенной опции `Обновлять переменные`.
14.  Добавлено предупреждение при несовпадении типа переменной с типом входных данных в элементе **Присвоение** (Assign).
15. Улучшена производительность робота, обеспечивая более быструю и эффективную работу.
16. Расширен функционал элемента **Перетаскивание** (drag-and-drop). Теперь при перевыборе элемента через дерево элементов у атрибута `Назначение` процесс корректно отрабатывает и элемент успешно перетаскивается.
17. Добавлена поддержка селекторов XPath для элементов браузера, что позволяет создавать селекторы с помощью XPath наряду с CSS-селекторами. Новая функциональность работает для расширений и вебдрайверов, но не поддерживается в режиме IE.



## Исправленные ошибки (режим Pro)

1. Исправлена ошибка, при которой в редакторе шаблона для десктопных приложений элементы не подсвечивались при проведении валидации. Теперь при валидации элементы успешно подсвечиваются.
3. Исправлена ошибка элемента **Параллельный поток** при отладке. Теперь после возникновения исключения в потоке отладка продолжается в оставшихся потоках, и прекращается только после возникновения исключения во всех потоках.
4. Устранена ошибка, при которой проект, опубликованный из студии как `x86`, сохранялся как `x64` в Оркестраторе. Теперь заданная разрядность из Студии корректно сохраняется в Оркестраторе.
5. Исправлена ошибка, при которой изображения (скриншоты) не отображались в активностях **Клик мыши** или **Получить текст** после выбора элементов селектором. Теперь после выбора селектора скриншот корректно отображается в активностях.
6. Исправлена ошибка, при которой селектор не перевыбирался в предварительном редакторе шаблона. Теперь селектор успешно перевыбирается и при валидации подсвечивается новый селектор.
7. Исправлена ошибка при работе элемента **Присвоение**. Ранее появлялось указание на ошибку в виде восклицательного знака.
8. Устранена ошибка, при которой статус `Изменено` (звездочка в названии вкладки) не исчезала при нажатии на кнопку **Сохранить проект**. 
9. Исправлена ошибка в элементе **Редактировать диаграмму**. Теперь свойство `Изменить заголовок оси` корректно отображается и применяет заголовок к правильной оси.
10. Исправлена ошибка `Обнаружено неоднозначное соответствие` при открытии процесса. Ранее ошибка возникала при наличии в проекте элемента WFToast.
1. В новом редакторе шаблона исправлена валидация десктопных селекторов, работающих с типом автоматизации UIAUTOMATION. 
1. В новом редакторе шаблона исправлено сообщение о результате валидации, отображаемое при превышении таймаута поиска. 
1. В предварительном редакторе шаблона изменен цвет шрифта на вкладке **Код**. Ранее, при выборе темной темы Студии, цвет кода затруднял понимание данных.
1. Исправлена ошибка в элементе **Функция BAPI**, возникавшая после нажатия кнопки Refresh в окне с функцией. 
1. Исправлена ошибка, из-за которой циклы ForEach некорректно работали с виртуальными переменными, если в цикле выполнялся вызов подпроцесса. 


## Режим Citizen

1. Исправлена ошибка сброса панелей. Ранее панель **Элементы** заменялась панелью **Фрагменты кода**.


## Где найти

[Скачать Primo RPA Studio 1.24.6.22](https://disk.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FLTS%2FStudio%2F1.24.6).

[Скачать Primo RPA Robot 1.24.6.22](https://disk.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FLTS%2FRobot%2F1.24.6).

