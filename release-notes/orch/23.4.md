# Обновления в версии Оркестратора 23.4

Примечания к выпуску Оркестратора 23.4 описывают изменения для версии приложения, выпущенной в апреле 2023 года.

### Новые функции
1. Добавлена возможность настраивать стратегию очереди проектов отдельно для каждого тенанта. Настройки осуществляются в конфигурационном файле WebApi в секции `Tenants` в параметре `RpaProjectQueueProcessingType`. Стратегия на уровне всех тенантов (глобальная), как и ранее, устанавливается в разделе UI Оркестратора [**Настройки > Стратегия очереди проектов**](https://docs.primo-rpa.ru/primo-rpa/orchestrator/settings/projects-queue). Если для тенанта не задана стратегия в конфигурационном файле, то будет использоваться глобальная.
1. При [переразвертывании робота](https://docs.primo-rpa.ru/primo-rpa/orchestrator/basics#razvertyvanie-robota) стало возможным изменить версию ядра в одноименном параметре. Переразвертывание осуществляется в разделе UI Оркестратора **Роботы > Все роботы**. 
1. [В журнал Оркестратора](https://docs.primo-rpa.ru/primo-rpa/orchestrator/monitoring/orch-log) добавлен атрибут событий **operationKey** (Код операции). По его значению можно фильтровать данные таблицы: отобразятся все события в рамках указанной операции. Код есть только у тех событий, которые связаны с роботом.
1. В журнал Оркестратора добавлена детализация событий в столбец **EntityData**. Теперь в нем отображается информация, связанная с владельцем события (например, имя), ID и прочие метаданные.
1. В журнал Оркестратора добавлены [события](https://docs.primo-rpa.ru/primo-rpa/orchestrator/appendix/appendix3):
   * Проект запущен по заданию и еще не завершен (RobotService);
   * Проект запущен по заданию и еще не завершен (RobotStart);
   * Проект запущен в максимальном количестве экземпляров (RobotService);
   * Проект запущен в максимальном количестве экземпляров (RobotStart);
   * Проект запущен в максимальном количестве экземпляров (Queue).
1. Добавлена возможность управлять таблицами журналов робота и Оркестратора в разделе [**Настройки > Журналы**](https://docs.primo-rpa.ru/primo-rpa/orchestrator/settings/journals). На данный момент функция реализована только для PostgeSQL и позволяет:
   * удалять выбранную секцию журнала по кнопке **Удалить**;
   * выгружать дамп выбранной секции по кнопке **Сделать дамп**.
1. [Задания](https://docs.primo-rpa.ru/primo-rpa/orchestrator/basics/tasks) по расписанию стало возможным настраивать на закрытие процесса робота, который уже выполняет проект. Включить настройку можно в разделе создания задания по расписанию в параметре **Завершение робота**. При наступлении заданного в расписании времени выполнение задания роботом будет завершено.
1. В разделе меню **RPA-проекты > Все RPA-проекты** стало доступной функция массового удаления роботов, привязанных к проекту. Для этого требуется выделить проект и нажать кнопку **Все роботы проекта**, после чего отметить всех или несколько роботов, связи с которыми требуется удалить.
1. Блокировка робота Агентом стала настройкой по умолчанию. Настройка помогает избежать возможных накладок при интенсивной работе робота. Управление блокировкой осуществляется в конфигурационном файле WebApi в секции `RobotStart` в параметре `UseAgentLock`. 
1. Установлен запрет на ручной запуск (без задания) проекта с аргументами, поскольку аргументы автоматически привязываются к заданию.
1. Добавлена возможность использовать SSL-сертификат для брокера сообщений RabbitMQ. 
1. Улучшена работа с установкой соединений у RabbitMQ. 
1. Данные в таблице RPA-проектов стали сортироваться на стороне сервера (ранее - постранично на клиенте), чтобы сделать результат сортировки точнее.
1. Оптимизирована работа мониторинга: сокращено время отклика формы на большом объеме записей (например, свыше 20 млн).
1. Улучшено отображение журнала Оркестратора: ускорена загрузка страницы.

### Исправленные ошибки
1. При добавлении версии проекта возникала ошибка: в параметрах проекта устанавливались значения по умолчанию. Под параметрами подразумеваются такие настройки проекта в Оркестраторе, как **Закрыть RDP-сессию**, **Не повторять в очереди проектов** и т.п. Теперь значение параметров будет соответствовать активной версии проекта. 
1. В заданиях, где использовался параллельный запуск N роботов, могла возникать ошибка из-за настройки дополнительных ограничений в задании и проекте (например, при запрете наложения). Теперь параллельный запуск задания осуществляется корректно.
1. Исправлена ошибка в запросе плоского представления журнала робота для MSSQL.  
1. Исправлена ошибка с последовательностью вызова при запуске проекта - возникала блокировка LockAt.
1. Исправлена ошибка с отображением столбца **Запуск в ограниченном кол-ве экземпляров** в таблице RPA-проектов.
1. Исправлена ошибка с фильтрацией элементов в статусе New (очереди обмена данными). 
1. Исправлена ошибка, при которой для отображения предупреждения о стратегии подсчитывались роботы и проекты без учета удаленных.
