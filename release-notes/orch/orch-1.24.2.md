# Оркестратор 1.24.2

История изменений в Primo RPA Orchestrator за февраль 2024-го года. 

## Обновления

1. Добавлены [общие папки](https://docs.primo-rpa.ru/primo-rpa/orchestrator/settings/shared-folders) — функциональность облегчает организацию доступа к объектам Оркестратора и упрощает контроль за действиями роботов. По умолчанию функция отключена, [разрешить ее использование](https://docs.primo-rpa.ru/primo-rpa/orchestrator/fine-tuning/shared-folders) можно в конфигурационном файле.\
   \
   На текущий момент папки не работают с такими объектами, как ресурсы и очереди обмена данными. Реализовать возможность их использования планируется в следующих релизах.

1. В раздел RPA-проектов добавлены вкладки:
   * **Очередь проектов** — содержит таблицу с проектами, ожидающими выполнения роботом.
   * **Запуски** — содержит таблицу с историей запусков проектов. В нее попадают как завершенные проекты, так и находящиеся в ожидании либо в процессе работы. Чтобы просмотреть значения аргументов, с которыми был запущен проект, необходимо нажать кнопку **Показать детализацию запуска**.

   ![](<../../.gitbook/assets1/launches-tab.png>)

1. Робот Оркестратора ([unattended-робот](https://docs.primo-rpa.ru/primo-rpa/orchestrator/settings/licensing#tipy-licenzii-v-orkestratore)) теперь может использовать учетную запись, созданную администратором. Такой записи обязательно должна быть назначена встроенная роль Robot и, опционально, роль с гибкими правами. Ранее робот мог использовать для работы только встроенную учетную запись **robot**. 
1. В форме развертывания робота добавлены опциональные параметры:
   * **Пользователь Оркестратора** — учетная запись с ролью Robot, созданная администратором для робота Оркестратора. Если оставить поле пустым, то по умолчанию будет использоваться встроенная учетная запись **robot**. 
   * **Пароль пользователя Оркестратора**.

   ![](<../../.gitbook/assets1/add-robot-orchuser-2.png>)

   Дополнительно, в разделе **Роботы > Все роботы**, стало возможным фильтровать данные по полю **Пользователь оркестратора**.
1. Добавлена возможность скрывать из интерфейса функцию **Консоль** с трансляцией RDP-сессии робота. Скрыть функцию можно в настройках конфигурационного файла WebApi. Для этого в секции **Worker** установите параметру **ShowRdpConsoleBtn** значение `false`:
   ```
   "Worker": {
   /* Показывать кнопку "Консоль" для просмотра сеанса робота */
   ShowRdpConsoleBtn": false
   ```    
   ![](<../../.gitbook/assets1/hide-console-button.png>) 

1. В разделе **Настройки > Машины роботов** были добавлены:
   * кнопка **Включить/Выключить** — отображается в меню таблицы при выделении нужной машины. Выключенная машина не опрашивается Оркестратором до момента включения, а ее логи не записываются в журнал.
   * столбец **Выключена** — содержит признак выключенной машины. 
   
   Кроме этого, на главной странице, в виджете **Машины роботов**, добавлен специальный признак выключенной машины, чтобы отличать ее от недоступной.

   ![](<../../.gitbook/assets1/turn-off-button-machine.png>)

1. В журнале Оркестратора вновь стала доступной вкладка **Корректировка**. В ней выводятся события о корректировке оперативного взаимодействия узлов в кластере Оркестратора. События в таблице можно отфильтровать по следующим типам:
   * **Добавился узел** — в кластер Оркестратора добавлен новый узел.
   * **Потерян узел** — один из узлов в кластере перестал быть доступным. В таких случаях требуется оперативное восстановление работы узла или переназначение задач другим узлам в кластере. 
1. В заданиях с триггером [**Запуск при наличии новых элементов в очереди обмена данными**](https://docs.primo-rpa.ru/primo-rpa/orchestrator/basics/tasks#id-3.-zapusk-pri-nalichii-novykh-elementov-v-ocheredi-obmena-dannymi) теперь можно указывать теги элементов. В результате триггер сработает только в том случае, если в очереди появятся элементы с указанными тегами.

   ![](<../../.gitbook/assets1/orch-task-item-tag.png>)

1. В [форме добавления проекта](https://docs.primo-rpa.ru/primo-rpa/orchestrator/basics/add-project#parametry-proekta) появились параметры **Версия** и **Предрелиз (RC)**. Функциональность предназначена для тех случаев, когда пользователь хочет протестировать последнюю версию RPA-проекта перед ее основным релизом. 

   ![](<../../.gitbook/assets1/orch-project-rc-parametr-2.png>)

   В таблице проектов данные о предрелизе будут отображаться в столбце **Версия**. Теперь верхняя часть (v0, …, vN) версии – это технические версии проектов, которые назначаются Оркестратором автоматически. Нижняя часть версии — строка формата, принятого разработчиками проектов. Значение может быть взято из метаданных, полученных при чтении архива проекта.

   ![](<../../.gitbook/assets1/версии проектов.png>)

1. В разделе настроек прав роли, в группу **RPA-проекты**, добавлена функция **Предрелизная версия**. С ее помощью можно настроить такие права доступа к функции, как:
   * Просмотр — пользователь с данной ролью сможет только просматривать предрелизные версии проектов.
   * Создание — пользователь имеет право создавать предрелизные версии проектов. 
   * Редактирование — пользователь имеет право изменять предрелизные проекты.
   * Удаление — пользователь имеет право удалять предрелизные проекты.
   * Управление — не применимо для данного пункта.

   ![](<../../.gitbook/assets1/orch-rc-project.png>)

1. Добавлена возможность останавливать сразу все запущенные [задания](https://docs.primo-rpa.ru/primo-rpa/orchestrator/basics/tasks), а также заново их запускать. Для этого на странице **Все задания** появились кнопки **Остановить все** и **Запустить все остановленные**. Для их использования не требуется вручную выбирать задания в таблице. Функциональность может быть полезной при обновлении Оркестратора, чтобы предотвратить потенциальные нарушения в работе заданий.

   ![](<../../.gitbook/assets1/orch-taska-stop-all-button.png>)

1. В форму создания [ресурса](https://docs.primo-rpa.ru/primo-rpa/orchestrator/basics/assets#dobavit-resurs) добавлены опциональные параметры **Тип блокировки** и **Таймаут**. Параметры реализованы для совместимости с будущими версиями Студии. Блокировка используется при конкурентном доступе роботов к общему ресурсу. Данные настройки позволяют указать тип блокировки ресурса и время блокировки в секундах. Возможные типы блокировки:
   * *Разрешено чтение* — другие роботы смогут только читать этот ресурс. Запись запрещается.
   * *Запрещено чтение* — другим роботам полностью запрещено использовать этот ресурс.
1. В рамках интеграции с GitLab стало возможным определять источник публикации RPA-проектов. Возможные источники: Оркестратор / Студия / Git. Чтобы источник публикации отображался в интерфейсе, необходимо в конфигурационном файле WebApi установить параметру **showPublishSrcTag** значение `true`. В результате на странице **Все RPA-проекты**, в столбце **Версия**, будет виден источник каждого проекта. 
1. Улучшена производительность при работе с ресурсами Оркестратора. 
1. Добавлена возможность поиска элемента очереди по натуральному ключу без учета регистра.

### Улучшения UX/UI

1. Для элементов очереди обмена данными добавлена сортировка по следующим столбцам: 
   * *Дата создания*;
   * *Дата, до которой элемент считается недоступным*;
   * *Дата, после которой элемент считается недоступным*;
   * *Дата прочтения элементов очереди роботом*.
1. Улучшено отображение значений и метаданных элементов в очереди обмена данными. Теперь, если кликнуть в столбце **Значения и Метаданные**, то данные со сложной структурой будут представлены в виде дерева. Ранее они выводились в виде строки.
1. На странице **Настройки > Стратегия очереди проектов** график привязки роботов к проекту стал динамически изменяться в зависимости от выбранных настроек. 
1. На странице **Настройки > Диструбив робота** добавлены индикаторы состояния дистрибутивов. В случае проблем с дистрибутивом, в столбце **Физически присутствует в хранилище** отобразится цветовой индикатор ошибки. При наведении курсора на индикатор появится текстовая подсказка.
1. В таблицу роботов добавлены текстовые подсказки для статусов открытия RDP-сессии. Подсказка отобразится, если в колонке **Расположение** навести курсор на цветовой индикатор.
1. На странице **Роботы > Все роботы** добавлена подсветка недоступной машины робота. Так, если в столбце **Машина доступна** отображается статус `Нет`, то это значение подсветится красным. 
1. Улучшено отображение данных в разделе **Роботы > Группы**.
1. До 100 символов увеличена максимальная длина значения в поле с версией дистрибутива робота.


## Улучшения в UI 3
1. Добавлен раздел **Запуски**, содержащий историю запусков RPA-проектов.
1. Стало возможным просмотреть список роботов, привязанных к проекту. Для этого на странице **Проекты** необходимо нажать иконку действий с проектом и выбрать пункт **Роботы проекта**.
1. Улучшения на странице **Машины**:
   * В таблицу с машинами добавлен столбец **Версия агента**.
   * В столбце **Последний пинг** стала отображаться корректная дата последнего пинга машины робота. В случае, если машина недоступна, отобразится дата последней доступности машины.
1. На страницу **Роботы** добавлена колонка **Версия дистрибутива**.
1. Исправлена ошибка с отображением данных в разделе **Аргументы проекта > История запусков**.


## Исправленные ошибки
1. Исправлена ошибка, когда при запросе элемента очереди по FIFO возвращался `Null`, хотя очередь не была пустой. Ошибка возникала при большой нагрузке и требовала от пользователя лишних действий в виде повторного обращения к очереди. Теперь необходимость повторных запросов устранена. 
1. Исправлены ошибки в сортировке элементов очереди, возникавшие при большом количестве обращений роботов. 
1. Исправлена работа функции **Повторить** для элементов очереди. Теперь использование функции всегда переводит элемент в статус New, независимо от текущего статуса.
1. Исправлена ошибка, из-за которой не удалялись ресурсы (assets) из Оркестратора.
1. Исправлена ошибка, из-за которой невозможно было прочитать ресурс Оркестратора из Студии.
1. Исправлена ошибка валидации поля **Email** для заданий с триггером **Запуск при получении Email**. 
1. Исправлена ошибка, из-за которой задание с запуском при изменении папки учитывало только глобальную настройку стратегии очереди. Стали учитываться стратегии тенантов.
1. Исправлена ошибка `Email должен быть уникальным`, которая возникала при редактировании почты в профиле пользователя.
1. Исправлено некорректное указание времени в уведомлениях, отправляемых на почту при запуске робота с проектом.
1. Исправлена ошибка, из-за которой свободный робот не брал в работу проект из очереди.
1. Исправлена ошибка с удалением привязки роботов при удалении версии проекта.
1. Исправлена ошибка, когда для версий проектов не отображалась надпись `Не последняя` в таблице проектов. 
1. Понижен уровень лога `Робот не в состоянии мягкого останова` - теперь событие носит информационный характер. 
1. Исправлена ошибка, из-за которой логи attended-робота могли не передаваться в Оркестратор.
1. Исправлена ошибка, из-за которой в форме расписания невозможно было указать календарь, если их несколько (режим множественных календарей).
1. Исправлена ошибка, возникавшая при попытке разлогинить всех RDP-пользователей машины робота.
1. Исправлены проблемы со сбором счетчиков производительности у Агента.
1. Исправлена ошибка, возникавшая при создании папки. Добавлена проверка уникальности имени папки для пользователя.
1. Исправлена ошибка, из-за которой машины роботов переносились между папками без RDP-пользователей.
1. Исправлена ошибка, когда при переносе RPA-проектов из одной папки в другую промежуточные версии проектов терялись.


## Где найти
[Скачать комплект поставки Оркестратора:](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FOrchestrator)
* **Primo RPA Orchestrator 1.24.2 FULL.zip** — полный комплект поставки, в который входят дистрибутивы Оркестратора и внешних компонентов: например, базы данных PostgreSQL Server, брокера сообщений RabbitMQ и др. 
* **Primo RPA Orchestrator 1.24.2.zip** — облегченный вариант поставки.

[Скачать дистрибутив Robot Enterprise](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FRobot). Архив должен иметь название **Primo RPA Robot Orchestrator <архитектура> 1.24.2.zip**. Дистрибутив этого робота загружается непосредственно в Оркестратор.
