# Оркестратор 1.24.1

История изменений в Primo RPA Orchestrator за январь 2024-го года. 

## Обновления и улучшения

### ФИЧИ - ОПИСАНЫ
1. На странице **Роботы > Все роботы** добавлена подсветка недоступной машины робота. Так, если в столбце **Машина доступна** отображается статус `Нет`, то значение подсветится красным. 
1. В журнале Оркестратора вновь стала доступной вкладка **Корректировка**. В ней выводятся события о корректировке оперативного взаимодействия узлов в кластере Оркестратора. Доступен фильтр по следующим типам событий:
   * **Добавился узел** - в кластер Оркестратора добавлен новый узел (нода).
   * **Потерян узел** - один из узлов в кластере перестал быть доступным. В таких случаях требуется оперативное восстановление работы узла или переназначение задач другим узлам в кластере. 
1. Добавлена возможность скрывать из интерфейса кнопку **Консоль** - открывает окно с видеотрансляцией RDP-сессии робота. Скрыть функцию можно в настройках конфигурационного файла WebApi. Для этого в секции **Worker** установите параметру **ShowRdpConsoleBtn** значение `false`:
   ```
   "Worker": {
   /* Показывать кнопку "Консоль" для просмотра сеанса робота */
   ShowRdpConsoleBtn": false
   ```    
1. Для заданий с триггером **Запуск при наличии новых элементов в очереди обмена данными** теперь можно указывать теги элементов. В результате триггер сработает только при появлении в очереди элементов с указанными тегами.



### ФИЧИ - НЕ ОПИСАНЫ

1. Появилась возможность создать учетную запись для робота, работающего с Оркестратором. Ранее робот мог работать только под технической учетной записью Оркестратора.

К встроенным ролям относятся Robot.

1. В форме добавления робота появились необязательные параметры:
   * **Пользователь Оркестратора** - учетная запись Если пустое, используется встроенная системная учетная запись robot. Спискок строк – имен пользователей Оркестратора с ролью Robot (кроме встроенной учетки robot).
   * **Пароль пользователя Оркестратора** - Должен совпадать с паролем пользователя Оркестратора. Нельзя использовать произвольный пароль. 
1. На форме «Все роботы» добавить фильтр «Пользователь оркестратора» (UserName) и выводить поле UserName (если не пустое ) в таблице.


спискок строк – имен пользователей Оркестратора с ролью Robot (кроме встроенной учетки robot).
На форме «Все роботы» добавить фильтр «Пользователь оркестратора» (UserName) и выводить поле UserName (если не пустое ) в таблице (рисунок 2):



1. Добавить сортировку по датам/приоритету для элементов очереди обмена данными - Добавлена множественная сортировка для элементов очереди обмена данными. Это серверная сортировка, их можно испольовать одновременно. Сортировка осуществляется посредством нажатия на заголовок столбца.  Если снять сортировку со всех столбцов, то порядок будет определен исходя из приоритета (по восходящей, строки без приоритета в конце), потом по полю "Дата создания" по возрастающей. Сортировка добавлена в столбцы:
   * Дата создания
   * Дата, до которой элемент считается недоступным
   * Дата, после которой элемент считается недоступным
   * Дата прочтения элементов очереди роботом

     бэк - (980) Добавлена сортировка по датам/приоритету для элементов очереди обмена данными

1. (**Роботы > Ресурсы**) В форму создания/редактирования ресурса добавлены необязательные поля **Тип блокировки** и **Таймаут** блокировки. Возможные типы блокировки:
   * Разрешено чтение - 
   * Запрещено чтение - 

1. 10294 - появился параметр таймаут в форме элемента очереди. его можно скрывать фича-флагом (по умолчанию скрыт). Нужен для...
1. 9336 - Добавить JSON viewer для просмотра Значений и Метаданных. В элементах очереди улучшили отображение значений в колонке **Значение и метаданные**. Значение со сложной структурой теперь можно удобно сворачивать, разворачивать и т. д. дерево будет рисоваться. раньше данные выводились в виде строки, что было неудобно. 
1. 9104 - раздел роботы, вкладка Группы. Поменялся внешний вид таблицы - теперь вместо двух таблиц стала одна, ей удобнее пользоваться. 
1. 10333 - рпа проекты. интеграция с гитлаб. добавились доп метаданные котоыре приходятс гитлаба для проектов. фича под флагом в конфиге. можно отключить.
1. 10330 - предрелизные версии проектов. при добавлении / редак -ии появилось поле **Предрелиз (RC)**, где можно указать, какая это версия - предрелизная или нет. После чего в таблице в столбце Версия выводится эта доп инфа.
   сюда же (3310) Создать ролевую модель отображения последней версии RPA-Проекта (предрелизная версия и права на неё)
   

1. 9398 - Добавить возможность запуска или остановки сразу нескольких заданий. добав-сь возм-ть остановки всех заданий: новые кнопки Остановить все и Запустить все остановленные. Большое кол-во зап-х заданий теперь удобно остановить разом.
   бэк - (7781) Массовая остановка всех запущенных заданий и последующий их запуск   (для обновления версии орка или профилктики сервера)
   815 - Добавить возможность остановки всех заданий для проведения обновления. (Пакетный запуск-останов выбранных заданий).
   9398 - Добавить кнопку остановки всех заданий.

1. 10058 - **Настройки**. Диструбив роботов. Добавить индикаторы состояния в таблице дистрибутивы роботов. Когда есть проблемы с дистрибутивами, то в столбце **Физически присутствует в хранилище** высвечиваются ошибки в виде индикаторов (с подсказками вроде бы)
1. 10378 - Добавить признак выключенного Агента в UI. 
1. 9420 - стратегия очереди проектов (интерактивность добавлена). Переделать график Стратегии очереди проектов.
1. 10088 - Большая нагрузка на процессор при работе RDP2.
1. 9124 - Перенести подраздел раздел Роботы в Проектах.
1. 10062 - Поменять список для фильтра приоритеты в таблице Очереди проектов.
1. (993) Доступность свойств проекта в IdeaHub-Студии-Оркестраторе (Orchestrator фронт-бэк)
1. Улучшен UX. В интерфейс добавлена подсказка для статусов открытия RDP-сессии. Открываем страницу **Роботы > Все роботы**, в колонке **Расположение** наводим курсор на значок "Профиль пользователя загружен" - отобразится подсказка для каждого из статусов RDP-сессии.



## ОПТИМИЗАЦИИ

- При согласовании дистрибутива нодами фиксация событий "Долгое время от какой-либо ноды нет подтверждения" и "В серии последовательных согласований подтверждение постоянно меняется"
- (9355) Возможность поиска элемента очереди по натуральному ключа без учета регистра


## Исправленные ошибки

1. Ошибки "Email должен быть уникальным" при создании и редактировании пользователя.
1. Не работает чтение ассетов орка из студии.
1. Ошибка валидации при сохранении задания с Email триггером.
1. Баг в блоке "Аргументы проекта" -> История запусков.
1. Некорректное отображение времени при получении уведомлений на почту при запуске робота с проектом.
1. Проблемы со сбором счетчиков производительности у Агента.
1. Дублируются запросы в таблице элементы очереди.
1. Свободный робот не берет в работу проект из очереди.
1. В форме Расписания нельзя указать календарь.
1. Не удаляются ассеты из Оркестратора.
1. (9299) Триггер по расписанию с мягкой остановкой не работает
1. (372) Исправлена работа кнопки Повторить (обнуление элемента, пересчет статистики)
1. (10423) Триггер на изменение папки работает только со стратегией "Прикрепленные роботы" (настройки стратегии брались только из дефолтного тенанта)
1. Сортировка (FIFO) при чтении из очереди в скоростном режиме
1. Повторные извлечения при чтении по FIFO, чтобы минимизировать возврат NULL.
1. Баг с расщеплением элемента очереди при чтении в скоростном режиме, приводящий к задваиванию чтения
1. Баг с кэшированием робота в методах работы с ассетами- О Отключение виджета с интенсивностью событий триггеров на главной
1. (10328) Баг с не отображением сообщения о не последней версии проекта
1. (11813) Исправлен баг, позволявший передавать значения параметров не входящих в Enum, которым задан тип параметра
1. (10186) Папки (добавить уникальность имени папки для пользователя, при удалении переподчинять её дочерние папки)
1. Размер поля с версией дистрибутива робота увеличен до 100
1. Понижен уровень лога "Робот не в состоянии мягкого останова"- Ф (8557) Признак выключенного агента 
1. Исправлен баг в авторизации аттендед-робота- Б (10151) Исправлен баг с удалением привязок роботов при удалении версии проекта
1. (11209) Ошибка в миграции для MSSQL с циклами в каскаде- Б (10432 Баг при массовом разлогоне
1. (10422) Машины агентов переносятся между папками без RDP пользователей
1. (10419) При переносе проектов между папками, промежуточные версии проектов теряются UI 2.0 (перенос всех версий).



## Hope-UI
1. Добавить информация о версиях агентов в HopeUI.
1. Доступность машины робота - Hope-UI.



## Где найти
1. [Скачать комплект поставки Оркестратора:](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FOrchestrator)
    * **Primo RPA Orchestrator 1.24.1 FULL.zip** - полный комплект поставки, в который входят дистрибутивы Оркестратора и внешних компонентов: например, базы данных PostgreSQL Server, брокера сообщений RabbitMQ и др. 
    * **Primo RPA Orchestrator 1.24.1.zip** - облегченный вариант поставки.
2. [Скачать дистрибутив Robot Enterprise](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FRobot). Архив должен иметь название **Primo RPA Robot Orchestrator <архитектура> 1.24.1.zip**. Дистрибутив этого робота загружается непосредственно в Оркестратор.
