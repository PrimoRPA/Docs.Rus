 # Оркестратор 23.11

Примечания к выпуску Оркестратора 23.11 описывают изменения для версии приложения, выпущенной в ноябре 2023 года.

### Новые функции и улучшения

1. Улучшено управление RPA-проектами. Теперь для ручной постановки проекта в очередь не требуется создавать задание с ручным запуском - достаточно нажать кнопку **Поместить в очередь проектов** в разделе **RPA-проекты**. Кнопка становится активной после выбора проекта. 

   ![](<../../.gitbook/assets1/add-to-project-queue-button.png>)
 
1. Улучшена надежность открытия RDP-сессии робота. Также стало возможным увидеть в UI, на каком этапе возникла проблема долгого запуска робота (проблема «75%»): при открытии RDP-сессии или при загрузке профиля RDP-пользователя. Для этого в таблице роботов, в столбце **Расположение**, появился соответствующий индикатор. Если навести курсор на индикатор, отобразится его текстовое описание.

   ![](<../../.gitbook/assets1/double-rdp-indicator.png>)

1. В таблице машин роботов стало легче определять доступность машины:
   * Значения в колонке **Доступна** теперь подсвечиваются. Если машина доступна, то значение подсветится зеленым. Если недоступна - красным.
   * Добавлена дата тестирования доступности машины робота. В случае, если машина недоступна, отобразится дата начала недоступности.

   ![](<../../.gitbook/assets1/robot-machine-test-succeeded.png>)

1. В [окно просмотра RDP-сессии робота](https://docs.primo-rpa.ru/primo-rpa/orchestrator/settings/register-rdp-users#videotranslyaciya-rdp-sessii) добавлена функция **Скопировать подключение к теневой**. С ее помощью можно скопировать строку теневого подключения к RDP-сессии, чтобы использовать в командной строке. Функция призвана облегчить настройку теневого подключения. 

   ![](<../../.gitbook/assets1/viewing-rpd-session-copy.png>)

1. Улучшена поддержка Linux-роботов. 
1. Появилась возможность отключить тенант по умолчанию и настроить блокировку встроенных учетных записей **studio**, **admin** и **superadmin**. Функция помогает удовлетворить возможные требования к информационной безопасности, предъявляемые в организации. Подробнее см. [здесь](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/fine-tuning/disable-default-tenant).
1. Добавлена категория прав доступа, определяющая набор разрешенных операций в разделе **Настройки > Ч-Б список Студий**. Для встроенных ролей Administrator и TenantAdministrator по умолчанию разрешены все операции с Ч-Б списком, а именно: 
   * Administrator - может просматривать/редактировать/создавать/удалять сущности во всех тенантах.
   * TenantAdministrator - может просматривать/редактировать/создавать/удалять сущности только в рамках своего тенанта.

   ![](<../../.gitbook/assets1/black-white-permissions-2.png>)

1. При добавлении адреса входящей почты теперь можно выбрать протокол [**MS Exchange**](https://docs.primo-rpa.ru/primo-rpa/orchestrator/settings/email#ms-exchange). Кроме того, оптимизирована таблица почтовых адресов: вся информация по выбранным протоколам стала отображаться в едином столбце **Протокол**. 

     ![](<../../.gitbook/assets1/orch-settings-email-exchange.png>)

1. Улучшен UI/UX страницы **Все RPA-проекты**. Если проект имеет несколько версий, и в качестве активной установлена не последняя из них, это будет подсвечено в таблице. 

   ![](<../../.gitbook/assets1/not-last-version-project.png>)
   
1. Добавлена возможность [ограничить поток событий от триггеров](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/fine-tuning/limit-thread-of-events-from-triggers). Функция помогает устранить либо снизить риск отказа в обслуживании при обработке потока. Ограничение настраивается в конфигурационном файле WebApi в секции **Assignment**.
1. Внесены улучшения в структуру хранения данных в базе данных. Таблица **RpaProjectLaunches** разделена на 2 части:
   * В основной БД (ltools) содержится таблица с записями о недавних запусках RPA-проектов.
   * В БД с логами (ltoolslogs) стала находиться таблица с записями о старых запусках. Подробнее см. [здесь](https://docs.primo-rpa.ru/primo-rpa/orchestrator/deployment/fine-tuning/setting-up-old-runs-cleaning#parametry-ochistki).
1. Для PostgreSQL добавлена возможность указать собственную схему вместо public - схемы по умолчанию. Для этого в конфигурационном файле WebApi, в параметре **ConnectionStrings**, необходимо задать значение для атрибута **SearchPath**. По умолчанию в нем установлена схема public.  
   ```
   "ConnectionStrings": {
    // Postgres
    "DefaultConnection": "PORT=5432;TIMEOUT=15; ... SearchPath=public;"
   }
   ```
1. Появилась возможность настроить период удаления данных из очереди проектов. Настройка осуществляется в конфигурационном файле WebApi в параметре **CleaningDepth**. По умолчанию установлен период 1 день. В предыдущих версиях период очистки не подлежал изменению.
   ```
   "ProjectQueue": {
    /* Удаление из таблицы RpaProjectQueue записей, старше (дней), чем текущее время */
    "CleaningDepth": 1
   }
   ```
1. Улучшен UX/UI раздела **Роботы > Все роботы**. При невозможности разблокировать робота система отобразит сообщение о причинах этого поведения. Например, если потеряна связь с машиной робота. 
1. Улучшено изменение приоритетов для роботов, добавленных к RPA-проекту. Реализован способ drag-and-drop - теперь изменить приоритет робота можно путем перетаскивания соответствующей строки в таблице.
1. Улучшена работа с таблицей раздела **Мониторинг**. В случае, когда выбран интервал **За 30 дней** и не задан фильтр по состоянию выполнения проекта, система автоматически ограничит период выборки данных до 15-ти дней. Об этом пользователей будет информировать соответствующая подсказка, добавленная в блок фильтров. 
1. В разделе **Журнал** улучшена фильтрация событий Оркестратора по полю **Пользователь**. Добавлена возможность заполнять значение этого поля при помощи клика по логину пользователя в таблице.
1. На странице **Очереди обмена данными** добавлен вывод количества выделенных элементов очереди.
1. В форме добавления RPA-проекта стал проверяться формат файла. При попытке добавить любой файл, кроме \*.zip, система выдаст ошибку.


### Исправленные ошибки

1. Исправлена ошибка в работе заданий с cron-строкой. Ранее, если пользователь менял cron-строку триггера, то обновленное расписание не применялось. 
1. Исправлена ошибка с повторным запуском заданий по расписанию. Ранее повторный запуск производился мгновенно, без учета времени в расписании. 
1. Не удалялось задание с ручным запуском, если в очереди проектов была запись, ссылающаяся на него. Ошибка исправлена.
1. Исправлена ошибка запуска проекта, если в названиях процессов содержалась кириллица.
1. Исправлена ошибка неуникальности триггера при редактировании задания. 
1. Исправлено некорректное поведение роботов при нехватке лицензий. Робот, который не успевал занять лицензию, завершал работу с ошибкой, а проект не попадал в очередь ожидания. 
1. Устранена ошибка отображения версий роботов. Для робота с ядром v1 стала отображаться версия (ранее отсутствовала). Для робота с ядром v2 исправлено отображение версии в форме добавления к проекту.
1. На странице **Настройки > Машины роботов** не было возможности изменить IP-адрес в профиле машины робота. Ошибка исправлена.
1. Исправлена ошибка в форме редактирования пользователя. Ранее для поля Email отсутствовала красная звездочка, хотя это поле всегда должно оставаться заполненным.
1. Исправлено UX/UI замечание, касающееся отображения списка процессов в форме добавления проекта. Список менял свое положение при прокрутке страницы. 
1. Устранена потеря тегов при повторении элемента в очереди обмена данных.
1. Исправлена логика очистки ссылок на триггеры в таблице запусков RPA-проекта (RpaProjectLaunches) в БД.
1. Исправлена ошибка «Изменение статуса возможно только у прочитанного элемента», которая приводила к преждевременному завершению проекта. 
1. Исправлена ошибка в постраничной навигации в журнале робота и в мониторинге. Теперь переход по страницам осуществляется корректно. 
1. Исправлено ошибочное выделение элемента очереди при клике на его значение или метаданные в таблице.
1. Исправлена ошибка, когда большие секции логов невозможно было удалить через интерфейс Оркестратора. Сейчас удаление секций журналов Робота и Оркестратора производится корректно.


### Где найти
1. [Скачать комплект поставки Оркестратора:](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FOrchestrator)
    * **Primo RPA Orchestrator 1.23.11 FULL.zip** - полный комплект поставки, в который входят дистрибутивы Оркестратора и внешних компонентов: например, базы данных PostgreSQL Server, брокера сообщений RabbitMQ и др. Вес дистрибутива ~ 3,5 Гб.
    * **Primo RPA Orchestrator 1.23.11.zip** - облегченный вариант поставки, весит ~ 1,1 Гб.

2. [Скачать дистрибутив Robot Enterprise](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FRobot). Архив должен иметь название **Primo RPA Robot Orchestrator <архитектура> 1.23.11.zip**. Дистрибутив этого робота загружается непосредственно в Оркестратор.
