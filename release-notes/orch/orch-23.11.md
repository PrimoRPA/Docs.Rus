# Оркестратор 23.11

Примечания к выпуску Оркестратора 23.11 описывают изменения для версии приложения, выпущенной в ноябре 2023 года.

### Новые функции и улучшения

1. Улучшено управление RPA-проектами. Теперь для ручной постановки проекта в очередь не требуется создавать задание с ручным запуском - достаточно нажать кнопку **Поместить в очередь проектов** в разделе **RPA-проекты**. Кнопка становится активной после выбора проекта (-ов). 
1. Внесены улучшения в структуру хранения данных в базе данных. Таблица RpaProjectLaunches, в которой хранятся данные о запусках RPA-проектов, разделена на 2 части:
   * оперативная - таблица с записями о недавних запусках в основной БД (ltools);
   * архивная - таблица с записями о старых запусках, которую можно найти в БД с логами (ltoolslogs). 
1. Добавлена категория прав доступа, определяющая набор разрешенных операций в разделе **Настройки > Ч-Б список Студий**. Для встроенных ролей Администратор (Administrator) и Администратор тенанта (TenantAdministrator) по умолчанию разрешены все операции с Ч-Б списком, а именно: 
   * Administrator - может просматривать/редактировать/создавать/удалять сущности во всех тенантах.
   * TenantAdministrator - может просматривать/редактировать/создавать/удалять сущности только в рамках своего тенанта.

   ![](<../../.gitbook/assets1/black-white-permissions.png>)

1. Улучшена работа с таблицей раздела **Мониторинг**. В случае, когда выбран интервал **За 30 дней** и не задан фильтр по состоянию выполнения проекта, система автоматически ограничит период выборки данных до 15-ти дней. Об этом пользователей будет информировать соответствующая подсказка, добавленная в блок фильтров. 
1. Улучшена навигация в разделе **Мониторинг**. Теперь при попытке перехода на другие страницы таблицы **Мониторинг** система автоматически вернет пользователя на первую страницу. 
//??? эт зачем сделано, не совсем поняла.  
1. В разделе **Журнал** улучшена фильтрация событий Оркестратора по полю **Пользователь**. Добавлена возможность заполнять значение этого поля при помощи клика по логину пользователя в таблице.
1. Улучшен UX/UI раздела **Роботы > Все роботы**. При невозможности разблокировать робота система отобразит сообщение о возможных причинах (например, о потере связи с машиной робота). 
1. Улучшено изменение приоритетов для роботов, добавленных к RPA-проекту. Реализован способ drag-and-drop - теперь изменить приоритет робота можно путем перетаскивания соответствующей строки в таблице.
_______________________________________

1. Добавлены RDP-пользователи для Linux-роботов. (послушать демо, если не понятно - к Максу)
Для UI:
Флаг Linux для пользователя RDP. В форме добавления/редактирования робота разблокировать поле RDP user для Linux-роботов.
RDP пропускает учетки для линукс-роботов (в каком контексте здесь использовано слово "пропускает"? это к Люльке).

https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_boards/board/t/Orchestrator%20Team/Stories/?workitem=4052

из демо: привели и робота, и оркестратор в состояние, где они полностью рабочие. орк теперь умеет запускать линуксовых роботов.


1. Добавлены функции:
   * отключить/скрыть дефолтный тенант; В конфигурационный файл WebApi добавляется параметр Tenants. DisabledDefaultTenant, который включает/выключает дефолтный тенант. При выключении дефолтного тенанта:
1. Авторизация в нем будет не возможна
2. В выпадающих списках выбора тенантов в Оркестраторе и Студии/Раннере дефолтный тенант будет отсутствовать

   * отключить встроенные не технические учетные записи: admin, superadmin, studio
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_boards/board/t/Orchestrator%20Team/Stories/?workitem=9181

_______________________________________

1. Добавлена настройка в конфиге:

"ProjectQueue": {
    /* Удаление из таблицы RpaProjectQueue записей, старше (дней) чем текущее время */
    "CleaningDepth": 1
  }

раньше был зашит 1 день. Из рук-ва админа: реализован параметр ProjectQueue:CleaningDepth  - позволяет настроить периодичность автоматического удаления из очереди проектов записей, старше (дней) чем текущее время.


1. Добавлена возможность использования (или: реализована поддержка) Email MS Exchange Server (Exchange ActiveSync) - большая фича, Люлька в курсе. Это для триггеров, которые с почтой работают. Теперь в триггере можно использовать почту MS Exchange Server. 
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_boards/board/t/Orchestrator%20Team/Stories/?workitem=3566


1. (7570) Для постгреса возможность задать схему, отличную от public (дефолтной), чтобы не создавать вручную в ней таблицу миграций. это была одна из ошибок, которая связана с миграцией на .Net7. У некоторых заказчиков эта схема отличалась от дефолтной (видимо из-за ИБ), теперь это можно настраивать в конфиге (каком?). В параметре ConnectionStrings можем прописать целевую схему, в атрибуте SearchPath (скрин приложить). Если не прописывать, то по умолчанию будет использована схема public.  


1. (7974) Использовать ограничение для потока событий триггеров + Мониторинг очереди потока событий триггеров.
    Сначала это были триггеры, которые из роботов. это было в прошлом релизе, задача 3372. Видимо, это: "Исправлена ошибка, из-за которой не получалось запустить сразу несколько роботов по триггеру «Запуск из другого робота»."
    Потом добавили и для других триггеров. В конечном итоге было много вопросов по тому, что же это такое и как настраивается. Добавлен большой раздел в рук-во админа (раздел 12.14) - ограничения версии студии? уточнить у Макса.
    чтобы самоубийство системы не происходило, был добавлен ограничитель потока. И к этому ограничению сейчас добавлен мониторинг очереди потока событий триггеров (в БД, судя по всему). Мы в базе можем смотреть, как эта очередь себя ведет - только в базе или добавлены новые события Орка, которые в UI можно глянуть?
    UI пока нет для мониторинга.Планируется в будущих релизах (упомянуть об этом). дальше смотреть в 10:39 1ч. видео (название таблицы..)
    Это очень важная метрика. Может сигнализировать об очень большой задержке обработки элементов, которые в нее попали. Всякие странные баги могут быть таки локализованы.

1. (8560) Автоматическое временное замедление очереди проектов при пиках нагрузки на машинах роботов.

далее - с 06:30 1е видео.

фича про страницу/вкладку "Запуск", узнать, доделано ли/писать ли в релизе. Найти все задачи/инфу в док-ии.


### Исправленные ошибки

1. Исправлена ошибка в работе заданий с cron-строкой. Ранее, если пользователь менял cron-строку триггера, то обновленное расписание не применялось. 
1. Исправлена ошибка с повторным запуском заданий по расписанию. Ранее повторный запуск производился мгновенно, без учета времени в расписании. 
1. Исправлена ошибка запуска проекта, если в названиях его процессов содержалась кириллица.
1. Исправлена ошибка неуникальности триггера при редактировании задания. 
1. Исправлено некорректное поведение роботов при нехватке лицензий. Робот, который не успевал занять лицензию, завершал работу с ошибкой, а проект не попадал в очередь ожидания. 
1. Устранена ошибка отображения версий роботов. Для робота с ядром v1 стала отображаться версия (ранее отсутствовала), для робота с ядром v2 исправлено отображение версии в форме добавления к проекту.
1. На странице **Настройки > Машины роботов** отсутствовала возможность изменить IP-адрес в профиле машины робота. Ошибка исправлена.
1. Исправлена ошибка в форме редактирования пользователя. Ранее для поля Email отсутствовала красная звездочка, хотя это поле всегда должно оставаться заполненным.
1. Исправлено UX/UI замечание, связанное с некорректным отображением списка процессов в форме добавления проекта в Оркестратор. Список менял свое положение при прокрутке страницы. 
1. Устранена потеря тегов при повторении элемента в очереди обмена данных.
1. Исправлена проблема с записью многочисленных ошибок в журнал Оркестратора. Проблема воспроизводилась для Оркестратора с конфигурацией Windows Server + IIS + MSSQL. 
1. Исправлена логика очистки ссылок на триггеры в таблице запусков RPA-проекта (RpaProjectLaunches) в БД.
1. Исправлена ошибка «Изменение статуса возможно только у прочитанного элемента», которая приводила к преждевременному завершению проекта. Ошибка воспроизводилась при использовании базы данных MS SQL.


1. Отображение списка процессов в проекте при добавлении в Оркестратор. 
4085

1. 


### Где найти
1. [Скачать комплект поставки Оркестратора:](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FOrchestrator)
    * **Primo RPA Orchestrator 1.23.11 FULL.zip** - полный комплект поставки, в который входят дистрибутивы Оркестратора и внешних компонентов: например, базы данных PostgreSQL Server, брокера сообщений RabbitMQ и др. Вес дистрибутива ~ 3,5 Гб.
    * **Primo RPA Orchestrator 1.23.11.zip** - облегченный вариант поставки, весит ~ 1,1 Гб.

2. [Скачать дистрибутив Robot Enterprise](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FRobot). Архив должен иметь название **Primo RPA Robot Orchestrator <архитектура> 1.23.11.zip**. Дистрибутив этого робота загружается непосредственно в Оркестратор.
