# Оркестратор 23.8

Примечания к выпуску Оркестратора 23.8 описывают изменения для версии приложения, выпущенной в августе 2023 года.

### Новые функции и улучшения

*(новость 1 под вопросом - писать или нет? в рук-во польз-ля.docx инфа про параметры добавлена)

1. Оптимизирована работа Роботов с очередью обмена данными (только для PostgreSQL). Для Роботов, считывающих элементы, появилась возможность настраивать тип реакции на блокировку элемента. Блокировка может возникать при извлечении элемента из очереди по FIFO, если в нее обратилось сразу несколько Роботов-читателей. Тип реакции устанавливается либо в конфигурационном файле WebApi в секции ExchangeQueue - глобально для всех очередей, либо на уровне отдельной очереди в UI Оркестратора. Для этого в UI, в разделе создания/изменения очереди, добавлены параметры:
   * **Реакция на невозможность извлечения элемента по FIFO** - определяет, что следует возвращать Роботу при блокировке элемента: null или ошибку.
     * Значение **Вернуть ошибку** рекомендуется при обработке заранее подготовленной очереди, с которой работают только Роботы-читатели. Это позволяет отличать блокировку от случая, когда в очереди закончились элементы. В этом случае null будет являться признаком завершения работы с очередью (очередь пустая).
     * Значение **Вернуть null** рекомендуется выбирать при обработке динамической очереди, когда с ней одновременно работают Роботы-писатели и читатели. Тогда null будет возвращаться и при ошибке блокировки, и при пустой очереди, а сигналом завершения работы с очередью будет являться внешний признак. Например, достижение максимального количества итераций. Этот более производительный режим работы и предпочтителен при большой нагрузке.
   * **Кол-во попыток при извлечении элемента по FIFO** - параметр настраивается, если в качестве реакции на невозможность извлечения элемента по FIFO пользователь выбрал **Вернуть ошибку**. В этом случае при получении ошибки, связанной с блокировкой элемента, Робот будет пытаться получить элемент повторно указанное количество раз. Настройка может привести к увеличению времени извлечения элемента.

    Настройка реакции в UI имеет приоритет над глобальной. 

1. 1115, 3344 - Мультитенантная AD-авторизация + Поменять расположение элементов на форме авторизации.
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/1115
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/3344

1115 - Мультитенантная AD-авторизация. Добавить возможность используя AD авторизацию использовать разные тенанты под одной УЗ. - как работает?
Включает:
    703 - Добавить возможность используя AD авторизацию использовать разные тенанты под одной УЗ. Добавить возможность используя AD авторизацию использовать разные тенанты под одной УЗ. Есть определенное кол-во админов, создавать дубликаты никто не будет, обсудить, как обойти данную проблемы для администрирования нескольких тенантов. Локалки запрещены.       https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/703

1. 1013 - Статистика очередей обмена данными
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/1013




1. 768 - Добавить версию проекта
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/768

1. 701 - Невозможно добавить два триггера с одной и той же очередью обмена. Скрыли триггер **Запуск при изменении очереди обмена данными**.
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/701

1. 202, 961 - Реализовать отображение используемых лицензий + Поменять метод для запроса файла лицензии на v2
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/202
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/961

1. 909 - Поменять текст на "Пауза" для кнопке в таблице Машины
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/909

1. 931 - Скрывать кнопку Пауза по конфигу
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/931

1. 1005 - Добавить подсказку для поля интервал в Роботах
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/1005

1. 1021 - Добавить поля для журнала регистрации событий
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/1021

1. 1052 - Переименовать поле Логи в консоль
https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/1052

1. Изменилась проверка уникальности email пользователя, который указывается при создании/обновлении учетной записи. Теперь адрес должен быть уникальным в рамках тенанта, к которому принадлежит пользователь. Ранее проверка осуществлялась глобально, что не давало возможность указывать один и тот же почтовый адрес в разных тенантах.
1. Максимальное количество символов в поле с наименованием Робота увеличено до 200. Теперь можно указывать более полные и ясные названия.

-----------
Князьков далее (-13:40) 

949 - Оптимизация работы вкладки **Мониторинг** с учетом секционирования таблицы логов. Что-то добавили, тормозить перестало.



2. 1011 - Удаление зависимости Primo.FreeRdpWrapper'а от .NET Core SDK. - на что это влияет? нужно ли в релизе?
3. Cистемные логи службы RDP2 в linux. Отображение времени запуска задания. Сделать возможным отключение (уменьшение объемов) системных логов службы RDP2 в linux.  ОР: Возможность отключения логов freerdp в syslog.

Направляю инструкцию. Нужно в файле:
/etc/systemd/system/Primo.Orchestrator.RDP2.service
в раздел 
[Service]
необходимо добавить следующие строки:
StandardOutput=null
StandardError=null
и перезапустить службу:
systemctl daemon-reload
service Primo.Orchestrator.WebApi restart

Теперь логи будут только в каталоге
/opt/Primo/RDP2


5. 202 - Реализовать отображение используемых лицензий без наведения на общее кол-во. (посмотреть самой на разных стендах)
6. 768 - Добавить версию проекта (посмотреть самой на разных стендах). Просят название проекта при добавлении версии сделать более заметным, обычным шрифтом без прозрачности. Сделали:
* название проекта выводиться в виде текста - Вопрос: нередактируемого? Просто он перестал быть прозрачным?
* по клику на селект список процессов проекта открывается вверх, чтобы не перекрывать название проекта (раньше отображался вниз).

7. 782 - БЫЛО УЖЕ Отображение времени запуска задания. Необходимо, чтобы у заданий с условием запуска по времени значения 'Следующая дата по расписанию' появлялись сразу после создания, а не после первого первого запуска.

8. 826 - Требуется механизм вычищения данных из очередей обмена данными. Разработать механизм по очищению очередей от устаревших сообщений (время устаревания - настраиваемый параметр). Так, чтобы никаких следов от данных из сообщений не оставалось в очереди. Т.е. никакими фильтрами в оркестраторе или прямым доступом к раббит невозможно было получить информацию об устаревших транзакциях.
(заблокированные элементы - это?)
Как именно реализовали: ??

9. 898 - Шифрование пароля к сертификату для RDP2. Обновлена ли дока? Шифрование утилитой из поставки?




### Исправленные ошибки

1. 749 - Скорректировать работу фильтра   https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/749
1. 750 - Список RDP-пользователей    https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/750
1. 104 - Баг с отображением очереди выполнения  https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/104
1. 773 - В форме Добавить/Редактировать задание валидация не пропускает email https://azure-dos.s1.primo1.orch/PrimoCollection/Orchestrator/_workitems/edit/773
1. 1014 - Не удаляются проекты (задания). Не удаляются проекты (задания), если есть в очереди проектов запись, ссылающаяся на них. Проблема наблюдается только для заданий с ручным запуском. Устранено.
1. Невозможно было добавить новую версию проекта, если перед этим пользователь удалил неактивные версии. Ошибка исправлена.
1. В журнал Робота добавлялось множество пустых логов, что являлось некорректным поведением. Ошибка исправлена. ((После выполнения активности AddToLog добавляется пустая запись в журнале робота.))
1. 


-------------
не надо:
1. 820 (протестировано?)  - Наблюдались ошибки в работе повторенных элементов очереди:
   * если повторялся элемент очереди с тегами, то у повторенного элемента они отсутствовали. 
   * при попытке получить повторенный элемент по фильтру (Peek queue by filter) не получалось использовать фильтр по значению в метаданных - он не учитывался, хотя метаданные присутствовали.

3. 103 - При изменении cron-строки в расписании, которое используется в задании, в самом задании не изменялось время запуска (оно продолжало запускаться по старому значению). Исправлено. (это в 23.7 или в 23.8????)
проверить самостоятельно в орке.

туда же коммент:
"Вопрос был в другом.
Не отображается время, на которое мы меняем крон строку.
Например, задание будет выполнено в 12:00, мы меняем это время на 16:00, но это время не отображается, стрелкой я указал на скрине, где оно должно отображаться.
И начнет оно там отображаться, только тогда, когда оно выполнится.
Они хотят, чтобы расписание отображалось, будущее время выполнения задания после изменения в крон строке (чтобы в самом задании было видно, когда оно выполниться в следующий раз)"


### Где скачать

Скачать комплект поставки Оркестратора 23.8 можно по [этой ссылке](https://disk.primo-rpa.ru/index.php/s/release?path=%2FOrchestrator). Он содержит 2 архива:
* **Primo RPA Orchestrator 23.8.0 FULL.zip** - полный комплект поставки, в который входят дистрибутивы Оркестратора и внешних компонентов: например, базы данных PostgreSQL Server, брокера сообщений RabbitMQ и др.
* **Primo RPA Orchestrator 23.8.0.zip** - облегченный вариант поставки, который весит около ~ 1,1 Гб.

Робот Enterprise, дистрибутив которого загружается в Оркестратор, скачивается отдельно от комплекта поставки. Архив имеет название **Primo RPA Robot Orchestrator <архитектура> 23.8.0.zip** и находится [здесь](https://disk.primo-rpa.ru/index.php/s/release?path=%2FRobot).


