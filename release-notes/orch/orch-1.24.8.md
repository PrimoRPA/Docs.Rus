# Primo RPA Orchestrator 1.24.8

История изменений в **Primo RPA Orchestrator**, выпущенной в августе 2024-го года. 

## Обновления и улучшения

1. Разработана программа установки **(Installer)** для автоматической установки и обновления Оркестратора на Linux и Windows. Она значительно сокращает время и усилия, минимизируя необходимость в ручной настройке и обновлении.
 
   Поддерживаемые операционные системы:
   - **Windows:** Windows Server 2016, 2019;
   - **Linux:** Ubuntu 20, 22; CentOS 8.5; Astra Linux 1.6, 1.7, Common Edition 2.12; RedOS 7 Enterprise, CE; Debian 11.

1. Добавлена новая аналитическая подсистема, которая предоставляет гибкий доступ к данным Оркестратора, таким как утилизация лицензий, время обработки элементов очереди и др. 

2. Улучшена информационная безопасность (ИБ) Оркестратора:
   - **Управление политиками паролей через UI:** Добавлена возможность управления политиками паролей через пользовательский интерфейс. Все изменения политик паролей теперь автоматически регистрируются в журнале событий. Лог содержит сведения о пользователе, который осуществил изменение, а также предыдущие и новые значения параметров политики паролей.
   - **Регистрация событий создания, изменения и удаления ролей:** В журнале безопасности теперь фиксируются подробности, включая сведения о пользователе, который вносил изменения, наименование роли, а также перечень измененных правил разграничения доступа. Кроме того, для события `Пользователь изменен` добавлена детализация, позволяющая сравнить состояние профиля пользователя до и после редактирования.
   - **Защита от удаления активных учетных записей:** Внедрена защита от удаления учетных записей, залогиненных в системе. При попытке удалить такого пользователя отображается сообщение об ошибке.
   - **Регистрация попыток просмотра журнала безопасности:** Теперь фиксируются попытки просмотра журнала безопасности. Каждое посещение вкладки **Инцидент безопасности** регистрируется в журнале событий, что позволяет отслеживать доступ к информации о безопасности.
   - **Механизм проверки соответствия паролей новым политикам:** Реализован механизм автоматической проверки соответствия паролей учетных записей новым политикам паролей. При выявлении несоответствия пользователям будет предложено сменить пароль при следующем входе в систему или во время использования системы.
   - **Настройка перечня объектов доступа:** Добавлена возможность настройки перечня объектов доступа, для которых регистрируются попытки обращения. Теперь администраторы могут настраивать этот перечень как для всего прикладного ПО, так и для отдельных ролей.

3. Обновлена служба **RobotLogs**: Реализована динамическая настройка параметров OrchBaseUrl и Tenants. Параметры OrchBaseUrl и Tenants исключены из конфигурационного файла и теперь автоматически определяются через WebApi при запуске службы. Также исключена зависимость от базы данных `ltools`, что устранило необходимость ручной настройки подключения в конфигурации.

4. Добавлена новая функция в веб-интерфейсе Оркестратора — переключатель **Не очищать папку (NoCleanFolder)** для управления очисткой папки проекта перед каждым запуском робота. Теперь можно сохранить данные от предыдущих запусков проекта или их автоматически удалять перед каждым новым запуском.

5. Добавлена возможность указания максимальной длины пароля в конфигурационном файле WebApi. Максимальная длина пароля для RDP-пользователя и администратора машины увеличена до 128 символов.

6. Добавлена ссылка на сайт документации в веб-интерфейсе Оркестратора. Отображение этой ссылки можно настроить в конфигурационном файле WebApi в секции `Support`, где можно включить или отключить отображение ссылки. При установке параметра **Enabled** в значение `false`, ссылка отображаться не будет.

7. Добавлены идентификаторы в наименование робота во вкладке **Роботы** : идентификатор робота (Key) - текст и идентификатор последней операции (LastStartOperationKey) - гиперссылка. 
Если робот ещё не запускался, то идентификатор последней операции отсутствует. 
При наведении на `Key` отображается подсказка `Идентификатор робота`, а при наведении на `LastStartOperationKey` отображается подсказка `Код последней операции`. 
При нажатии на гиперссылку `LastStartOperationKey` осуществляется переход в раздел **Журнал** с предустановленным значением `OperationKey` в поле `Код операции`.

8. Добавлено принудительное разлогинивание пользователей при обновлении версии Оркестратора, что устраняет ошибку, ранее возникавшую при добавлении машин роботов после обновления.

9. Улучшена функциональность в разделе политики паролей: кнопка **Сохранить** теперь становится активной только после внесения изменений на странице. При попытке перехода на другую вкладку без сохранения появляется всплывающее предупреждающее окно.

10. Добавлена всплывающая подсказка с общим количеством элементов очереди при наведении на число в центре диаграммы в веб-интерфейсе Оркестратора. Теперь пользователи могут увидеть подробную информацию о каждом типе элементов и перейти к таблице элементов очереди для более подробного анализа.

11. Добавлена возможность массового автоматического обновления версии агента через веб-интерфейс Оркестратора, что значительно сокращает время на обновление по сравнению с ручным процессом. Теперь в интерфейсе отображается статус процесса обновления, включая начало обновления, его прогресс и успешное завершение.

12. Улучшена работа службы RDP, снижено потребление ресурсов и повышена стабильность в режимах с потоковой передачей данных и без нее.

13. Оптимизирована работа RDP2 службы под Linux: теперь для каждого RDP соединения создается отдельный процесс, который общается с RDP2 через Unix Domain Socket с использованием GRPC. Падение одного дочернего процесса больше не влияет на работу других процессов и RDP2 в целом, что улучшило стабильность системы.

14. Оптимизирован конфигурационный файл Агента: дефолтные значения теперь удалены из файла, что упрощает настройку.


### Исправленные ошибки


1. Исправлена некорректная работа производственного календаря, из-за которой задания запускались не по расписанию. Теперь задания запускаются строго в соответствии с установленным производственным календарем.
1. Исправлена ошибка, при которой чтение ассета типа JObject из Оркестратора вызывало исключение о недопустимом приведении типов. Теперь процесс корректно считывает ресурс, успешно завершаясь как в Студии, так и роботом.
1. Исправлена ошибка остановки робота при нажатии **Остановить (Hard kill)**. Теперь робот, установленный на Linux, корректно завершает работу и переходит в статус `Недоступен` при нажатии кнопки.
1. Исправлено поведение при добавлении нового пользователя в Оркестратор: теперь корректно обрабатывается чекбокс `Требовать смену пароля` при следующем входе в систему. Также добавлено уведомление об ошибке при назначении пользователю ролей, несовместимых с выбранным тенантом.
1. Устранена ошибка `timezone - zoneinfo`, которая ранее появлялась в консоли стрима (трансляции) и дублировалась в логе.
1. Исправлено отображение названий кнопок `Turn off` и `Turn on` в разделе **Машины (Machines)** веб-интерфейса Оркестратора на английском языке. Теперь кнопки отображаются корректно.
1. Исправлена ошибка, из-за которой невозможно было изменить пароль для встроенных учетных записей в Оркестраторе. Теперь пароли могут быть успешно изменены для системных пользователей, таких как Agent и Analyticservice.
1. Исправлена ошибка, из-за которой не удалялись все роли пользователя. Теперь все присвоенные роли пользователя удаляются одновременно как через UI, так и через API. 
1. Исправлена ошибка в агенте версии 1.23.11.3, приводившая к поломке кодировки файлов с кириллицей в наименовании после длительного времени работы.
1. Исправлена ошибка, при которой запуск задания оставался в журнале запусков, если робот не мог получить лицензию. Теперь задание с проектом автоматически встает в очередь и ожидает доступности лицензии. Если при попытке запуститься снова не хватает лицензии, создается новый запуск, который также идет в очередь, и этот процесс продолжается, пока задание не будет выполнено. Важно: относится только к запускам из заданий, ручные запуски не учитываются. 
1. Исправлена ошибка, из-за которой роботы периодически не запускались по заданию или запускались только на части выделенных роботов из-за зависших портов. В настройках агента добавлен новый параметр `RemoveInactiveTsPortsPeriodSec`, который позволяет настраивать периодичность очистки неактивных TS портов.
1. Исправлена ошибка, из-за которой остальные роботы переставали работать при переносе робота и его сущностей в папку. Теперь роботы корректно запускаются и выполняют проекты как в корневой папке, так и в перемещенной, независимо от стратегии привязки роботов к проектам.
1. Исправлена ошибка, из-за которой не работала функция запуска роботов по триггеру **E-mail входящей почты** через протокол MS Exchange.
1. Устранена ошибка, из-за которой в логах безопасности отображались дублирующиеся записи об авторизации пользователей в Оркестраторе через WebApi. Теперь каждая успешная авторизация фиксируется корректно.
1. Исправлена ошибка, из-за которой скриншоты не отправлялись в Оркестратор при использовании элемента "Снимок рабочего стола" (скриншот) с включенной настройкой отправки. Теперь отправка скриншотов в Оркестратор работает корректно.
1. Исправлена ошибка, из-за которой уведомления об истечении срока действия пароля учетной записи Оркестратора не отправлялись корректно. Теперь при подписке на событие `Срок действия лицензии истекает` уведомления отправляются на почтовый ящик пользователя.


## Где найти

[**Скачать Primo RPA Orchestrator**](https://disk.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FRelease%2FOrchestrator)
Полный архив с необходимыми файлами для установки и настройки Оркестратора

[**Скачать дистрибутив Primo RPA Robot Enterprise**](https://disk.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FRelease%2FRobot). 
Архивы дистрибутивов доступны в нескольких версиях, в зависимости от архитектуры вашего оборудования и операционной системы. Эти дистрибутивы предназначены для загрузки и использования непосредственно в Оркестраторе.


Если у вас возникнут сложности с установкой или использованием данной версии, пожалуйста, обращайтесь к вашему менеджеру или в [наш чат поддержки в Telegram](https://t.me/primo_RPA_chat).



