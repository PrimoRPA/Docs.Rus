# Primo Studio 23.5

Примечания к выпуску Студии 23.5 описывают изменения для версии приложения, выпущенной в мае 2023 года.


БРАУЗЕР! (ДИМА)


## Новые функции 
1. В элементе **Try-Catch** у переменной с типом данных [ExceptionExceptionInfo](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/datatypes/executionexceptioninfo), которая хранит исключение, появилось поле `.Data`. В значении свойства можно указать произвольную текстовую информацию.
1. Значительно ускорено выполнение циклов **ForEach** и **ForEach для DataTable**. В том числе, если для циклов не установлено кеширование. 
1. Удаление колонок\Удаление колонок через фильтр. https://dev.azure.com/primorpa/Primo/_queries/query-edit/f10885d8-f00f-4e84-b31a-35315975ca8a/
У элемента [**Фильтр таблицы**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_coll/el_coll_filtertable) (Коллекции) появилось окно мастера фильтров. Внешний вид элемента изменен: теперь 2 кнопки Мастер фильтров + Мастер запросов (был). мастер фильтров - как у ЮП. И теперь можно при фильтрации таблицы удалять ненужные столбцы и строки. 
Приоритет: если запрос непустой, то будет запрос. Если пустой, будет фильтры смотреть. При этом свойство Запрос имеет приоритет над обоими мастерами - если заполнено, то будет он.


1. в Данные > Таблицы > [Удалить колонку](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_data/els_data_tables/deletecolumn) теперь можно удалять по имени, а не только по индексу. Для этого добавлено свойство **Имя**. 


1. Появился элемент **Выполнить скрипт VB**. Нет возможности напрямую использовать VBS-файл. Полная копипаста ЮП. Офис не должен быть установлен - не про него, это виндовый вб (ВБ - это название ядра, файл может быть и ВБ и ВБС): когда файл VBS есть на диске (если в винде есть ядро ВБ), ты его можешь выполнить правой кнопкой. Спец элемент для выполнения скриптов. 
Типовые ошибки: нет ядра или если файл непролинкованный - бывают случаи, что винду поставили так, что вбс-ки не пролинковались к ядру ВБС (но это лечится какой-то командой в консоли). 

https://dev.azure.com/primorpa/Primo/_boards/board/t/Orchestrator%20Team/Stories

3. Изменен внешний вид цикла [Do-While](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_dowhile): поле с условием теперь располагается внизу, чтобы визуально отличаться от элемента **Цикл While**.


5. Изменен внешний вид логотипов для Primo Studio, Primo Robot и Robot Runner.
https://dev.azure.com/primorpa/Primo/_queries/edit/1982/?triage=true
6. Доработка формы загрузки пакетов https://dev.azure.com/primorpa/Primo/_queries/edit/2041/?triage=true





## Исправленные ошибки
1. Устранено накопление данных в `C:\Users\<user>\AppData\Local\Temp\Primo.Studio`. Ранее при каждом запуске проекта с зависимостями (`.Dependencies`) из Студии или Robot Runner они копировались в папку `Temp` и не очищались. Теперь данные очищаются перед каждым запуском робота. 
1. Элементы **Цикл ForEach** и **Цикл ForEach для DataTable** стали импортироваться с включенным параметром кеширования. Ранее при импорте для них отсутствовала галочка в свойстве **Кешировать**, хотя фактически оно производилось. Кеширование позволяет запоминать вычисляемые значения в цикле Foreach и, таким образом, выполнять проект быстрее. 
1. Инструмент [пропустить элемент](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/debug#propusk-elementa) работал не только при отладке, но и при запуске проекта, что являлось некорректным поведением. Ошибка исправлена, пропускать элемент возможно только в режиме отладки.
1. Улучшена работа окна редактора кода (Expression Editor): 
   * При закрытии Студии сбрасывалось положение окна редактора и установленный размер. Теперь настроенные параметры окна сохраняются и после завершения работы Студии.
   * Терялся фокус курсора при выборе значения из списка подсказок при написании кода - курсор через некоторое время возвращался на первую строку. Ошибка исправлена.
1. При поиске (`Ctrl` + `F`) переменных не отображались результаты из элемента **Множественное присвоение**. Ошибка была связана с тем, что не учитывались значения из свойств, представляющих собой коллекцию. Алгоритм поиска улучшен: теперь при поиске переменной также показывается, что она содержится во **Множественном присвоении**.
1. Исправлена ошибка, связанная с невозможностью очистить индекс в шаблоне поиска для браузерных приложений. Индекс стал очищаться.
1. В разделе **Файл > О программе** не отображался срок истечения оркестраторной лицензии Студии. Ошибка исправлена.
1. Исправлена ошибка, которая возникала при создании второго и последующих проектов с использованием клавиши `Enter`. Сохранить такой проект не удавалось. Теперь сохранение проектов клавишей `Enter` работает корректно.
1. Для переменных и аргументов отсутствовала проверка синтаксиса на предмет доступности ссылок на модули в DataType. Если при добавлении в проект зависимости были созданы переменные/аргументы, которые ссылались на доступный в рамках этой зависимости тип данных, то при удалении зависимости для них не отображались индикаторы ошибки :warning:. Проверка синтаксиса улучшена, теперь индикатор ошибки и ее текст отображаются.
1. При использовании драйвера Interop ввод формулы в ячейку Excel допускался только на английском языке. С этой версии Interop также позволяет использовать формулы на русском.
1. При использовании элемента **Найти начальную/конечную строку** с драйвером Interop поиск мог вернуть неверное значение. Ошибка исправлена.
1. В элементе **Вставка диаграммы** (Excel) высота и ширина работали некорректно: значения в диаграмме выполнялись противоположным образом. Ошибка исправлена.
1. При вставке в **Try Catch** любого скопированного элемента, например, **Клика мышью** со скриншотом, возникала ошибка при выполнении процесса. Ошибка исправлена.
7. На панели элементов исправлено некорректное отображение отступов веток дерева. 
1. При указании в элементе **Чтение почты** (Outlook) неправильного названия папки не отображалась ошибка. Теперь, если путь указан неверно, ошибка будет отображаться, что является корректным поведением.  



1. Баг или фича? - Увеличено количество аргументов, поддерживаемых в элементе **Запустить VBA** для Excel: стало возможным запускать до 20 аргументов. В предыдущих версиях разрешалось использовать до 10.

1. Теряется связь с удаленным репозиторием https://dev.azure.com/primorpa/Primo/_queries/edit/1870/?triage=true
кто-то хранил исходники в Azure, клонировал в репозиторий, и у него пропадала связь с удаленным репозиторием.  - подробнее уточнить у Пономарева Ивана. Касается только Azure? Вто это за инструмент в студии

1. "Приостанавливать отладку на исключении" начинает отладку на исключении при обычном запуске проекта без отладки https://dev.azure.com/primorpa/Primo/_queries/edit/2001/?triage=true






1. Исправлена ошибка, которая возникала при выполнении элемента **Закрыть браузер** в случае, когда времени для открытия браузера было недостаточно. Ошибка возникала только в версии ядра v2 или в обоих? Исправили? Необходимо избежать работы с браузером через расширение, если браузер еще не загружен

Элементы **Открыть браузер** **Закрыть браузер** "Object reference not set to an instance of an object" в версии ядра v2 https://dev.azure.com/primorpa/Primo/_queries/edit/1484/?triage=true
Если открыть браузер, и запустить отладку процесса в Студии: новая страница браузера успевает открыться и загрузиться, при отработке процесса элемент "Закрыть браузер" не отрабатывает и падает с ошибкой таймаута. Браузер остаётся открытым.
Браузер Chrome и  Firefox

Ошибка  "Object reference not set to an instance of an object" или "Ссылка на объект не указывает на экземпляр объекта" возникает в версии ядра V2, если не дать достаточно времени для открытия браузера и вызвать закрытие браузера.
Ошибка исправляется если переключить ядро на V1 или если установить паузу до вызова Закрытия браузера.





1. Некорректное отображение функции "Отобразить компонент" https://dev.azure.com/primorpa/Primo/_queries/edit/912/?triage=true
1. Сохранение скринов активностей при перемещении "Move to new sequence" https://dev.azure.com/primorpa/Primo/_queries/edit/1036/?triage=true
1. (1246) - Бесконечный запуск процессов при неуказанных входных аргументах https://dev.azure.com/primorpa/Primo/_queries/edit/1123/?triage=true
1. Робот завис при выполнении проекта https://dev.azure.com/primorpa/Primo/_queries/edit/1329/?triage=true
1. Не работает добавление строки Таблица\"Добавить строку" через DataRow https://dev.azure.com/primorpa/Primo/_queries/edit/1344/?triage=true
1. Astro bugfix https://dev.azure.com/primorpa/Primo/_queries/edit/1594/?triage=true
