# Primo Studio 23.5

Примечания к выпуску Студии 23.5 описывают изменения для версии приложения, выпущенной в мае 2023 года.

## Новые функции 
1. В NuGet добавлена библиотека [Primo.T1.CSV](https://www.nuget.org/packages/Primo.T1.Csv) для работы с большими табличными данными. После установки пакета в Студии станет доступна папка **Т1-Интеграция** с подпапкой **CSV**. Она содержит элементы:
   * [**Читать CSV**](https://docs.primo-rpa.ru/g_elements/el_extra/t1/els_csv/el_readcsv) - сохраняет прочитанные данные в переменную DataTable для дальнейшего использования.
   * [**Добавить в CSV**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_extra/t1/els_csv/el_appendcsv) - добавляет табличные данные в файл CSV после уже существующих.
   * [**Записать CSV**](https://docs.primo-rpa.ru/g_elements/el_extra/t1/els_csv/el_writecsv) - перезаписывает данные в файле CSV.
3. В NuGet добавлена библиотека [Primo.T1.OCR](https://www.nuget.org/packages/Primo.T1.OCR) для интеграции с инструментами OCR. Отличается от готовых OCR-элементов наличием профилей предобработки изображения, что позволяет достичь лучших результатов при распознавании. После установки пакета в Студии станет доступна папка **Т1-Интеграция** с подпапкой **OCR**. Она содержит элементы:
   * [**Microsoft OCR**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_extra/t1/els_ocr/el_ocr_microsoft) - для подключения к ядру OCR Microsoft. Поддерживается только для Windows 10.
   * [**Tesseract OCR**](https://docs.primo-rpa.ru/g_elements/el_extra/t1/els_ocr/el_ocr_tesseract) - для подключения к ядру OCR Tesseract. Поддерживается только для Tesseract версии 3.
   * [**Распознать текст**](https://docs.primo-rpa.ru/g_elements/el_extra/t1/els_ocr/el_ocr_recog) - обрабатывает изображение на экране и извлекает из него текстовые данные. 
   * [**Клик текста мышью**](https://docs.primo-rpa.ru/g_elements/el_extra/t1/els_ocr/el_ocr_textclick) - ищет заданную строку в изображении и кликает ее.
5. Добавлена функция принудительной синхронизации папки Outlook. Ее выполняет элемент [**Синхронизировать папку**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_outlook/el_outlook_sync). Использование компонента позволяет предотвратить ситуацию, когда при закрытии приложения Outlook письмо оказывается неотправленным.
6. Появился элемент [**Выполнить скрипт VB**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_prog/el_invokevb), который вызывает и выполняет файл на языке VBScript.
7. Значительно ускорено выполнение циклов **ForEach** и **ForEach для DataTable**. В том числе, если для циклов не установлено кеширование. 
8. У элемента [**Фильтр таблицы**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_coll/el_coll_filtertable) (Коллекции) появилось окно мастера фильтров. Оно позволяет удалять ненужные столбцы и строки при фильтрации. 
9. В элементе [**Удалить колонку**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_data/els_data_tables/deletecolumn) (**Данные > Таблицы**) добавлено свойство **Имя**, которое позволяет удалять столбец по его названию, а не только по индексу, как было ранее. 
10. В элементе **Try-Catch** для переменной с типом данных [**ExceptionExceptionInfo**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/datatypes/executionexceptioninfo) (хранит исключение) добавлено поле `.Data`. В значении свойства можно указать произвольную текстовую информацию.
11. Увеличено количество аргументов, поддерживаемых в элементе [**Запустить VBA**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_excel/el_excel_vba) для Excel: стало возможным использовать до 20-ти аргументов вместо 10-ти в предыдущих версиях.
12. Улучшен внешний вид цикла [**Do-While**](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_basic/els_logic/el_logic_dowhile): поле с условием теперь располагается внизу, чтобы визуально отличаться от элемента **Цикл While**.
13. Обновлен внешний вид логотипов для Primo Studio, Primo Robot и Robot Runner.

## Исправленные ошибки
1. Устранено накопление данных в `C:\Users\<user>\AppData\Local\Temp\Primo.Studio`. Ранее при каждом запуске проекта с зависимостями (`.Dependencies`) из Студии или Robot Runner они копировались в папку `Temp` и не очищались. Теперь данные очищаются перед каждым запуском робота. 
1. Элементы **Цикл ForEach** и **Цикл ForEach для DataTable** стали импортироваться с включенным параметром кеширования. Ранее при импорте для них отсутствовала галочка в свойстве **Кешировать**, хотя фактически оно производилось. Кеширование позволяет запоминать вычисляемые значения в цикле Foreach и, таким образом, выполнять проект быстрее. 
1. Инструмент [пропустить элемент](https://docs.primo-rpa.ru/primo-rpa/primo-studio/process/debug#propusk-elementa) работал не только при отладке, но и при запуске проекта, что являлось некорректным поведением. Ошибка исправлена, пропускать элемент возможно только в режиме отладки.
1. Улучшена работа окна редактора кода (Expression Editor): 
   * При закрытии Студии сбрасывалось положение окна редактора и установленный размер. Теперь настроенные параметры окна сохраняются и после завершения работы Студии.
   * Терялся фокус курсора при выборе значения из списка подсказок при написании кода - курсор через некоторое время возвращался на первую строку. Ошибка исправлена.
1. При поиске (`Ctrl` + `F`) переменных не отображались результаты из элемента **Множественное присвоение**. Ошибка была связана с тем, что не учитывались значения из свойств, представляющих собой коллекцию. Алгоритм поиска улучшен: теперь при поиске переменной также показывается, что она содержится во **Множественном присвоении**.
1. Исправлена работа инструмента **Отобразить компонент** в шаблоне поиска. Функция отображала значок успешной проверки каждый раз, даже если селектор был неправильным либо элемент был скрыт.
1. Исправлена ошибка, связанная с невозможностью очистить индекс в шаблоне поиска для браузерных приложений. Индекс стал очищаться.
1. В разделе **Файл > О программе** не отображался срок истечения оркестраторной лицензии Студии. Ошибка исправлена.
1. Исправлена ошибка, которая возникала при создании второго и последующих проектов с использованием клавиши `Enter`. Сохранить такой проект не удавалось. Теперь сохранение проектов клавишей `Enter` работает корректно.
1. Для переменных и аргументов отсутствовала проверка синтаксиса на предмет доступности ссылок на модули в DataType. Если при добавлении в проект зависимости были созданы переменные/аргументы, которые ссылались на доступный в рамках этой зависимости тип данных, то при удалении зависимости для них не отображались индикаторы ошибки :warning:. Проверка синтаксиса улучшена, теперь индикатор ошибки и ее текст отображаются.
1. При использовании драйвера Interop ввод формулы в ячейку Excel допускался только на английском языке. С этой версии Interop также позволяет использовать формулы на русском.
1. При использовании элемента **Найти начальную/конечную строку** с драйвером Interop поиск мог вернуть неверное значение. Ошибка исправлена.
1. В элементе **Вставка диаграммы** (Excel) высота и ширина отрабатывали противоположным образом. Ошибка исправлена.
1. При вставке в **Try Catch** любого скопированного элемента, например, **Клика мышью** со скриншотом, возникала ошибка при выполнении процесса. Ошибка исправлена.
1. Исправлена ошибка в сохранении скриншота элемента при перемещении компонента (например, **Клика мышью**) с помощью команды контекстного меню **Перенести в новую последовательность** (Move to new sequence). Теперь скриншоты элементов сохраняются. 
1. На панели элементов исправлено отображение отступов для веток дерева. Общий вид дерева элементов приобрел корректную структуру.
1. Исправлена ошибка, в результате которой терялась связь с удаленным репозиторием Git. 
1. Исправлено некорректное сообщение об ошибке, которое возникало при выполнении элемента **Закрыть браузер** в случае, когда времени для открытия браузера оказывалось недостаточно. Текст ошибки исправлен.


