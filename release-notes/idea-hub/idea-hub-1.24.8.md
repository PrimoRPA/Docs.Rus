# Idea Hub 1.24.8

Список изменений в Primo RPA Idea Hub, которые вошли в версию 1.24.8. 

## Обновления

25871 Нет доступа к Оркестратору
25887 - частично сюда же

раньше 
у орка есть проекта, у проекта есть версии. раньше из орка забиралась вся инфа про все версии проекта (=много данных). Привязка к проекту в орке по имени, не по идентификатору. И если в орке удалялась версия проекта или сам проект, то инфа об удалении в ИХ не попадала. В итоге если был удален проект с названием Х, а потом создан проект с таким же названием, то в ИХ отображалась неправильная статистика в процессе. Потому что привязка в процессе к старому проекту настроена.


(Где привязка: Процесс > Редактирование > Оркестратор > Проекты)

Исправили ситуацию так:
1. версии проекта не хранятся в ИХ. теперь в статистике отображаются общие данные по запускам, без привязки к версиям (общее количество запусков, кол-во успешных запусков, кол-во запусков с ошибками, кол-во запусков с исключениями).
2. мы храним просто записи о том, что когда-то в орке существовал такой-то проект с таким-то именем, статистика которого хранится бесконечно долго, без удаления.
3. если клиент в орке удалит старый проект и создаст новый с таким же именем для других целей, то ИХ в своей стате не поменяет инфу. В процессе останется привязка к старому проекту, а новый проект если вы хотите связать, то идите в форму настроек и там настраивайте. Это позволяет избежать разницы в данных между Орком и ИХ. 

теперь система может понять, что что-то не то/есть похожее, одноименный проект и выдаст пользователю предупреждение (сделать скрин предупреждения). Дескать, есть другой проект с таким же именем, но он не связан с процессом. И пользователь может самостоятельно исправить ситуацию, например, привязать новый проект. И тогда ИХ выдаст совокупную стату в процессе по обоим проектам.






### Улучшенный дизайн главной страницы

19498 (Дашборд новый) 

Переделали дашборды. Они стали проще. дашборды есть только на главной странице. Считается, что 1 стр = 1 дашборд. 

(приложить скрин главной страницы)

Новые дашборды накликиваются пользователями. Адаптированы под мобильные устройства. 

На базе этой статистики можно будет строить графики работы очередей и проектов - в наших дашбордах. На этих графиках можно будет видеть по дням кол-во запусков, ошибок и среднюю длительность. 

Благодаря тому что мы теперь можем выгрузить статистику по очередям и проектам (? разобраться, как это связано) мы можем делать графики в дашбордах - за определенные дни, периоды.

Что появилось:
* Появилась возможность создавать произвольное количество панелей (дашбордов) - столько сколько требуется клиенту. Он может их сам создать, накликать, раздать разрешения на просмотр (фича была, поэтому аккуратно тут)
* появилась фильтрация по департаментам и по датам
* Пользователь теперь может самостоятельно добавлять индикаторы, без привлечения разработчиков ИХ. (это инструмент конструирования отчета)
* Пользователь может (а раньше мог?) создавать разные страницы дашбордов, в них будут разные индикаторы, а сами блоки, то, как это конструируется... решили сделать по модели Тильды:
   * все блоки заранее существуют  - предзаданы на странице
   * мы предлагаем заранее сконструированные блоки, которые всегда выглядят одинаково, вне зависимости от того, какие показатели пользователь хочет отобразить. Пользователь в этих блоках может поменять иконки, цвета, текст, сами показатели. Но компоновка останется. 
   * блоки можно удалить, скрыть.
     
Если нужно что-то еще, то разработка может создать доп шаблон для нового блока. В результате палитра блоков с индикаторами расширяется.

(построить дашборд)


### Улучшенные формулы
1. Добавлена поддержка переменных в полях формул. Теперь легко можно определить переменные, которые вы хотите использовать в расчетах. Использование переменных упрощает написание сложных формул и повышает их читаемость. 
1. Добавлена возможность писать комментарии в формулах. Функция помогает упростить понимание и поддержку сложных формул. Чтобы оставить комментарий, используйте синтаксис `//Комментарий к формуле`. Комментарии проигнорируются при выполнении формулы, но останутся видимыми для всех, кто с ней работает. 
1. Стали доступны подсказки при вводе формул. Если ввести текст в поле формулы, то система автоматически отобразит подсказки, которые относятся к вашему значению. Кроме того, стали доступны операторы:
     * `@F` — просмотр списка всех доступных пользователю функций. **Уточнить про регистр и конечный синтаксис у Кости**
     * `@E` — просмотр списка всех доступных пользователю сущностей. Например, очередей, лицензий, процессов и т.д.
1. Автоматическую справку можно дополнять текстом (=можно дополнить подсказки). На страницах ИХ можно создавать страницы с произвольным текстом, и этот текст мы можем использовать в качестве справки, добавлять в разных ситуациях. (если мы создаем материал Статья, напишем там какой угодно текст отформатированный (может html использоваться). Эти статьи мы можем привязывать к подсказкам - например, чтобы к process привязать статью, в коде есть крючки.... какие конкретно крючки и как привязывать, не знаю.
   * Ускорено вычисление формул. 

(взять скрин из видео 3 - создание материала параметр)

### Комбинированная статистика

1. Компановка процесса в один. (Возможность объединить несколько процессов/ Компановка очередей в один процесс). https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_boards/board/t/IdeaHub%20Team/Stories


   Если кол-во очередей в процессе больше одной, необходимо разбить статистику по каждой очереди с вынесением эффектов во вкладку расчитанные эффекты ( сейчас считается только по первой очереди)
   https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25882

   Для бизнес-процессов с несколькими очередями Оркестратора (**или проектов тоже?**) появилась возможность выводить комбинированную статистику. Для этого в рассчитанных эффектах процесса появились поля, где можно ввести формулу с указанием всех необходимых очередей, по которым следует суммировать показатели в статистике процесса.

   Это поля со следующими машинными именами:
   * **Ops_total** — формула для показателя Общее количество операций.  
   * **Ops_success** — формула для показателя Количество успешных операций.
   * **Ops_error** — формула для показателя Количество бизнес-ошибок.
   * **Ops_exception** — формула для показателя Количество исключений.
   * **Ops_avg_duration** — формула для показателя Среднее время длительности операций.

   По умолчанию статистика выводится по первой привязанной к процессу очереди.

В этом поле мы можем обращаться либо к очередям, либо к проектам...

Если к процессу привязаны и очереди, и проекты, то в дашборде можно выбрать, по чему конкретно будет выводиться статистика - из очереди или из проектов. 



Показатели, которые нам нужны для очереди и для проектов. Это общие показатели:

Процесс:
Количество операций
Количество успешных операций
Количество бизнес-ошибок
Количество исключений (когда робот написан криво и не смог обработать какую-то операцию и повис/сломался)
Среднее время длительности операций

У очередей не операции, а обработка элемента очереди.

Очереди (1 элемент очереди = 1 транзакция = 1 операция):
Количество обработанных элементов очередей (транзакций)
Количество успешно обработанных
Количество с бизнес-ошибок
Количество исключений (когда робот написан криво и не смог обработать какую-то операцию и повис/сломался)
Среднее время длительности операций

Проекты (1 операция = 1 запуск проекта):
Время выполнения проекта (время запуска)

Эти данные мы собрали из Орка и сохранили в статистику. В идеале в одном процессе есть одна очередь. Но у клиентов часто к одному процессу привязано много очередей. 


//(К процессу в ИХ можно присоединить множество очередей, произвольное количество. И в одном бизнес-процессе используется десяток очередей, это проблема для показателей статистики. Как посчитать? Для таких ситуаций придумали вот что: при наличии нескольких очередей в процессе, по умолчанию статистика будет высчитываться по первой очереди. Если у клиента одна очередь, то ему дополнительно делать ничего не нужно. Если несколько очередей, то в формуле статистики можно ссылаться на любые сущности, которые привязаны к процессу. Например, мы можем суммировать показатели нескольких очередей. В ИХ есть функция queue_meerge(). То есть на выходе получится объединенная статистика по важным очередям (выбранным). Клиенты сами должны будут вписать эти очереди в формулу (илии обратиться к техподдержке). 
Формула прописывается в полях процесса (Редактирование процесса > Рассчитанные эффекты). Там появится поле, которое называется **Ops_total**. В этом поле можно комбинировать очереди и комбинировать показатели. 


1. Реализовать связь между материалом типа Очередь с соответствующей статистикой в хранилище  https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25887

1. Из типа материала Очередь удалить поля, в которых хранили статистику https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25884 (вид статистики изменился, стал по типу проекта)

1. Добавить возможность управлять "дельтами" https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25146

1. Реализовать связь между материалом типа Проект с соответствующей статистикой в хранилище  https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25886

### тоже стата
25888  разбить статистику по запускам очередей...
посмотреть эту задачу. там про эксель тоже (корневая).




### Другое
25882

Мы добавили возможность использовать в расчетах статистику по разным прикрепленным к процессу очередям. Это означает, что к одному процессу мб подключено произвольное кол-во очередей и проектов. Чтобы посчитать показатели эффективности, мы можем делать сложные расчеты внутри формул путем комбинации данных из разных очередей. 
это возможность использовать статистику из разных очередей. раньше так нельзя было сделать.



### Экспорт данных в Excel

1. 26204 Некст - мы теперь можем выгрузить статистику по очередям и проектам (стата запусков) в файл Excel за определенный период времени. Период - это фильтр: либо произвольные дата начала/дата окончания, либо выбрать период (например, квартал, календарный месяц и тд). 

посмотреть задачу, выцепить что-нибудь полезное.


1. Добавлена возможность выгружать процессы в Excel. Функция может быть полезна для формирования соответствующих отчетов в организации. (ОМК)


### Управление доступом к полям процесса

1. Добавлена возможность управлять доступом к полям процесса. **Какие разрешения появились, подробнее расписать, как настраиваются** https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25778

Права доступа к процессам по департаментам
25856
25717

уточнить про статус задачи. 

частично сделали:


можно настроить процессы таким образом чтобы определенные поля показывались только определенным ролям. Ролевая модель доступа.


заходим в процесс, настраиваем для каждого поля разрешения.




### Настройка отображения числовых значений

1. Для числовых полей появилась настройка, которая позволяет управлять отображением значений. Теперь вы можете установить конкретное число, начиная от которого значения необходимо автоматически сворачивать. Ранее значения автоматически сворачивалась, если сумма в поле была больше миллиона. Благодаря новой функции, вы можете снизить этот порог.   https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25747








1. Реализовать возможность создания произвольные типы комплексных полей https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25749

1. Добавить новое рассчитываемое поле https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25138

1. Добавить новую пользовательскую функцию  (что за функция?) https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25135

1. Добавить возможность управлять разделителями баджей в краткой версии карточек процессов https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25180

1. Добавить в представления "No result" https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25375

1. Перенести список департаментов из демо inner https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25396

1. Исправить правила обновления сервера staging https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/26557

1. Сохранять получаемые из текущего оркестратора данные в новое датированное хранилище https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25121

1. Перенести добавление t() в stagin для доступных значений поля "Период операций"  https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25127

1. Организация хранения обязательных датированных данных от системы RPA   https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25061

1. Перенести функциональность миграции RateAndHumanDuration в модуль поля PrimoComplex https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/20670






## Исправленные ошибки

1. Исправлена ошибка, из-за которой не обновлялась иконка пользователя в меню. Ранее иконка корректно обновлялась только у администратора. https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25750
1. Исправлена ошибка в миграции, из-за которой департаменты не обновлялись корректно. https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25748
1. ПОЯСНИТЬ (ЧТО ТАКОЕ ТИЗЕР, КАКИЕ ДИСПЛЕИ ИМЕЮТСЯ В ВИДУ) Исправлена ошибка, из-за которой нельзя было изменить иконки в тизере. Теперь в любом дисплее можно настроить иконки для полей процесса.  https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/24291
1. Исправлена ошибка, из-за которой экспорт процессов завершался ошибкой при отсутствии департамента, привязанного к процессу.  https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/26209
1. Исправлена ошибка, из-за которой не работал поиск в английской версии сайта. https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/15583
1. Решена проблема, из-за которой на странице очередей не работали региональные настройки.  https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/25022

1. Ошибка при запуске крона primo_migrate_node_license_presave()->getTimestamp https://azure-dos.s1.primo1.orch/PrimoCollection/IdeaHub/_workitems/edit/23241

