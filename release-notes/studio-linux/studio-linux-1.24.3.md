# Primo Studio Linux 1.24.3

Раздел содержит описание изменений для версии приложения Primo Studio Linux 1.24.3, выпущенной в марте 2024 года. 


## Новые функции и улучшения

1. Добавлены библиотеки для работы Tesseract OCR (программного решения для извлечения текста из изображений), предназначенные для использования на Astra Linux и Red OS.

2. Добавлена валидация паттерна поиска элементов и селектор элементов в форму “Редактор шаблона поиска” для браузерных активностей.

3. Улучшена работа селектора: 
- добавлена кнопка “Выход” в правом верхнем углу экрана  
- добавлены новые поля для ввода/фильтрации (Тэг, Текст, Индекс)

4. Реализована система хранения конфигурационных настроек для модуля LTools.WebBrowser.Native, а также добавлены настройки логирования модуля LTools.WebBrowser.Native. Принцип хранения настроек аналогичен решению для ОС Windows; хранение осуществляется в формате json.


## Исправленные ошибки 
1. Устранена проблема, из-за которой каждая активность проекта получала значок ошибки при использовании зависимостей.
2. Исправлена ошибка, из-за которой не работала активность “Преобразовать в изображение” (PDF).
3. Исправлена некорректная работа активности "Получить письма (IMAP)” при указании свойств "Дата от" и "Дата до", из-за чего письма загружались без учета выбранного временного интервала. 
4. Решена проблема, из-за которой не работало свойство  "Метить, как непрочитанные" в активности "Получить письма (IMAP)”, и письма, полученные по идентификатору, не отмечались, как непрочитанные. 
5. Устранена ситуация с ошибкой, возникавшей при отправлении письма по SMTP через SSL: The remote certificate is invalid because of errors in the certificate chain: UntrustedRoot. Для корректной работы SMTP с портом 587 необходимо указывать свойства Использовать SSO = Вкл и SSO = StartTlsWhenAvaible. Если эти свойства не указать, выполнение проекта может привести к ошибке и рекомендации указать порт 465. 
6. Найдено решение проблем с ошибкой чтения письма при получении почты по POP3 с включенным и отключенным SSL.
7. Устранена причина появления ошибок “Call from invalid thread” и зависаний при запуске робота из Оркестратора.
8. Обеспечена корректная работа при удалении временных папок пользователя Студии, если хотя бы у одного пользователя открыт еще один экземпляр Студии.
9. Исправлена ошибка, из-за которой у активности “Уничтожить процесс” не работал флажок "Текущий пользователь". 
10. Решена проблема с зависанием Студии при попытке добавить новый файл в открытый проект. Особенность работы с кнопкой “Добавить в проект имеющийся файл”: теперь кнопка может быть нажата несколько раз (без закрытия предыдущих окон), что позволяет вызвать несколько однотипных окон. Данное поведение аналогично поведению других функций для работы с файлами.
11. Исправлена ошибка, вызывавшая некорректную последовательность вывода сообщений (логов) в консоль. Теперь логи, созданные в одну и ту же секунду и отличающиеся на миллисекунды, отображаются в правильном порядке.
12. Устранена проблема, из-за которой при включенной настройке “Сворачивать студию” в отладчике Студия не всегда разворачивалась после завершения работы процесса.
13. Исправлена проблема, приводившая к появлению значков ошибки у активностей одного из проектов при одновременном открытии двух проектов, содержащих один и тот же Nuget пакет и активности из него.
14. Исправлена некорректная работа валидации паттерна поиска элементов и селектора элементов: теперь подсвечиваются все найденные на странице элементы, удовлетворяющие поиску.
15. Исправлена ошибка, из-за которой не все свойства захватывались селектором в браузере Яндекс. 
16. Исправлена ошибка, из-за которой при повторном выборе компонента происходило дублирование окна селектора - теперь при выборе какого-либо компонента в браузере открывается одно окно селектора.
17. Найдено решение проблемы с миганием при выборе селектора. При выключенном Композит-менеджере и недоступном альфа-канале для корректной работы необходимо включить настройку прозрачности окон (Файл > Настройки > Общие > Принудительная прозрачность окон).
![](<../../.gitbook/assets1/Transparency.PNG>)
18. Решена проблема, из-за которой при использовании чекбокса «Искать во фреймах» в редакторе шаблона поиска при одном из нажатий элемент переставал находиться отображением компонентов.

19. Устранены следующие недочеты в редакторе шаблона поиска: 
- в окне редактирования шаблона поиска при нажатии на кнопки “Отобразить компонент” или “Выбрать компонент” окно не скрывалось и отображалось поверх браузера, что вызывало неудобства в работе;
- добавлено корректное склонение слова “элемент” в строке о количестве найденных элементов внизу окна редактора шаблона поиска.

20. Сделан более информативным текст сообщения об ошибке “Invalid expression term {“, которая может возникать при работе робота в классе LTools.Scripting.ScriptInst.

21. Исправлена ошибка “Value cannot be null (Parameter 'path')”, возникавшая при создании нового процесса в уже открытом проекте (без открытия уже существующего процесса).

22. Обеспечено корректное удаление файлов  из папки /tmp/Primo.Studio.${user}/{GUID}/.Dependencies после работы робота. Очистка папки производится: 
- при запуске робота из Оркестратора; 
- при запуске Студии (если не открыты другие экземпляры Студии или Robot Runner); 
- при запуске задачи в Robot Runner (если не открыты другие экземпляры Robot Runner или Студии). 
![](<../../.gitbook/assets1/TMP-files.PNG>)
23. Компонент "Браузер: Выбрать элемент" - для свойства "Состояние" теперь указан корректный рекомендуемый тип переменной System.Nullable<Boolean>.

24. Исправлены следующие ошибки в работе элемента Таблица ODF “Запись диапазона”:
дублирование первой строки таблицы при включенной галочке “Добавлять заголовки” в начало переменной таблицы "System.Data.Datatable", если она выбрана в качестве источника:
- несовпадение исходной и полученной таблиц по стилю (формат ячеек, шрифт, цветовые выделения и т.д.) - исправлено за исключением переноса бордюров ячеек
- добавление таблицы внизу основной вместо добавления справа при выборе значения Right для свойства Направление 
- появление сообщения об ошибке “Object reference not set an instance of object” при создании листа
- добавление в файл пустой строки или столбца при добавлении записей к существующим.

25. Устранена ошибка, из-за которой не работал пароль и появлялось сообщение "Не задан пароль" при сохранении документа при работе с элементом Документ ODF.

26. Решена проблема с работой функциональности перетаскивания (drag-and-drop) для активностей, имеющих режим “Только код”.


### Где найти 

[Скачать дистрибутив Primo Studio Linux](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FStudio).

[Скачать дистрибутив Primo RPA Robot](https://disk.primo-rpa.ru/index.php/s/primo?path=%2FRelease%2FRobot).

