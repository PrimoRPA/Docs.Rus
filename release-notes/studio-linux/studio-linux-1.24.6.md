# Primo Studio Linux 1.24.6

Раздел содержит описание изменений для версии приложения **Primo RPA Studio Linux 1.24.6**, выпущенной в июне 2024 года. 


## Новые функции и улучшения
1. Добавлен компонент **Switch**, производящий проверку выражения и выполняющий одну из имеющихся ветвей в зависимости от результата проверки.
2. Добавлен флажок для включения/отключения проверки сертификатов в активности **“Скачать изображение”** для Яндекс Браузер.
3. Добавлены следующие компоненты библиотеки **“Таблица ODF"**:
   * "Таблица ODF: Вставка диаграммы”:
   * “Таблица ODF: Редактировать диаграмму”
   * “Таблица ODF: Фильтр диапазона”
   * “Таблица ODF: Чтение диапазона”
   * “Таблица ODF: Изменение ячейки”
   * “Таблица ODF: Обновление сводных таблиц” (ранее носил название “Обновление данных соединений”)
   * “Таблица ODF: Найти начальную/конечную строку”
4. Добавлены следующие компоненты библиотеки **“Документ ODF”**: 
   * “Документ ODF: Добавить строку таблицы”
   * “Документ ODF: Записать в ячейку таблицы”
   * “Документ ODF: Цвет шрифта”
   * “Документ ODF: Цвет фона шрифта”
   * “Документ ODF: Удалить текст”
   * “Документ ODF: Копировать в буфер обмена”
5. Добавлена возможность использования в режиме **“Только код”** для ряда элементов библиотек **“Документ ODF”** и **“Таблица ODF”**.
6. Реализован **механизм захвата элементов десктопного приложения**. Характеристики: выбранный элемент может быть только один; выбранный элемент определяется координатами мыши (курсор мыши должен находиться непосредственно над элементом) и обозначается прямоугольником оранжевого цвета; при щелчке мыши фиксируется результат выбора.
7. Реализованы и доработаны элементы для взаимодействия с рабочим столом:
   * “Рабочий стол: Исчезновение элемента”
   * “Рабочий стол: Клик мышью” (добавлено свойство Позиция)
8. Реализован поиск элементов во вкладках **“Элементы”** и **“Проект”**.


## Исправленные ошибки 

1. **ODF Таблицы**:
   * Решена ситуация с активностью **“Таблица ODF: Сортировка диапазона”**, при которой возникало сообщение об ошибке “Object reference not set an instance of object ods”.
   * Исправлена ошибка в активности **“Таблица ODF: Сохранить как PDF”**, из-за которой происходила выгрузка пустого документа, если не были заполнены поля “Индекс первой страницы” и “Индекс последней страницы”. 
   * Устранена проблема, из-за которой при работе с элементом **“Таблица ODF”** выдавалось сообщение об ошибке “Не задан пароль”.  
   * Улучшена работа бордюров для элемента **“Таблица ODF: Изменение ячейки”**. Также добавлены два новых типа бордюров: Вертикальные линии и Горизонтальные линии.

2. **ODF Документы**: 
   * Исправлена ошибка в работе активности **“Документ ODF: Сохранить документ”**, из-за которой не сохранялся файл .xodt, если в активности не было указано свойство “Путь к файлу”. Теперь в этом случае активность работает корректно - сохраняется файл, открытый в рамках текущего контейнера “Документ ODF”.
   * Внесены изменения в функционирование поиска текста с помощью **“Документ ODF: Найти текст”**. Теперь элемент корректно отрабатывает ситуацию с наличием нечитаемого символа.
   * Проведена работа по улучшению экспорта текста с использованием активности **“Документ ODF: Экспортировать документ”**.
   * Исправлена ошибка в активностях **“Документ ODF: Вставка изображения”** и **“Документ ODF: Ввод текста”** - теперь активности корректно обрабатывают индекс, указанный в поле “Позиция”, как индекс позиции элемента (буквы, цифры). 

3. **Рабочий стол**: 
   * Решена проблема, из-за которых при использовании активностей **“Рабочий стол: Развернуть окно”, “Рабочий стол: Закрыть окно”, “Рабочий стол: Активировать процесс”** возникало сообщение об ошибке и не удавалось присоединиться к некоторым окнам, либо процесс не завершался. 
   * Исправлена ситуация, при которой в активности **“Рабочий стол: Клик мышью”** не работал захват элемента для одиночного и двойного клика левой кнопкой мыши, а также клика правой кнопкой мыши. 
   * Проблема с неработающим захватом элемента также исправлена для активностей **“Рабочий стол: Присутствие элемента”, “Рабочий стол: Выбрать элемент”, “Рабочий стол: Получить текст”, “Рабочий стол: установить курсор мыши”**.
   * Устранена ситуация с выходом по тайм-ауту **“Рабочий стол: Клик мыши”** при использовании атрибута “Id”. Теперь данный атрибут обрабатывается корректно.  
   * **“Рабочий стол: исчезновение элемента”** - устранено зацикливание процесса при невозможности найти элемент по указанному шаблону поиска. 
   * Обеспечена работоспособность активности **“Рабочий стол: Выбрать элемент”** в RED OS.

4. Браузер: 
   * Обеспечена корректная работа элемента **“Яндекс Браузер: Якорь”** - элементы для работы теперь выбираются корректно. 
   * Откорректирован указанный тип данных (на "System.Nullable<System.Drawing.Point>") для активности **“Яндекс Браузер: Прокрутка”**. 
   * Решена проблема, вызывавшая появление сообщения об ошибке при попытке скачивания изображения как через браузер, так и по URL, с помощью активности **“Яндекс Браузер: Скачать изображение”**. Для этого в свойства был добавлен флажок, включающий/отключающий проверку сертификатов. Для корректного скачивания изображений флажок должен быть включен.

5. Установлен алфавитный порядок элементов (процессов, документов, изображений) на вкладке **“Проект”**.

6. Устранена ситуация, вызывавшая аварийное закрытие Студии при копировании активностей.

7. Теперь нет необходимости перезапускать Студию из-за невозможности открытия ни одного из процессов, если в основной рабочей области были закрыты все вкладки с процессами.

8. Устранена ошибка, вследствие которой при использовании горячих клавиш для копирования и вставки текста в переменную происходило также копирование активности на основную рабочую область проекта.

9. Исправлено некорректное поведение клавиши k при ее нажатии при активном окне свойств элемента: теперь в этой ситуации в окне ввода появляется переменная k, окно создания переменной не вызывается (для вызова окна используется комбинация клавиш ctrl+k).

10. Устранены проблемы, приводившие к появлению сообщений об ошибках “Call from invalid thread” или “Could not CreateWindow(): IWindowingPlatform is not registered” (в зависимости от включения/выключения настройки “Наличие UI”) при использовании элемента **“Присоединиться к приложению”**.

11. Восстановлена производительность при работе с циклами при запуске проекта из Студии.

12. Решена проблема с показом таблиц в панели “Вывод” в режиме отладки.

13. Восстановлена возможность использовать аргументы, не работавшие ранее при использовании языка программирования Python в режиме Pure Code.

14. Реализована поддержка использования активностей Primo в процессах Pure Code для языков программирования C# и Python.

15. Исправлена ситуация с аварийным выходом Студии при использовании подсказок при работе с кодом.

16. Устранена причина появления сообщения “Call from invalid thread” и значка ошибки при работе с элементом **“Множественное присвоение”**.

17. Сделан более информативным текст сообщений об ошибках при вводе неправильного пароля в активности “Преобразовать в изображение”. 

18. Улучшен процесс создания скриншотов при включенном флажке **“Принудительная прозрачность окон”**: выделяемая область подсвечивается прямоугольной рамкой.

19. Решена проблема, из-за которой при закрытии вкладки процесса с несохраненными изменениями не выдавалось предупреждение, и все изменения пропадали.

20. Изменено расположение временных файлов, создающихся при работе Студии:
- Логирование параметров командной строки запуска процесса робота.
Новое расположение файла: ~/.local/share/Primo.linux-x64/Log/Robot/command_args.txt
- Создание временных изображений. Изображения теперь будут формироваться в папке ./tmp
- Запуск скриптов Python. Теперь скрипты будут формироваться в папке  
   ~/.local/share/Primo.${Имя папки со студией}$/Scripts

21. Обеспечена возможность редактировать свойство “цвет” для активностей, имеющих его. Данное свойство также отображается в таблице свойств элемента.

22. Оптимизировано потребление Студией ресурсов - в частности, оперативной памяти. Например, объем оперативной памяти, используемый в течение 2.5 часов работы,  снизился на 24%. 

## Где найти 

[Скачать дистрибутив Primo RPA Studio Linux](http://disk3.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FRelease%2FStudio%2FLinux)

[Скачать дистрибутив Primo RPA Robot](http://disk3.primo-rpa.ru/index.php/s/t9BHBjR6PP06Yax?path=%2FRelease%2FRobot%2FLinux)
